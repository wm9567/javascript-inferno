<html>
<head>
  <title>Inferno example</title>
  <link rel="stylesheet" href="bootstrap.min.css">
</head>
<body>
  <example-app message="Hello world"></example-app>
  <div id="app"></div>

  <script src="inferno2.js"></script>
  <script src="t7.js"></script>
  <script>

    var closureVar = 1;

    var InfernoExample = Inferno.createClass({
      constructor: function(props) {
        this.state.name = "Test";
        this.state.className = "foo";
        this.state.textFieldValue = "Text!";
        this.state.people = [
          "Bob",
          "Dominic",
          "John",
          "Edward"
        ],
        this.state.isOn = false;
      },
      onPropsChange: function(newProps) {
        if(this.props.people !== newProps.people) {
          this.setState({
            people: newProps.people
          });
        }
        if(this.props.switch !== newProps.isOn) {
          this.setState({
            isOn: newProps.isOn
          });
        }
      },
      render: function() {
        if(closureVar % 5 === 1) {
          return t7`
            <div class=${ this.state.className }>
              <span id="bar">${ this.state.name }</span>
              <div id="time">The time is ${ this.props.time }</div>
              ${ this._renderForm() }
              ${ this.state.name }
              ${this.state.isOn === false
                ? t7`<div>Switch is off!</div>`
                : t7`<div>Switch is on! <span>${ this.props.time }</span></div>`
              }
              <ul>
                ${ this.state.people.map(this._renderPerson) }
              </ul>
            </div>
          `;
        } else {
          return t7`
            <div>Lol</div>
          `;
        }
      },
      _renderPerson: function(person) {
        if(closureVar % 3 === 1) {
          return t7`<li>${ person }, the number is ${ closureVar }<div>foo</div></li>`;
        } else {
          return t7`<li>${ person }, the magical number is ${ closureVar }<div>foo</div></li>`;
        }
      },
      _renderForm: function() {
        if(closureVar % 3 === 1) {
          return t7`
            <form>
              <input type="text" value=${ this.state.textFieldValue } />
            </form>
          `;
        } else {
          return t7`
            <h2>No form!</h2>
          `;
        }
      }
    });

    Inferno.register("example-app", InfernoExample);

    Inferno.render(function() {
      return t7`<example-app></example-app>`
    }, document.getElementById("app"));

    // var appElement = document.getElementById("app");
    //
    // var odd = true;
    // var isOn = false;
    //
    // setInterval(function() {
    //   //uses valid, currently widely used DOM accessors
    //   var date = new Date();
    //   var people = [];
    //   odd = !odd;
    //   if(!odd) {
    //     people = [
    //       "Bob",
    //       "Dominic",
    //       "John",
    //       "Edward"
    //     ]
    //   } else {
    //     people = [
    //       "Jemma",
    //       "Charlie",
    //       "Harry",
    //       "Kieria",
    //       "Paul",
    //       "Ken"
    //     ]
    //   }
    //
    //   var i = 0;
    //   isOn = !isOn;
    //   closureVar++;
    //
    //   console.time("update");
    //
    //   appElement.setProps({
    //     time: date.toTimeString(),
    //     people: people,
    //     isOn: isOn,
    //     textFieldValue: "value " + i
    //   });
    //
    //   console.timeEnd("update");
    //
    //   i++;
    // }, 500);

  </script>
</body>
</html>
