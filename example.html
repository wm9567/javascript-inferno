<html>
<head>
  <title>Inferno example</title>
  <link rel="stylesheet" href="bootstrap.min.css">
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <div id="app"></div>
  <script src="im7.js"></script>
  <script src="inferno.js"></script>
  <script src="t7.js"></script>
  <script src="data.js"></script>
  <script>

    var state = {
      myName: "Dominic",
      className: "foo",
      myLastName: "Gannaway",
      deepName: "Deeeep!",
      person: {
        name: "Fred",
        age: 30
      },
      items: [
        "Dominic",
        "Jemma",
        "Charlie",
        "Harry"
      ],
      dbs: getData()
    };


    function template() {
      var map = Inferno.TemplateHelpers.map;
      var text = Inferno.TemplateHelpers.text;
      var computed = Inferno.TemplateHelpers.computed;

      return {
        tag: "div",
        attrs: [
          {
            name: "class",
            value: "container"
          }
        ],
        children: [
          {
            tag: "span",
            bindAttrs: [
              {
                name: "class",
                statePath: "",
                initValue: state.className,
                oldValue: null
              }
            ],
            attrs: [
              {
                name: "id",
                value: "test"
              }
            ],
            bindText: {
              statePath: "",
              initValue: state.myName,
              oldValue: null
            }
          },
          "Random static text FTW!",
          {
            tag: "ul",
            bindMap: {
              initValue: state.items,
              oldValue: null,
              constructor: function(item) {
                return {
                  tag: "li",
                  attrs: [
                    {
                      name: "class",
                      value: "wow"
                    }
                  ],
                  bindText: {
                    statePath: "",
                    initValue: item,
                    oldValue: null
                  }
                }
              }
            }
          },
          {
            tag: "table",
            attrs: [
              {
                name: "class",
                value: "table table-striped latest-data"
              }
            ],
            children: {
              tag: "tbody",
              bindMap: {
                initValue: state.dbs,
                oldValue: null,
                constructor: function(db) {
                  return {
                    tag: "tr",
                    children: [
                      {
                        tag: "td",
                        attrs: [
                          {
                            name: "class",
                            value: "dbname"
                          }
                        ],
                        bindText: {
                          statePath: "",
                          initValue: db.name,
                          oldValue: null
                        }
                      },
                      {
                        tag: "td",
                        attrs: [
                          {
                            name: "class",
                            value: "query-count"
                          }
                        ],
                        children: {
                          tag: "span",
                          attrs: {
                            "class": getCountClassName(db)
                          },
                          bindComputed: {
                            statePath: "",
                            initValue: db.queries,
                            computed: function(val) {
                              return val.length;
                            },
                            oldValue: null,
                            oldComputed: null
                          }
                        }
                      },
                    ]
                  }
                }
              }
            }
          }
        ]
      }
    };

    var app = document.getElementById("app");
    var root = Inferno.append(template, state, app);

    //shortcut for dev purposes
    function u() {
      Inferno.update(root, app)
    };

    u();

  </script>
</body>
</html>
