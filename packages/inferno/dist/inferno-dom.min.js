!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):e.InfernoDOM=n()}(this,function(){"use strict";function e(e,t){return r(e)||(n(e)&&e.length>0||!n(e))&&(t?t.children=e:t={children:e}),t}function n(e){return e.constructor===Array}function t(e){return e&&e.prototype&&e.prototype.render}function o(e){return"string"==typeof e||"number"==typeof e}function r(e){return void 0===e||null===e}function i(e){return"function"==typeof e}function a(e){return"o"===e[0]&&"n"===e[1]&&e.length>3}function l(e){return"string"==typeof e}function d(e,n,t){t?e.insertBefore(n,t):e.appendChild(n)}function u(e){}function c(e,n,t){if(t)""!==e?n.textContent=e:n.appendChild(document.createTextNode(""));else{var o=document.createTextNode(e);n.appendChild(o)}}function f(e,n,t,o,r){var i=M(n,null,o,r);t.replaceChild(i,e.dom),n.dom=i}function s(e){t(e.instance)&&(e.instance.componentWillUnmount(),e.instance._unmounted=!0),e.events&&e.events.willDetach&&e.events.willDetach(e.dom),e.events&&e.events.componentWillUnmount&&e.events.componentWillUnmount(e.dom,e.events);var o=e.children;if(o)if(n(o))for(var r=0;r<o.length;r++)s(o[r]);else s(o)}function v(e,n){var t=e.dom;s(e),t===n?t.innerHTML="":(n.removeChild(t),A&&U(e))}function m(e,n,t,o,i){return r(e)?void M(n,t,o):r(n)?void v(e,t):void k(e,n,t,o,i,null!==e.static&&null!==n.static)}function p(e,n,t,o){if(n!==t)if("style"===e)if(l(t))o.style.cssText=t;else for(var i=Object.keys(t),d=0;d<i.length;d++){var u=i[d];o.style[u]=t[u]}else a(e)||(t===!1||r(t)?o.removeAttribute(e):t===!0?o.setAttribute(e,e):o.setAttribute(e,t))}function h(n,o,r,i,a,l,d,u,c,f){if(a=e(d,a),t(o)){var s=r.props,v=r.state,m=r.state,p=r.getChildContext();p&&(f=O.extends({},f,p)),r.context=f;var h=r._updateComponent(v,m,s,a);h&&(k(n,h,u,c,f,!1),n.dom=h.dom,r._lastNode=h)}else{var y=!0;if(l&&l.componentShouldUpdate&&(y=l.componentShouldUpdate(n.dom,i,a)),y!==!1){l&&l.componentWillUpdate&&l.componentWillUpdate(n.dom,i,a);var h=o(a),g=n.dom;h.dom=g,k(r,h,g,c,f,!1),n.instance=h,l&&l.componentDidUpdate&&l.componentDidUpdate(n.dom,i,a)}}}function y(e,n,t,o,r,i){var a=e.length,l=n.length;if(a>l)for(var d=void 0;a!==l;){var u=e[a-1];t.removeChild((d=u.dom)||d&&(d=d.previousSibling)||(d=t.lastChild)),a--}else if(l>a)for(var c=0;a!==l;){var f=n[a+c],s=M(f,null,o,r);t.appendChild(s),l--,c++}for(var v=0;l>v;v++){var u=e[v],f=n[v];u!==f&&m(u,f,t,o,r)}}function g(e,n,t,o,r,i){var a=!1,l=0,u=0,c=n.length,f=e.length,s=void 0,m=void 0;if(0===c&&f>=5){if(A)for(var p=0;f>p;p++)U(e[p]);return void(t.textContent="")}var h=c-1,y=f-1,g=f>0?e[u]:null,C=c>0?n[l]:null,b=void 0,x=void 0,N=void 0;e:for(;!a&&h>=l&&y>=u;){for(a=!0;C.key===g.key;){if(k(g,C,t,o,r,!0),l++,u++,l>h||u>y)break e;C=n[l],g=e[u],a=!1}for(b=n[h],x=e[y];b.key===x.key;){if(k(x,b,t,o,r,!0),h--,y--,l>h||u>y)break e;b=n[h],x=e[y],a=!1}for(;b.key===g.key;){if(N=c>h+1?n[h+1].dom:i,k(g,b,t,o,r,!0),d(t,b.dom,N),h--,u++,l>h||u>y)break e;b=n[h],g=e[u],a=!1}for(;C.key===x.key;){if(N=e[u].dom,k(x,C,t,o,r,!0),d(t,C.dom,N),l++,y--,l>h||u>y)break e;C=n[l],x=e[y],a=!1}}if(u>y){if(h>=l)for(N=c>h+1?n[h+1].dom:i;h>=l;l++)s=n[l],d(t,M(s,null,o,r),N)}else if(l>h)for(;y>=u;u++)m=e[u],v(m,t);else{for(var w={},p=u;y>=p;p++)m=e[p],w[m.key]=m;for(var _=c>h+1?n[h+1]:null,p=h;p>=l;p--){s=n[p];var D=s.key;m=w[D],void 0!==m?(w[D]=null,k(m,s,t,o,!0),s.dom.nextSibling!==_&&(_=_&&_.dom||i,d(t,s.dom,_)),_=s):(_=_&&_.dom||i,d(t,M(s,null,o,r),_)),_=s}for(var p=u;y>=p;p++)m=e[p],null!==w[m.key]&&v(m,t)}}function k(e,n,r,a,l,d){if(n!==!1&&null!==n){if(o(e))return void(o(n)&&(r.firstChild.nodeValue=n));var u=n.tag||(d?n.static.tag:null),c=e.tag||(d?e.static.tag:null);if(e.events&&e.events.willUpdate&&e.events.willUpdate(e.dom),c!==u)return void(i(c)&&!i(u)?t(c)?k(e.instance._lastNode,n,r,a,l,!0):k(e.instance,n,r,a,l,!0):f(e,n,r,a,l));if(i(c)&&i(u))return n.instance=e.instance,n.dom=e.dom,void h(n,n.tag,n.instance,e.attrs,n.attrs,n.events,n.children,r,a,l);var s=e.dom;n.dom=s,C(e,n,s,a,l,d),e.className!==n.className&&(s.className=n.className),b(e,n,s),x(e,n,s),n.events&&n.events.didUpdate&&n.events.didUpdate(s)}}function C(e,t,i,a,l,d){var u=t.children,c=e.children;if(c!==u)if(r(c))o(u)?i.textContent=u:u&&n(u)&&_(u,i,a,l);else if(r(u))i.textContent="";else if(n(c))if(n(u)){var f=u.length&&u[0]&&!r(u[0].key)&&c.length&&c[0]&&!r(c[0].key);f?g(c,u,i,a,l,null):y(c,u,i,a,l,null)}else y(c,[u],i,a,l,null);else n(u)?y([c],u,i,a,l,null):o(c)?o(u)&&(i.firstChild.nodeValue=u):k(c,u,i,a,l,d)}function b(e,n,t){var o=n.attrs,r=e.attrs;if(o)for(var i=0;i<o.length;i++){var a=r[i],l=o[i],d=a&&a.name,u=l&&l.name,c=a&&a.value,f=l&&l.value;d&&d===u&&p(d,c,f,t)}}function x(e,n,t){}function N(e,n,t){var o=e.key,r=void 0;if(null!==o){var i=e.static.static.keyed[o];r=i&&i.pop()}else{var i=e.static.static.nonKeyed;r=i&&i.pop()}return r?(k(r,e,null,n,t,null,!0),e.dom):void 0}function U(e){var n=e.key,t=e.static.static;if(null===n){var o=t.nonKeyed;o&&o.push(e)}else{var r=t.keyed;(r[n]||(r[n]=[])).push(e)}}function w(e,n,t){if(E[e]){var o=E[e];o.push({callback:t,target:n})}else document.addEventListener(e,function(n){for(var t=E[e],o=t.length-1;o>-1;o--){var r=t[o];r.target===n.target&&r.callback(n)}},!1),E[e]=[]}function _(e,t,r,i){if(n(e))for(var a=0;a<e.length;a++){var l=e[a];o(l)?c(l,t,!1):M(l,t,r,i)}else o(e)?c(e,t,!0):M(e,t,r,i)}function D(n,o,r,i,a,l,d,u){if(r=e(a,r),t(o)){var c=new o(r);c._diffNodes=k;var f=c.getChildContext();f&&(u=O.extends({},u,f)),c.context=u,c.componentWillMount();var s=c.render(),v=void 0;return s&&(v=M(s,null,d,u),c._lastNode=s,l&&l.appendChild(v),d.addListener(c.componentDidMount)),n.dom=v,n.instance=c,v}var m=function(){var e=void 0;i&&(i.componentWillMount&&i.componentWillMount(null,r),i.componentDidMount&&d.addListener(function(){i.componentDidMount(e,r)}));var t=o(r);return e=M(t,null,d,u),n.instance=t,l&&l.appendChild(e),n.dom=e,{v:e}}();return"object"===("undefined"==typeof m?"undefined":O.typeof(m))?m.v:void 0}function M(e,t,a,l){var d=void 0;if(!r(e)&&!n(e)){if(o(e))return document.createTextNode(e);if(A&&(d=N(e,a,l)))return t&&t.appendChild(d),d;if(i(e.tag))return D(e,e.tag,e.attrs,e.events,e.children,t,a,l);d=e.static.dom?e.static.dom.cloneNode(!0):u(e.tag);var c=e.children,f=e.attrs,s=e.events;return s&&(s.click&&w("click",d,s.click),s.created&&s.created(d),s.attached&&a.addListener(function(){s.attached(d)})),r(c)||_(c,d,a,l),f&&S(f,d),r(e.className)||(d.className=e.className),e.dom=d,null!==t&&t.appendChild(d),d}}function S(e,n){for(var t=0;t<e.length;t++){var o=e[t],r=o&&o.name,i=o&&o.value;r&&p(r,null,i,n)}}function W(e){for(var n=0;n<K.length;n++){var t=K[n];if(t.dom===e)return t}return null}function j(e){for(var n=0;n<K.length;n++){var t=K[n];if(t===e)return K.splice(n,1),!0}return!1}function L(e,n){var t=W(n),o=new T;r(t)?(M(e,n,o,{}),o.trigger(),K.push({node:e,dom:n})):(m(t.node,e,n,o,{}),o.trigger(),null===e&&j(t),t.node=e)}var O={};O.typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},O.classCallCheck=function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")},O.createClass=function(){function e(e,n){for(var t=0;t<n.length;t++){var o=n[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(n,t,o){return t&&e(n.prototype,t),o&&e(n,o),n}}(),O.extends=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e};var T=function(){function e(){O.classCallCheck(this,e),this._listeners=[]}return O.createClass(e,[{key:"addListener",value:function(e){this._listeners.push(e)}},{key:"trigger",value:function(){for(var e=0;e<this._listeners.length;e++)this._listeners[e]()}}]),e}(),A=!1,E={},K=[],P={render:L};return P});