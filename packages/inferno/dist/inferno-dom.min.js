!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):e.InfernoDOM=n()}(this,function(){"use strict";function e(e,t){if(!l(e)){var r=n(e);(r&&e.length>0||!r)&&(t?t.children=e:t={children:e})}return t}function n(e){return e instanceof Array}function t(e){return void 0!==e.prototype.render}function r(e){return"string"==typeof e||"number"==typeof e}function l(e){return void 0===e||null===e}function o(e){return void 0===e||null===e||e===!1}function i(e){return"function"==typeof e}function a(e){return"o"===e[0]&&"n"===e[1]&&e.length>3}function d(e){return"string"==typeof e}function u(e){return e instanceof Promise}function f(e,n,t){e.splice(e.indexOf(n),1,t)}function s(e){return!l(e.append)}function c(e,n,t){l(t)?s(n)?n.append(e):e.appendChild(n):s(n)?n.insert(e,t):s(t)?e.insertBefore(n,t.childNodes[0]):e.insertBefore(n,t)}function p(e,n,t){l(t)?e.appendChild(n):e.insertBefore(n,t)}function v(e,n){return l(n)?document.createElement(e):document.createElementNS(n,e)}function h(e,n,t){if(!t){var r=document.createTextNode(e);return n.appendChild(r),r}if(""===e){var l=document.createTextNode("");return n.appendChild(l),l}n.textContent=e}function m(e,n,t,r,o,i,a){var d=null,u=e._lastNode;l(u)||(d=e,e=u);var f=Y(n,null,r,o,i,a);n.dom=f,t.replaceChild(f,e.dom),null!==d&&(d._lastNode=n),g(e)}function g(e){if(!o(e)&&!r(e)){var t=e.instance,i=null,a=null;l(t)||(i=t.hooks,a=t.children,void 0!==t.render&&(t.componentWillUnmount(),t._unmounted=!0));var d=e.hooks||i;l(d)||(l(d.willDetach)||d.willDetach(e.dom),l(d.componentWillUnmount)||d.componentWillUnmount(e.dom,d));var u=e.children||a;if(!l(u))if(n(u))for(var f=0;f<u.length;f++)g(u[f]);else g(u)}}function C(){return document.createTextNode("")}function y(e,n){var t=e.dom;t===n?t.innerHTML="":(n.removeChild(t),ie&&X(e)),g(e)}function k(e,n){for(var t in e)n[t]=null}function b(e,n,t){for(var r=0;r<n.length;r++)e.insertBefore(n[r],t)}function x(){return document.activeElement}function N(e){e!==document.body&&document.activeElement!==e&&e.focus()}function w(){var e=[],n=document.createTextNode(""),t=null,r={childNodes:e,appendChild:function(r){e.push(r),t&&t.insertBefore(r,n)},removeChild:function(n){t&&t.removeChild(n),e.splice(e.indexOf(n),1)},insertBefore:function(n,r){t&&t.insertBefore(n,r),e.splice(e.indexOf(r),0,n)},replaceChild:function(n,r){t.replaceChild(n,r),f(e,r,n)},append:function(r){r.appendChild(n),t=r,b(t,e,n)},insert:function(r,l){r.insertBefore(n,l),t=r,b(t,e,n)},remove:function(){t.removeChild(n);for(var r=0;r<e.length;r++)t.removeChild(e[r]);t=null},getElementsByTagName:null};return Object.defineProperty(r,"parentNode",{get:function(){return t}}),Object.defineProperty(r,"firstChild",{get:function(){return e[0]}}),r}function O(e,n){return n.length&&!l(n[0])&&!l(n[0].key)||e.length&&!l(e[0])&&!l(e[0].key)}function U(e,n){if("option"===e.tag){var t=e.attrs&&e.attrs.value;n[t]&&(e.attrs=e.attrs||{},e.attrs.selected="selected")}else for(var r=0,l=e.children.length;l>r;r++)U(e.children[r],n)}function j(e){if("select"===e.tag){var t=e.attrs&&e.attrs.value;if(!l(t)){var r={};if(n(t))for(var o=0,i=t.length;i>o;o++)r[t[o]]=t[o];else r[t]=t;U(e,r),e.attrs&&e.attrs[t]&&delete e.attrs.value}}}function _(e){switch(e.length){case 5:return"value"===e;case 7:return"checked"===e;case 8:return"disabled"===e||"selected"===e;default:return!1}}function M(e,n,t){r(n)?e.firstChild.nodeValue=t:e.textContent=t}function T(e,n,t,l,i,a,d,u){if(null!==u)K(e,n,t,l,i,a,d,u);else if(o(e))Y(n,t,l,i,a,d);else if(o(n))y(e,t);else if(r(e))if(r(n))t.firstChild.nodeValue=n;else{var f=Y(n,null,l,i,a,d);n.dom=f,t.replaceChild(f,t.firstChild)}else if(r(n)){var s=document.createTextNode(n);t.replaceChild(s,e.dom)}else K(e,n,t,l,i,a,d,null!==e.tpl&&null!==n.tpl)}function B(e,n,t){if(d(n))t.style.cssText=n;else if(l(e)){if(!l(n))for(var r=Object.keys(n),o=0;o<r.length;o++){var i=r[o],a=n[i];t.style[i]=a}}else if(l(n))t.removeAttribute("style");else{for(var u=Object.keys(n),f=0;f<u.length;f++){var s=u[f],c=n[s];t.style[s]=c}for(var p=Object.keys(e),v=0;v<p.length;v++){var h=p[v];l(n[h])&&(t.style[h]="")}}}function S(e,n,t){for(var r=Object.keys(n),o=0;o<r.length;o++){var i=r[o],a=e[i],d=n[i];a!==d&&(t[i]=d)}for(var u=Object.keys(e),f=0;f<u.length;f++){var s=u[f];l(n[s])&&(t[s]=null)}}function E(e,n,t){if(!a(e)){if(_(e))return void(t[e]=n);n===!1||l(n)?t.removeAttribute(e):":"===e[5]&&-1!==e.indexOf("xlink:")?t.setAttributeNS("http://www.w3.org/1999/xlink",e,n===!0?e:n):":"===e[4]&&-1!==e.indexOf("xml:")?t.setAttributeNS("http://www.w3.org/XML/1998/namespace",e,n===!0?e:n):t.setAttribute(e,n===!0?e:n)}}function D(n,r,o,i,a,d,u,f,s,c){if(a=e(u,a),t(r)){var p=o.props,v=o.state,h=o.state,m=o.getChildContext();l(m)||(c=te.extends({},c,m)),o.context=c;var g=o._updateComponent(v,h,p,a);l(g)||(T(n,g,f,null,s,c,o,!0),n.dom=g.dom,o._lastNode=g)}else{var C=!0,y=!l(d);if(y&&!l(d.componentShouldUpdate)&&(C=d.componentShouldUpdate(n.dom,i,a)),C!==!1){y&&!l(d.componentWillUpdate)&&d.componentWillUpdate(n.dom,i,a);var k=r(a),b=n.dom;k.dom=b,T(o,k,b,null,s,c,null,!0),n.instance=k,y&&!l(d.componentDidUpdate)&&d.componentDidUpdate(n.dom,i,a)}}}function W(e,t,i,a,d,u,f,s,p){var v=void 0===i.append,h=e.length,m=t.length,y=h===m;if(y===!1)if(h>m)for(;h!==m;){var k=e[h-1];o(k)||(i.removeChild(a[h-1+p]),g(k)),h--}else for(;h!==m;){var b=t[h],x=Y(b,null,d,u,f,s);c(i,x),v&&(1===h&&a.push(i.firstChild),v&&a.splice(h+p,0,x)),h++}for(var N=0;m>N;N++){var U=e[N],j=t[N],_=N+p;if(U!==j)if(o(j)){if(!o(U)){var M=a[_];if(!l(M))if(r(U))M.nodeValue="";else if(y===!0){var B=C();n(U)&&0===U.length?(c(i,B),v&&a.splice(_,0,B)):(i.replaceChild(B,a[_]),v&&a.splice(_,1,B),g(U))}}}else if(o(U)){if(r(j)){var S=document.createTextNode(j);i.replaceChild(S,a[_]),v&&a.splice(_,1,S)}else if(y===!0){var E=Y(j,null,d,u,f,s);i.replaceChild(E,a[_]),v&&a.splice(_,1,E)}}else if(r(j))if(1===h)r(U)?void 0!==i.getElementsByTagName?i.firstChild.nodeValue=j:i.nodeValue=j:(g(U),i.textContent=j);else{var D=document.createTextNode(j),V=a[_];l(V)?i.nodeValue=D.nodeValue:void 0===V.append?(v&&a.splice(_,1,D),i.replaceChild(D,V)):(i.insertBefore(D,V.firstChild),V.remove(),a.splice(0,a.length,D)),g(U)}else if(n(j))if(O(U,j))A(U,j,a[_],d,u,f,s);else if(n(U)){var L=a[_];if(void 0===L.append)if(j.length>1&&1===U.length){var P=w();P.insert(i,L),P.appendChild(L),v&&a.splice(_,1,P),W(U,j,P,P.childNodes,d,u,f,s,0)}else W(U,j,i,a,d,u,f,s,0);else W(U,j,a[_],a[_].childNodes,d,u,f,s,0)}else if(j.length>1){var I=w();I.appendChild(i.firstChild),c(i,I,i.firstChild),v&&a.splice(_,1,I),W([U],j,I,I.childNodes,d,u,f,s,N)}else W([U],j,i,a,d,u,f,s,N);else n(U)?W(U,[j],a,a[_].childNodes,d,u,f,s,0):T(U,j,i,d,u,f,s,null)}}function A(e,n,t,r,o,i,a){var d=n.length,u=e.length;if(0===d&&u>=5){if(ie)for(var f=0;u>f;f++)X(e[f]);return void(t.textContent="")}var s=void 0,c=!1,v=0,h=0,m=d-1,g=u-1,C=u>0?e[h]:null,k=d>0?n[v]:null,b=void 0,x=void 0,N=void 0;e:for(;!c&&m>=v&&g>=h;){for(c=!0;k.key===C.key;){if(T(C,k,t,r,o,i,a,!0),v++,h++,v>m||h>g)break e;k=n[v],C=e[h],c=!1}for(b=n[m],x=e[g];b.key===x.key;){if(T(x,b,t,r,o,i,a,!0),m--,g--,v>m||h>g)break e;b=n[m],x=e[g],c=!1}for(;b.key===C.key;){if(N=d>m+1?n[m+1].dom:null,T(C,b,t,r,o,i,a,!0),p(t,b.dom,N),m--,h++,v>m||h>g)break e;b=n[m],C=e[h],c=!1}for(;k.key===x.key;){if(N=e[h].dom,T(x,k,t,r,o,i,a,!0),p(t,k.dom,N),v++,g--,v>m||h>g)break e;k=n[v],x=e[g],c=!1}}if(h>g){if(m>=v)for(N=d>m+1?n[m+1].dom:null;m>=v;v++)p(t,Y(n[v],null,r,o,i,a),N)}else if(v>m)for(;g>=h;h++)s=e[h],y(s,t);else{for(var w=new Map,O=h;g>=O;O++)s=e[O],w.set(s.key,s);N=d>m+1?n[m+1]:null;for(var U=m;U>=v;U--){var j=n[U],_=j.key;s=w.get(_),N=l(N)?void 0:N.dom,void 0===s?p(t,Y(j,null,r,o,i,a),N):(w.delete(_),T(s,j,t,r,o,i,a,!0),j.dom.nextSibling!==N&&p(t,j.dom,N)),N=j}for(var M=h;g>=M;M++)s=e[M],w.has(s.key)&&y(s,t)}}function V(e,t,i,a,d,u,f,s){var c=t.children,p=e.children;if(p!==c){var v=null;e.domChildren&&(v=t.domChildren=e.domChildren),o(p)?r(c)?M(i,p,c):l(c)||(n(c)?z(t,c,i,a,d,u,f):Y(c,i,a,d,u,f)):o(c)?i.textContent="":n(p)?n(c)?null===v&&p.length>1?A(p,c,i,a,d,u,f):O(p,c)?A(p,c,i,a,d,u,f):W(p,c,i,v||(t.domChildren=[]),a,d,u,f,0):W(p,[c],i,v||[],a,d,u,f,0):n(c)?W([p],c,i,v||(t.domChildren=[i.firstChild]),a,d,u,f,0):r(c)?M(i,p,c):r(p)?T(p,c,i,a,d,u,f,null):T(p,c,i,a,d,u,f,s)}}function L(e,n,t,r){e&&(d(n)&&delete e.refs[n],d(t)&&(e.refs[t]=r))}function P(e,n,t){var r=n.events,o=e.events,i=!l(r),a=!l(o);i?a?S(o,r,t):J(r,t):a&&k(o,t)}function I(e,n,t,r){"select"===e.tag&&j(n);var o=n.attrs,i=e.attrs,a=l(o),d=l(i);if(!a)for(var u=Object.keys(o),f=u.length,s=0;f>s;s++){var c=u[s],p=!d&&i[c],v=o[c];p!==v&&("ref"===c?L(r,p,v,t):E(c,v,t))}if(!d)for(var h=Object.keys(i),m=h.length,g=0;m>g;g++){var C=h[g];(a||l(o[C]))&&("ref"===C?L(r,i[C],null,t):t.removeAttribute(C))}}function K(e,n,r,o,a,d,u,f){if(void 0!==n.then)n.then(function(n){K(e,n,r,o,a,d,f,u)});else{var s=n.hooks,c=!l(s);c&&!l(s.willUpdate)&&s.willUpdate(e.dom);var p=n.tag||(f&&!l(n.tpl)?n.tpl.tag:null),v=e.tag||(f&&!l(e.tpl)?e.tpl.tag:null);if(o=o||"svg"===p?oe:"math"===p?le:null,v!==p){var h=e.instance;i(v)?i(p)?m(h||e,n,r,o,a,d,u):t(v)?K(h._lastNode,n,r,o,a,d,u,!0):K(h,n,r,o,a,d,u,!0):m(h||e,n,r,o,a,d,u)}else if(l(v))n.dom=e.dom;else if(i(v))i(p)&&(n.instance=e.instance,n.dom=e.dom,D(n,n.tag,n.instance,e.attrs||{},n.attrs||{},n.hooks,n.children,r,a,d));else{var g=e.dom,C=n.className,y=n.style;n.dom=g,e!==n&&(V(e,n,g,o,a,d,u,f),I(e,n,g,u),P(e,n,g)),e.className!==C&&(l(C)?g.removeAttribute("class"):g.className=C),e.style!==y&&B(e.style,y,g),c&&!l(s.didUpdate)&&s.didUpdate(g)}}}function H(e,n,t,r){var o=e.tpl;if(!l(o)){var i=e.key,a=null===i?o.pools.nonKeyed:o.pools.keyed[i];if(!l(a)){var d=a.pop();if(!l(d))return K(d,e,null,null,n,t,r,!0),e.dom}}}function X(e){var n=e.tpl;if(!l(n)){var t=e.key,r=n.pools;if(null===t){var o=r.nonKeyed;o&&o.push(e)}else{var i=r.keyed;(i[t]||(i[t]=[])).push(e)}return!0}return!1}function q(e,n,t,r,l,o,i){var a=C();t&&t.push(a),e.then(function(e){var d=Y(e,null,r,l,o,i);n.replaceChild(d,a),t&&f(t,a,d)}),n.appendChild(a)}function z(e,t,i,a,d,f,s){for(var p=[],v=!1,m=!1,g=0;g<t.length;g++){var C=t[g];if(r(C))v=!0,p.push(h(C,i,!1));else if(!l(C)&&n(C)){var y=w();v=!0,z(e,C,y,a,d,f,s),c(i,y),p.push(y)}else if(u(C))q(C,i,p,a,d,f,s);else{var k=Y(C,i,a,d,f,s);v||!m&&C&&l(C.key)?(v=!0,p.push(k)):o(C)?(v=!0,p.push(k)):m===!1&&(m=!0)}}p.length>1&&v===!0&&(e.domChildren=p)}function F(e,t,l,o,i,a,d){n(t)?z(e,t,l,o,i,a,d):r(t)?h(t,l,!0):u(t)?q(t,l,null,o,i,a,d):Y(t,l,o,i,a,d)}function G(e,n,t){!o(e)&&d(n)&&(e.refs[n]=t)}function J(e,n){for(var t=Object.keys(e),r=0;r<t.length;r++){var l=t[r];n[l]=e[l]}}function Q(n,r,o,i,a,d,u,f){o=e(a,o);var s=void 0;if(t(r)){var c=new r(o);c._diffNodes=K;var p=c.getChildContext();l(p)||(f=te.extends({},f,p)),c.context=f,c._pendingSetState=!0,c.componentWillMount();var v=c.shouldComponentUpdate();if(v){c.componentWillUpdate();var h=c._pendingState,m=c.state;c.state=te.extends({},m,h)}var g=c.render();return c._pendingSetState=!1,l(g)||(s=Y(g,null,null,u,f,c),c._lastNode=g,null!==d&&d.appendChild(s),c.componentDidMount(),c.componentDidUpdate()),n.dom=s,n.instance=c,s}l(i)||(l(i.componentWillMount)||i.componentWillMount(null,o),l(i.componentDidMount)||u.addListener(function(){i.componentDidMount(s,o)}));var C=r(o);return s=Y(C,null,null,u,f,null),n.instance=C,null!==d&&d.appendChild(s),n.dom=s,s}function R(e,n){var t=C();return null!==n&&n.appendChild(t),o(e)||(e.dom=t),t}function Y(e,t,a,u,f,s){if(o(e)||n(e))return R(e,t);var c=void 0;if(r(e))return c=document.createTextNode(e),null!==t&&t.appendChild(c),c;if(ie&&(c=H(e,u,f,s),!l(c)))return null!==t&&t.appendChild(c),c;var p=e.tag;if(null===p)return R(e,t);if(i(p))return Q(e,p,e.attrs||{},e.hooks,e.children,t,u,f);a=a||"svg"===p?oe:"math"===p?le:null;var h=e.tpl;if(l(h)||l(h.dom)){if(!d(p)||""===p)throw Error("Inferno Error: Expected function or string for element tag type");c=v(p,a)}else c=h.dom.cloneNode(!1);var m=e.children,g=e.attrs,C=e.events,y=e.hooks,k=e.className,b=e.style;return e.dom=c,l(y)||(l(y.created)||y.created(c),l(y.attached)||u.addListener(function(){y.attached(c)})),o(m)||F(e,m,c,a,u,f,s),l(g)||Z(e,g,c,s),l(k)||(c.className=k),l(b)||B(null,b,c),l(C)||J(C,c),null!==t&&t.appendChild(c),c}function Z(e,n,t,r){"select"===e.tag&&j(e);for(var l=Object.keys(n),o=0;o<l.length;o++){var i=l[o];"ref"===i?G(r,n[i],t):E(i,n[i],t)}}function $(e){for(var n=0;n<ae.length;n++){var t=ae[n];if(t.dom===e)return t}return null}function ee(e){for(var n=0;n<ae.length;n++){var t=ae[n];if(t===e)return void ae.splice(n,1)}}function ne(e,n){var t=$(n),r=new re;if(null===t)Y(e,n,null,r,{},null),r.trigger(),ae.push({node:e,dom:n});else{var l=x();T(t.node,e,n,null,r,{},null,null),r.trigger(),null===e&&ee(t),t.node=e,N(l)}}var te={};te.classCallCheck=function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")},te.createClass=function(){function e(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(n,t,r){return t&&e(n.prototype,t),r&&e(n,r),n}}(),te.extends=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e};var re=function(){function e(){te.classCallCheck(this,e),this._listeners=[]}return te.createClass(e,[{key:"addListener",value:function(e){this._listeners.push(e)}},{key:"trigger",value:function(){for(var e=0;e<this._listeners.length;e++)this._listeners[e]()}}]),e}(),le="http://www.w3.org/1998/Math/MathML",oe="http://www.w3.org/2000/svg",ie=!0,ae=[],de={render:ne};return de});