!function(n,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):n.InfernoDOM=e()}(this,function(){"use strict";function n(n){return n instanceof Array}function e(n){return a(n._isStateful)}function t(n){return l(n)||i(n)}function r(n){return c(n)||u(n)}function o(n){return u(n)||n===!1||a(n)||c(n)}function l(n){return"string"==typeof n}function i(n){return"number"==typeof n}function u(n){return null===n}function a(n){return n===!0}function c(n){return void 0===n}function f(n,e,t,r){return new Zn(n,e,t,r)}function s(n){return new qn(n)}function d(){return new Jn}function p(n){return new Qn(n)}function _(n){return n._type===zn.TEXT}function m(n){return n._type===zn.VARIABLE}function v(n){return n._type===zn.PLACEHOLDER}function h(n){return n._type===zn.FRAGMENT}function g(n){return n._type===zn.ELEMENT}function y(n){return n._type===zn.TEMPLATE}function E(n){return n._type===zn.COMPONENT}function k(n,e,t,r,o,l){if(n!==e)if(y(e))y(n)&&w(n,e,t,r,o,l);else if(y(n));else if(E(e))E(n)?I(n,e,t,r,o,l):(pn(t,Un(e,null,r,o,l),n._dom),J(n,null));else if(E(n));else if(h(e))h(n)?M(n,e,t,r,o,l):(pn(t,In(e,null),n._dom),J(n,null));else if(g(e))g(n)?C(n,e,t,r,o,l):(pn(t,Nn(e,null,r,o,l),n._dom),J(n,null));else if(g(n))pn(t,Nn(e,null,r,o,l),n._dom),J(n,null);else if(h(n))fn(t,n,Nn(e,null,r,o,l));else if(v(e))v(n)?D(n,e):(pn(t,An(e,null),n._dom),J(n,null));else if(v(n))pn(t,Nn(e,null,r,o,l),n._dom);else if(_(e))_(n)?L(n,e):(pn(t,Mn(e,null),n._dom),J(n,null));else{if(!_(n))throw Error("Inferno Error: Bad input argument called on patch(). Input argument may need normalising.");pn(t,Nn(e,null,r,o,l),n._dom)}}function x(n,e,t,r,o,l,i){switch(n){case jn.NON_KEYED_LIST:A(e,t,r,o,l,i,null);break;case jn.KEYED_LIST:S(e,t,r,o,l,i,null);break;case jn.UNKNOWN:T(e,t,parentDom,o,l,i);break;case jn.TEXT:ln(r,e,t);break;default:throw new Error("Inferno Error: Bad childrenType value specified when attempting to patchChildren")}}function T(e,r,l,i,u,a){o(r)?gn(l,e):o(e)?t(r)?ln(l,e,r):o(r)||(n(r)?mountChildren(r,l,i,u,a):Nn(r,l,i,u,a)):n(r)?n(e)?(r.complex=e.complex,En(e,r)?S(e,r,l,i,u,a,null):A(e,r,l,i,u,a,null)):A([e],r,l,i,u,a,null):n(e)?A(e,[r],l,i,u,a,null):k(e,r,l,i,u,a)}function w(n,e,t,r,o,l){var i=n._dom,u=n._tr,a=e._tr;if(u!==a){var c=bn(e,null,r,o,l);pn(t,c,i),J(n,null,r)}else e._dom=i,a.patch(n,e,r,o,l)}function C(n,e,t,o,l,i){var u=e._hooks,a=!r(u);a&&!r(u.onWillUpdate)&&u.onWillUpdate(n._dom);var c=e._tag,f=n._tag;if("svg"===c&&(i=!0),f!==c)dn(n,e,t,o,l,i);else{var s=n._dom,d=n._props,p=e._props,_=n._children,m=e._children;if(e._dom=s,_!==m){var v=n._childrenType,h=e._childrenType;v===h?x(v,_,m,s,o,l,i):T(_,m,s,o,l,i)}d!==p&&N(n,e,d,p,s),a&&!r(u.onDidUpdate)&&u.onDidUpdate(s),Cn(c,e)}}function N(n,e,t,o,l){var i=e._tag;t=t||{},o=o||{},"select"===n._tag&&xn(e);for(var u in o){var a=o[u],f=t[u];if(f!==a)if(r(a))b(i,u,l);else if("style"===u)O(f,a,l);else if(un(i,u))l[u]=a;else{var s=oe[u];s?l.setAttributeNS(s,u,a):l.setAttribute(u,a)}}for(var d in t)c(o[d])&&b(i,d,l)}function b(n,e,t){"className"===e?t.removeAttribute("class"):"id"===e?t.removeAttribute("id"):un(n,e)?t[e]=null:t.removeAttribute(e)}function O(n,e,t){if(l(e))t.style.cssText=e;else if(r(n)){if(!r(e))for(var o=Object.keys(e),u=0;u<o.length;u++){var a=o[u],c=e[a];i(c)&&!le[a]?t.style[a]=c+"px":t.style[a]=c}}else if(r(e))t.removeAttribute("style");else{for(var f=Object.keys(e),s=0;s<f.length;s++){var d=f[s],p=e[d];i(p)&&!le[d]?t.style[d]=p+"px":t.style[d]=p}for(var _=Object.keys(n),m=0;m<_.length;m++){var v=_[m];r(e[v])&&(t.style[v]="")}}}function I(n,t,l,i,u,a){var c=n._component,f=t._component,s=t._props||{};if(c!==f)dn(n,t,l,i,u,a);else if(e(t)){var p=(n._dom,n._instance),_=p.props,m=p.state,v=p.state,h=p.getChildContext();t._instance=p,p.context=u,r(h)||(u=Object.assign({},u,h));var g=p._updateComponent(m,v,_,s);g===Vn?g=p._lastInput:r(g)&&(g=d()),k(p._lastInput,g,l,i,u,null,!1),p._lastInput=g,p.componentDidUpdate(_,m),t._dom=g._dom,ae.set(p,g._dom)}else{var y=!0,E=n._props,x=t._hooks,T=!r(x);if(T&&!r(x.onComponentShouldUpdate)&&(y=x.onComponentShouldUpdate(n._dom,E,s)),y!==!1){T&&!r(x.onComponentWillUpdate)&&x.onComponentWillUpdate(n._dom,E,s);var w=f(s,u),C=n._instance;o(w)&&(w=d()),t._dom=n._dom,k(C,w,l,i,u,null,null,!1),t._instance=w,T&&!r(x.onComponentDidUpdate)&&x.onComponentDidUpdate(C._dom,E,s)}}}function M(n,e,t,r,o,l){var i=n._items,u=e._items,a=n._pointer;e._dom=n._dom,e._pointer=a,!i!==u&&(En(i,u)?S(i,u,t,r,o,l,e):A(i,u,t,r,o,l,e))}function A(n,e,t,r,o,l,i){for(var u=n.length,a=e.length,c=u>a?a:u,f=0;c>f;f++){var s=n[f],d=mn(e,f);k(s,d,t,r,o,l)}if(a>u)for(f=c;a>f;f++){var p=mn(e,f);cn(t,Nn(p,null,r,o,l),i&&i.pointer)}else if(u>a)for(f=c;u>f;f++)J(n[f],t)}function D(n,e){e._dom=n._dom}function L(n,e){var t=e._text,r=n._dom;e._dom=r,n.text!==t&&(r.nodeValue=t)}function S(n,e,t,r,o,l,i){for(var u,a=n.length,c=e.length,f=a-1,s=c-1,d=0,p=0,_=null,m=null,v=null,h=null;f>=d&&s>=p&&(m=e[p],_=n[d],m._key===_._key);)k(_,m,t,r,o,l,!1),p++,d++;for(;f>=d&&s>=p&&(v=e[s],h=n[f],v._key===h._key);)k(h,v,t,r,o,l,!1),s--,f--;for(;f>=d&&s>=p&&(v=e[s],_=n[d],v._key===_._key);)u=c>s+1?e[s+1]._dom:null,k(_,v,t,r,o,l,!1),cn(t,v._dom,u),s--,d++;for(;f>=d&&s>=p&&(m=e[p],h=n[f],m._key===h._key);)u=n[d]._dom,k(h,m,t,r,o,l,!1),cn(t,m._dom,u),p++,f--;if(d>f){if(s>=p)for(u=c>s+1?e[s+1]._dom:i&&i.pointer;s>=p;p++)cn(t,Nn(e[p],null,r,o,l),u)}else if(p>s)for(;f>=d;)J(n[d++],t);else{var g,y=f-d+1,E=s-p+1,x=new Array(E);for(g=0;E>g;g++)x[g]=-1;var T,w=!1,C=0,N=0;if(16>=y*E)for(g=d;f>=g;g++){var b=!0;for(h=n[g],T=p;s>=T;T++)if(v=e[T],h._key===v._key){x[T-p]=g,N>T?w=!0:N=T,k(h,v,t,r,o,l,!1),b=!1;break}b&&(J(h,t),C++)}else{var O=new Map;for(g=p;s>=g;g++)O.set(e[g]._key,g);for(g=f;g>=d;g--)h=n[g],T=O.get(h._key),void 0===T?(J(h,t),C++):(v=e[T],x[T-p]=g,N>T?w=!0:N=T,k(h,v,t,r,o,l,!1))}var I;if(w){var M=W(x);for(T=M.length-1,g=E-1;g>=0;g--)-1===x[g]?(I=g+p,u=c>I+1?e[I+1]._dom:i&&i.pointer,cn(t,Nn(e[I],null,r,o,l),u)):0>T||g!==M[T]?(I=g+p,u=c>I+1?e[I+1]._dom:i&&i.pointer,cn(t,e[I]._dom,u)):T--}else if(y-C!==E)for(g=E-1;g>=0;g--)-1===x[g]&&(I=g+p,u=c>I+1?e[I+1]._dom:i&&i.pointer,cn(t,Nn(e[I],null,r,o,l),u))}}function W(n){var e=n.slice(0),t=[];t.push(0);var r,o,l,i,u;for(r=0;r<n.length;r++)if(-1!==n[r])if(o=t[t.length-1],n[o]<n[r])e[r]=o,t.push(r);else{for(l=0,i=t.length-1;i>l;)u=(l+i)/2|0,n[t[u]]<n[r]?l=u+1:i=u;n[r]<n[t[l]]&&(l>0&&(e[r]=t[l-1]),t[l]=r)}for(l=t.length,i=t[l-1];l-- >0;)t[l]=i,i=e[i];return t}function U(n,e,t,r){var o=n._arg;return function(n,l,i,u,a,c){var f=n.read(o),s=l.read(o);f!==s&&(t?x(r,f,s,i,u,a,c||e):k(f,s,i,u,a,c||e))}}function P(n,e,t){var r=n.read(t);return e.write(t,r),r}function K(n){return function(e,t){return P(e,t,n)}}function R(e,r,l,i,a,c,s){if(!o(e)){var d,p,_,v=Yn,h=r?Hn:Yn,y=!1;if(m(e))d=Kn(e,a,c,s),p=U(e,a,c,s),_=en(e,c,s);else if(g(e)){var k=[],x=[],T=[],w=e._tag;"svg"===w&&(a=!0);var C=sn(w,a),N=e._key;!u(N)&&m(N)&&(v=N._arg);e._props,e._hooks;x.length>0&&h===Yn&&(h=l.length++);var b=e._children;if(!o(b))if(t(b));else if(n(b));else{var O=R(b,!1,l,C,a,!0,e._childrenType);if(!o(O)){k.push(O.mount);var I=O.patch,M=O.unmount;u(I)||x.push(I),u(M)||T.push(M)}}d=X(h,Rn(C,r,y),k),p=G(h,x),_=Y(h,T)}else if(E(e))throw new Error("Inferno Error: templates cannot contain VComponent nodes. Pass a VComponent node into a template as a variable instead.");return f(v,d,p,_)}}function X(n,e,t){return n===Yn&&0===t.length?e:t.length<=5?B(n,e,t[0],t[1],t[2],t[3]):F(n,e,t)}function B(n,e,t,r,o,l){var i=n!==Yn;return function(u,a,c,f,s){var d=e(u,a,c,f,s);return i&&u.write(n,d),t&&(t(u,d,c,f,s),r&&(r(u,d,c,f,s),o&&(o(u,d,c,f,s),l&&l(u,d,c,f,s)))),d}}function F(n,e,t){var r=n!==Yn;return function(o,l,i,u,a){var c=e(o,l,i,context);r&&o.write(n,c);for(var f=0;f<t.length;f++)t[f](o,c,i,context,a);return c}}function G(n,e){return 0===e.length?n!==Yn?K(n):null:e.length<=5?V(n,e[0],e[1],e[2],e[3],e[4]):j(n,e)}function V(n,e,t,r,o,l){var i=n!==Yn;return function(u,a,c,f,s){var d;i&&(d=P(u,a,n)),e&&(e(u,a,d,c,f,s),t&&(t(u,a,d,c,f,s),r&&(r(u,a,d,c,f,s),o&&(o(u,a,d,c,f,s),l&&l(u,a,d,c,f,s)))))}}function j(n,e){var t=n!==Yn;return function(r,o,l,i,u){var a;t&&(a=P(r,o,n));for(var c=0;c<e.length;c++)e[c](r,o,a,l,i,u)}}function Y(n,e){return e.length>0&&e.length<=5?H(n,e[0],e[1],e[2],e[3],e[4]):null}function H(n,e,t,r,o,l){return function(n){e&&(e(n),t&&(t(n),r&&(r(n),o&&(o(n),l&&l(n)))))}}function z(n,e,t,o){var l=n._tr,i=n._key,u=null===i?l._pools.nonKeyed:l._pools.keyed.get(i);if(!c(u)){var a=u.pop();if(!r(a))return w(a,n,null,e,t,o),n._dom}return null}function q(n){var e=n._tr,t=n._key,r=e._pools;if(null===t){var o=r.nonKeyed;o&&o.push(n)}else{var l=r.keyed.get(t);c(l)&&(l=[],r.keyed.set(t,l)),l.push(n)}return!0}function J(n,e,t){y(n)?Q(n,e):h(n)?Z(n,e,!0):g(n)?nn(n,e):E(n)&&$(n,e)}function Q(n,e){var t=n._dom,r=n._tr;r.unmount(n),u(e)||vn(e,t),$n&&q(n)}function Z(n,e,t){var r=n._items,o=r.length,l=r._pointer;if(o>0)for(var i=0;o>i;i++){var u=r[i];h(u)?Z(u,e,!0):(e&&vn(e,u._dom),J(u,null))}e&&t&&vn(e,l)}function $(n,e){var t=n._instance,o=null,l=null;r(t)||(o=t._hooks,l=t._children,void 0!==t.render&&(t.componentWillUnmount(),t._unmounted=!0,ae.delete(t),J(t._lastInput,null)));var i=n._hooks||o;r(i)||r(i.onComponentWillUnmount)||i.onComponentWillUnmount(n._dom,i)}function nn(e,t){var o=e._hooks,l=e._dom;r(o)||r(o.onWillDetach)||o.onWillDetach(e._dom);var i=e._children;if(!r(i))if(n(i))for(var u=0;u<i.length;u++)J(i[u],null);else J(i,null);t&&vn(t,l)}function en(n,e){return function(n){}}function tn(n,e,t){n.split(",").forEach(function(n){return e[n]=t})}function rn(n){var e=document.createElement(n),t={};for(var r in e)t[r]=!0;return ie.set(n,t),t}function on(n,e){""!==e?n.textContent=e:n.appendChild(document.createTextNode(""))}function ln(n,e,r){t(e)?n.firstChild.nodeValue=r:n.textContent=r}function un(n,e){var t=ie.get(n);return c(t)&&(t=rn(n)),t[e]}function an(n,e){n.appendChild(e)}function cn(n,e,t){r(t)?an(n,e):n.insertBefore(e,t)}function fn(n,e,t){var r=e._pointer;Z(e,n,!1),pn(n,t,r)}function sn(n,e){var t;return t=e===!0?document.createElementNS("http://www.w3.org/2000/svg",n):document.createElement(n)}function dn(n,e,t,o,l,i){var u=null,a=n._lastInput;r(a)||(u=n,n=a),J(n,!1);var c=Nn(e,null,o,l,i);e._dom=c,pn(t,c,n._dom),null!==u&&(u._lasInput=e)}function pn(n,e,t){n.replaceChild(e,t)}function _n(e){return t(e)?s(e):o(e)?d():n(e)?p(e):e}function mn(n,e){var t=n[e];return n[e]=_n(t)}function vn(n,e){n.removeChild(e)}function hn(){return document.activeElement}function gn(n,e){if(recyclingEnabled){var t=e.length;if(t>5)for(var r=0;t>r;r++){var l=e[r];o(l)||pool(l)}}n.textContent=""}function yn(n){null!==n&&n!==document.body&&document.activeElement!==n&&n.focus()}function En(n,e){return n.complex?!1:e.length&&!r(e[0])&&!r(e[0]._key)&&n.length&&!r(n[0])&&!r(n[0]._key)}function kn(n,e){if("option"===n._tag){var t=n._props&&n._props.value;e[t]?(n._props=n._props||{},n._props.selected=!0,n._dom.selected=!0):n._dom.selected=!1}else for(var r=0,o=n._children.length;o>r;r++)kn(n._children[r],e)}function xn(e){var t=e._props&&e._props.value,r={};if(n(t))for(var o=0,l=t.length;l>o;o++)r[t[o]]=t[o];else r[t]=t;for(var i=0,u=e._children.length;u>i;i++)kn(e._children[i],r);e._props&&e._props[t]&&delete e._props.value}function Tn(n,e,t){r(n.onCreated)||n.onCreated(t),r(n.onAttached)||e.addListener(function(){n.onAttached(t)})}function wn(n){var e=n.attrs.value;r(e)||(n._dom.value=e)}function Cn(n,e){if("input"===n){var t=e.attrs.type;if("text"===t)wn(e);else if("checkbox"===t||"radio"===t){var r=e.attrs.checked;e._dom.checked=!!r}}else"textarea"===n&&wn(e)}function Nn(n,e,t,r,o){switch(n._type){case zn.TEMPLATE:return bn(n,e,t,r,o);case zn.PLACEHOLDER:return An(n,e);case zn.TEXT:return Mn(n,e);case zn.FRAGMENT:return In(n,e,t,r,o);case zn.ELEMENT:return On(n,e,t,r,o);case zn.COMPONENT:return Un(n,e,t,r,o);default:throw Error("Inferno Error: Bad input argument called on mount(). Input argument may need normalising.")}}function bn(n,e,t,r,o){var l=n._tr,i=null;return $n&&(i=z(n,t,r,o)),u(i)&&(i=l.mount(n,null,t,r,o)),n._dom=i,u(e)||an(e,i),i}function On(n,e,t,o,i){var a=n._tag;if(!l(a))throw new Error("Inferno Error: expects VElement to have a string as the tag name");"svg"===a&&(i=!0);var c=sn(a,i),f=n._children,s=n._props,d=n._hooks;return n._dom=c,r(d)||Tn(d,t,c),r(f)||Wn(n._childrenType,f,c,t,o,i),r(s)||(Dn(n),Pn(n,s,c)),u(e)||an(e,c),c}function In(n,e,t,r,o){var l=n._items,i=document.createTextNode(""),u=document.createDocumentFragment();return mountArrayChildren(l,u,t,r,o),n._pointer=i,n._dom=u,an(u,i),e&&an(e,u),u}function Mn(n,e){var t=document.createTextNode(n._text);return n._dom=t,e&&an(e,t),t}function An(n,e){var t=document.createTextNode("");return n._dom=t,e&&an(e,t),t}function Dn(n){"select"===n.tag&&xn(n)}function Ln(n,e,t,r,o){n.complex=!1;for(var l=0;l<n.length;l++){var i=mn(n,l);_(i)?(Mn(i,e),n.complex=!0):v(i)?(An(i,e),n.complex=!0):h(i)?(In(i,e,t,r,o),n.complex=!0):Nn(i,e,t,r,o)}}function Sn(e,r,l,i,u){n(e)?Ln(e,r,l,i,u):t(e)?on(r,e):o(e)||Nn(e,r,l,i,u)}function Wn(n,e,t,r,o,l){switch(n){case jn.NON_KEYED_LIST:case jn.KEYED_LIST:for(var i=0;i<e.length;i++)Nn(e[i],t,r,o,l);break;case jn.UNKNOWN:Sn(e,t,r,o,l);break;case jn.TEXT:on(t,e);break;default:throw new Error("Inferno Error: Bad childrenType value specified when attempting to mountChildren")}}function Un(n,t,l,i,u){var a,c=n._component,f=n._props,s=n._hooks;if(e(n)){var p=new c(f,i);p._patch=k,p._componentToDOMNodeMap=ae;var _=p.getChildContext();r(_)||(i=Object.assign({},i,_)),p._unmounted=!1,p._pendingSetState=!0,p.componentWillMount();var m=p.render();o(m)&&(m=d()),p._pendingSetState=!1,a=Nn(m,null,l,i,!1),p._lastInput=m,p.componentDidMount(),null===t||o(a)||an(t,a),ae.set(p,a),n._dom=a,n._instance=p}else{r(s)||(r(s.onComponentWillMount)||s.onComponentWillMount(null,f),r(s.onComponentDidMount)||l.addListener(function(){s.onComponentDidMount(a,f)}));var v=c(f,i);o(v)&&(node=d()),a=Nn(v,null,l,i,null,!1),n._instance=v,null===t||o(a)||an(t,a),n._dom=a}return a}function Pn(n,e,t){for(var o in e){var l=e[o];if(!r(l))if("style"===o)O(null,l,t);else if(un(n._tag,o))t[o]=l;else{var i=oe[o];i?t.setAttributeNS(i,o,l):t.setAttribute(o,l)}}}function Kn(n,e,t,r){var o=n._arg;return function(n,l,i,u,a){var c=n.read(o);return t?Wn(r,c,l,i,u,a||e):Nn(c,l,i,u,a||e)}}function Rn(n,e,t){return function(e,r,o,l){var i=n.cloneNode(t);return u(r)||an(r,i),i}}function Xn(n,e,t){}function Bn(n){return ae.get(n)||null}function Fn(n,e){var t=ue.get(e),r=new Gn;if(c(t))o(n)||(Xn(n,e,r)||Nn(n,e,r,{},!1),r.trigger(),ue.set(e,{input:n}));else{var l=hn();u(n)?(J(t.input,e),ue.delete(e)):k(t.input,n,e,r,{},!1),r.trigger(),t.input=n,yn(l)}}var Gn=function(){this._listeners=[]};Gn.prototype.addListener=function(n){this._listeners.push(n)},Gn.prototype.trigger=function(){for(var n=this,e=0;e<this._listeners.length;e++)n._listeners[e]()};var Vn="NO_OP",jn={KEYED_LIST:0,NON_KEYED_LIST:1,TEXT:2,NODE:3,UNKNOWN:4},Yn=-1,Hn=-2,zn={ELEMENT:0,COMPONENT:1,TEMPLATE:2,TEXT:3,PLACEHOLDER:4,FRAGMENT:5,VARIABLE:6},qn=function(n){this._type=zn.TEXT,this._text=n,this._dom=null},Jn=function(){this._type=zn.PLACEHOLDER,this._dom=null},Qn=function(n){this._type=zn.FRAGMENT,this._dom=null,this._pointer=null,this._items=n},Zn=function(n,e,t,r){this._keyIndex=n,this._schema=null,this._pools={nonKeyed:[],keyed:new Map},this.mount=e,this.patch=t,this.unmount=r},$n=!0,ne="http://www.w3.org/1999/xlink",ee="http://www.w3.org/XML/1998/namespace",te={},re={},oe={},le={};tn("xlink:href,xlink:arcrole,xlink:actuate,xlink:role,xlink:titlef,xlink:type",oe,ne),tn("xml:base,xml:lang,xml:space",oe,ee),tn("volume,value",te,!0),tn("muted,scoped,loop,open,checked,default,capture,disabled,selected,readonly,multiple,required,autoplay,controls,seamless,reversed,allowfullscreen,novalidate",re,!0),tn("animationIterationCount,borderImageOutset,borderImageSlice,borderImageWidth,boxFlex,boxFlexGroup,boxOrdinalGroup,columnCount,flex,flexGrow,flexPositive,flexShrink,flexNegative,flexOrder,gridRow,gridColumn,fontWeight,lineClamp,lineHeight,opacity,order,orphans,tabSize,widows,zIndex,zoom,fillOpacity,floodOpacity,stopOpacity,strokeDasharray,strokeDashoffset,strokeMiterlimit,strokeOpacity,strokeWidth,",le,!0);var ie=new Map,ue=new Map,ae=new Map,ce={render:Fn,findDOMNode:Bn,mount:Nn,patch:k,unmount:J,createTemplateReducers:R};return ce});