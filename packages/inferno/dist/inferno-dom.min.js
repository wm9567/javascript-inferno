!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):e.InfernoDOM=n()}(this,function(){"use strict";function e(e,t){return r(e)||(n(e)&&e.length>0||!n(e))&&(t?t.children=e:t={children:e}),t}function n(e){return e.constructor===Array}function t(e){return e&&e.prototype&&e.prototype.render}function o(e){return"string"==typeof e||"number"==typeof e}function r(e){return void 0===e||null===e}function i(e){return"function"==typeof e}function l(e){return"o"===e[0]&&"n"===e[1]&&e.length>3}function a(e){return"string"==typeof e}function d(e,n,t){t?e.insertBefore(n,t):e.appendChild(n)}function u(e,n,t){if(t)""!==e?n.textContent=e:n.appendChild(document.createTextNode(""));else{var o=document.createTextNode(e);n.appendChild(o)}}function f(e,n,t,o,r){var i=_(n,null,o,r);t.replaceChild(i,e.dom),n.dom=i}function c(e){t(e.instance)&&(e.instance.componentWillUnmount(),e.instance._unmounted=!0),e.events&&e.events.willDetach&&e.events.willDetach(e.dom),e.events&&e.events.componentWillUnmount&&e.events.componentWillUnmount(e.dom,e.events);var n=e.children;if(n)if(isArray(n))for(var o=0;o<n.length;o++)c(n[o]);else c(n)}function s(e,n){var t=e.dom;c(e),t===n?t.innerHTML="":(n.removeChild(t),T&&pool(e))}function v(e,n,r,l,a,d){if(n!==!1&&null!==n){if(o(e))return void(o(n)&&(r.firstChild.nodeValue=n));var u=n.tag||(d?n["static"].tag:null),c=e.tag||(d?e["static"].tag:null);if(e.events&&e.events.willUpdate&&e.events.willUpdate(e.dom),c!==u)return void(i(c)&&!i(u)?t(c)?v(e.instance._lastNode,n,r,l,a,!0):v(e.instance,n,r,l,a,!0):f(e,n,r,l,a));if(i(c)&&i(u))return n.instance=e.instance,n.dom=e.dom,void C(n,n.tag,n.instance,e.attrs,n.attrs,n.events,n.children,r,l,a);var s=e.dom;n.dom=s,m(e,n,s,l,a,d),p(e,n,s),h(e,n,s),n.events&&n.events.didUpdate&&n.events.didUpdate(s)}}function m(e,t,i,l,a,d){var u=t.children,f=e.children;if(f!==u&&!r(f)&&!r(u))if(n(f))if(n(u)){var c=u.length&&!r(u[0].key)||f.length&&!r(f[0].key);c?b(f,u,i,l,a,null):k(f,u,i,l,a,null)}else k(f,[u],i,l,a,null);else n(u)?k([f],u,i,l,a,null):o(f)?o(u)&&(i.firstChild.nodeValue=u):v(f,u,i,l,a,d)}function p(e,n,t){var o=n.attrs,r=e.attrs;if(o)for(var i=0;i<o.length;i++){var l=r[i],a=o[i],d=l&&l.name,u=a&&a.name,f=l&&l.value,c=a&&a.value;d&&d===u&&g(d,f,c,t)}}function h(e,n,t){}function y(e,n,t,o,i){return r(e)?void _(n,t,o):r(n)?void s(e,t):e["static"]!==n["static"]?void v(e,n,t,o,i,!0):void v(e,n,t,o,i,!1)}function g(e,n,t,o){if(n!==t)if("className"===e)o.className=t;else if("style"===e)if(a(t))o.style.cssText=t;else for(var i in t){var d=t[i];o.style[i]=d}else l(e)||(t===!1||r(t)?o.removeAttribute(e):t===!0?o.setAttribute(e,e):o.setAttribute(e,t))}function C(n,o,r,i,l,a,d,u,f,c){if(l=e(d,l),t(o)){var s=r.props,m=r.state,p=r.state,h=r.getChildContext();h&&(c=_extends({},c,h)),r.context=c;var y=r._updateComponent(m,p,s,l);y&&(v(n,y,u,f,c,!1),n.dom=y.dom,r._lastNode=y)}else{var g=!0;if(a&&a.componentShouldUpdate&&(g=a.componentShouldUpdate(n.dom,i,l)),g!==!1){a&&a.componentWillUpdate&&a.componentWillUpdate(n.dom,i,l);var y=o(l),C=n.dom;y.dom=C,v(r,y,C,f,c,!1),n.instance=y,a&&a.componentDidUpdate&&a.componentDidUpdate(n.dom,i,l)}}}function k(e,n,t,o,r,i){var l=e.length,a=n.length,d=0,u=void 0;if(l>a)for(;l!==a;){var f=e[l-1];t.removeChild((u=f.dom)||u&&(u=u.previousSibling)||(u=t.lastChild)),l--}else if(a>l)for(;l!==a;){var c=n[l+d],s=_(c,null,o,r);t.appendChild(s),a--,d++}for(var v=0;a>v;v++){var f=e[v],c=n[v];f!==c&&y(f,c,t,o,r)}}function b(e,n,t,o,r,i){var l=!1,a=0,u=0,f=n.length,c=e.length,m=void 0,p=void 0;if(0===f&&c>=5){if(T)for(var h=0;c>h;h++)pool(e[h]);return void(t.textContent="")}var y=f-1,g=c-1,C=c>0?e[u]:null,k=f>0?n[a]:null,b=void 0,x=void 0,U=void 0;e:for(;!l&&y>=a&&g>=u;){for(l=!0;k.key===C.key;){if(v(C,k,t,o,r,!0),a++,u++,a>y||u>g)break e;k=n[a],C=e[u],l=!1}for(b=n[y],x=e[g];b.key===x.key;){if(v(x,b,t,o,r,!0),y--,g--,a>y||u>g)break e;b=n[y],x=e[g],l=!1}for(;b.key===C.key;){if(U=f>y+1?n[y+1].dom:i,v(C,b,t,o,r,!0),d(t,b.dom,U),y--,u++,a>y||u>g)break e;b=n[y],C=e[u],l=!1}for(;k.key===x.key;){if(U=e[u].dom,v(x,k,t,o,r,!0),d(t,k.dom,U),a++,g--,a>y||u>g)break e;k=n[a],x=e[g],l=!1}}if(u>g){if(y>=a)for(U=f>y+1?n[y+1].dom:i;y>=a;a++)m=n[a],d(t,_(m,null,o,r),U)}else if(a>y)for(;g>=u;u++)p=e[u],s(p,t);else{for(var N={},h=u;g>=h;h++)p=e[h],N[p.key]=p;for(var w=f>y+1?n[y+1]:null,h=y;h>=a;h--){m=n[h];var D=m.key;p=N[D],void 0!==p?(N[D]=null,v(p,m,t,o,!0),m.dom.nextSibling!==w&&(w=w&&w.dom||i,d(t,m.dom,w)),w=m):(w=w&&w.dom||i,d(t,_(m,null,o,r),w)),w=m}for(var h=u;g>=h;h++)p=e[h],null!==N[p.key]&&s(p,t)}}function x(e,n,t){if(A[e]){var o=A[e];o.push({callback:t,target:n})}else document.addEventListener(e,function(n){for(var t=A[e],o=t.length-1;o>-1;o--){var r=t[o];r.target===n.target&&r.callback(n)}},!1),A[e]=[]}function U(e,t,r,i){if(n(e))for(var l=0;l<e.length;l++){var a=e[l];o(a)?u(a,t,!1):_(a,t,r,i)}else o(e)?u(e,t,!0):_(e,t,r,i)}function N(n,o,r,i,l,a,d,u){if(r=e(l,r),t(o)){var f=new o(r);f._diffNodes=diffNodes;var c=f.getChildContext();c&&(u=_extends({},u,c)),f.context=u,f.componentWillMount();var s=f.render(),v=void 0;return s&&(v=_(s,null,d,u),f._lastNode=s,a&&a.appendChild(v),d.addListener(f.componentDidMount)),n.dom=v,n.instance=f,v}var m=function(){var e=void 0;i&&(i.componentWillMount&&i.componentWillMount(null,r),i.componentDidMount&&d.addListener(function(){i.componentDidMount(e,r)}));var t=o(r);return e=_(t,null,d,u),n.instance=t,a&&a.appendChild(e),n.dom=e,{v:e}}();return"object"===("undefined"==typeof m?"undefined":W["typeof"](m))?m.v:void 0}function _(e,t,l,a){var d=void 0;if(null!==e&&!r(e)&&!n(e)){if(o(e))return document.createTextNode(e);if(T&&(d=recycle(e,l,a)))return t&&t.appendChild(d),d;if(i(e.tag))return N(e,e.tag,e.attrs,e.events,e.children,t,l,a);d=e["static"].dom?e["static"].dom.cloneNode(!0):document.createElement(e.tag);var u=e.children,f=e.attrs,c=e.events;return c&&(c.click&&x("click",d,c.click),c.created&&c.created(d),c.attached&&l.addListener(function(){c.attached(d)})),f&&w(f,d),r(u)||U(u,d,l,a),e.dom=d,null!==t&&t.appendChild(d),d}}function w(e,n){for(var t=0;t<e.length;t++){var o=e[t],r=o&&o.name,i=o&&o.value;r&&g(r,null,i,n)}}function D(e){for(var n=0;n<j.length;n++){var t=j[n];if(t.dom===e)return t}return null}function M(e){for(var n=0;n<j.length;n++){var t=j[n];if(t===rootNode)return j.splice(n,1),!0}return!1}function S(e,n){var t=D(n),o=new L;r(t)?(_(e,n,o,{}),o.trigger(),j.push({node:e,dom:n})):(y(t.node,e,n,o,{}),o.trigger(),null===e&&M(t),t.node=e)}var W={};W["typeof"]="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},W.classCallCheck=function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")},W.createClass=function(){function e(e,n){for(var t=0;t<n.length;t++){var o=n[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(n,t,o){return t&&e(n.prototype,t),o&&e(n,o),n}}();var L=function(){function e(){W.classCallCheck(this,e),this._listeners=[]}return W.createClass(e,[{key:"addListener",value:function(e){this._listeners.push(e)}},{key:"trigger",value:function(){for(var e=0;e<this._listeners.length;e++)this._listeners[e]()}}]),e}(),T=!1,A={},j=[],E={render:S};return E});