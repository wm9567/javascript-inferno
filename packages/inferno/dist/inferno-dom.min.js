!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):e.InfernoDOM=n()}(this,function(){"use strict";function e(e,t){return r(e)||(n(e)&&e.length>0||!n(e))&&(t?t.children=e:t={children:e}),t}function n(e){return e.constructor===Array}function t(e){return e&&e.prototype&&e.prototype.render}function o(e){return"string"==typeof e||"number"==typeof e}function r(e){return void 0===e||null===e}function i(e){return"function"==typeof e}function a(e){return"o"===e[0]&&"n"===e[1]&&e.length>3}function l(e){return"string"==typeof e}function d(e,n,t){t?e.insertBefore(n,t):e.appendChild(n)}function u(e,n,t){if(t)""!==e?n.textContent=e:n.appendChild(document.createTextNode(""));else{var o=document.createTextNode(e);n.appendChild(o)}}function c(e,n,t,o,r){var i=D(n,null,o,r);t.replaceChild(i,e.dom),n.dom=i}function s(e){t(e.instance)&&(e.instance.componentWillUnmount(),e.instance._unmounted=!0),e.events&&e.events.willDetach&&e.events.willDetach(e.dom),e.events&&e.events.componentWillUnmount&&e.events.componentWillUnmount(e.dom,e.events);var o=e.children;if(o)if(n(o))for(var r=0;r<o.length;r++)s(o[r]);else s(o)}function f(e,n){var t=e.dom;s(e),t===n?t.innerHTML="":(n.removeChild(t),O&&x(e))}function v(e,n,t,o,i){return r(e)?void D(n,t,o):r(n)?void f(e,t):void g(e,n,t,o,i,null!==e.static&&null!==n.static)}function m(e,n,t,o){if(n!==t)if("className"===e)o.className=t;else if("style"===e)if(l(t))o.style.cssText=t;else for(var i in t)o.style[i]=t[i];else a(e)||(t===!1||r(t)?o.removeAttribute(e):t===!0?o.setAttribute(e,e):o.setAttribute(e,t))}function p(n,o,r,i,a,l,d,u,c,s){if(a=e(d,a),t(o)){var f=r.props,v=r.state,m=r.state,p=r.getChildContext();p&&(s=T.extends({},s,p)),r.context=s;var h=r._updateComponent(v,m,f,a);h&&(g(n,h,u,c,s,!1),n.dom=h.dom,r._lastNode=h)}else{var y=!0;if(l&&l.componentShouldUpdate&&(y=l.componentShouldUpdate(n.dom,i,a)),y!==!1){l&&l.componentWillUpdate&&l.componentWillUpdate(n.dom,i,a);var h=o(a),k=n.dom;h.dom=k,g(r,h,k,c,s,!1),n.instance=h,l&&l.componentDidUpdate&&l.componentDidUpdate(n.dom,i,a)}}}function h(e,n,t,o,r,i){var a=e.length,l=n.length;if(a>l)for(var d=void 0;a!==l;){var u=e[a-1];t.removeChild((d=u.dom)||d&&(d=d.previousSibling)||(d=t.lastChild)),a--}else if(l>a)for(var c=0;a!==l;){var s=n[a+c],f=D(s,null,o,r);t.appendChild(f),l--,c++}for(var m=0;l>m;m++){var u=e[m],s=n[m];u!==s&&v(u,s,t,o,r)}}function y(e,n,t,o,r,i){var a=!1,l=0,u=0,c=n.length,s=e.length,v=void 0,m=void 0;if(0===c&&s>=5){if(O)for(var p=0;s>p;p++)x(e[p]);return void(t.textContent="")}var h=c-1,y=s-1,k=s>0?e[u]:null,C=c>0?n[l]:null,b=void 0,N=void 0,U=void 0;e:for(;!a&&h>=l&&y>=u;){for(a=!0;C.key===k.key;){if(g(k,C,t,o,r,!0),l++,u++,l>h||u>y)break e;C=n[l],k=e[u],a=!1}for(b=n[h],N=e[y];b.key===N.key;){if(g(N,b,t,o,r,!0),h--,y--,l>h||u>y)break e;b=n[h],N=e[y],a=!1}for(;b.key===k.key;){if(U=c>h+1?n[h+1].dom:i,g(k,b,t,o,r,!0),d(t,b.dom,U),h--,u++,l>h||u>y)break e;b=n[h],k=e[u],a=!1}for(;C.key===N.key;){if(U=e[u].dom,g(N,C,t,o,r,!0),d(t,C.dom,U),l++,y--,l>h||u>y)break e;C=n[l],N=e[y],a=!1}}if(u>y){if(h>=l)for(U=c>h+1?n[h+1].dom:i;h>=l;l++)v=n[l],d(t,D(v,null,o,r),U)}else if(l>h)for(;y>=u;u++)m=e[u],f(m,t);else{for(var w={},p=u;y>=p;p++)m=e[p],w[m.key]=m;for(var _=c>h+1?n[h+1]:null,p=h;p>=l;p--){v=n[p];var M=v.key;m=w[M],void 0!==m?(w[M]=null,g(m,v,t,o,!0),v.dom.nextSibling!==_&&(_=_&&_.dom||i,d(t,v.dom,_)),_=v):(_=_&&_.dom||i,d(t,D(v,null,o,r),_)),_=v}for(var p=u;y>=p;p++)m=e[p],null!==w[m.key]&&f(m,t)}}function g(e,n,r,a,l,d){if(n!==!1&&null!==n){if(o(e))return void(o(n)&&(r.firstChild.nodeValue=n));var u=n.tag||(d?n.static.tag:null),s=e.tag||(d?e.static.tag:null);if(e.events&&e.events.willUpdate&&e.events.willUpdate(e.dom),s!==u)return void(i(s)&&!i(u)?t(s)?g(e.instance._lastNode,n,r,a,l,!0):g(e.instance,n,r,a,l,!0):c(e,n,r,a,l));if(i(s)&&i(u))return n.instance=e.instance,n.dom=e.dom,void p(n,n.tag,n.instance,e.attrs,n.attrs,n.events,n.children,r,a,l);var f=e.dom;n.dom=f,k(e,n,f,a,l,d),e.className!==n.className&&(f.className=n.className),C(e,n,f),b(e,n,f),n.events&&n.events.didUpdate&&n.events.didUpdate(f)}}function k(e,t,i,a,l,d){var u=t.children,c=e.children;if(c!==u&&!r(c)&&!r(u))if(n(c))if(n(u)){var s=u.length&&!r(u[0].key)||c.length&&!r(c[0].key);s?y(c,u,i,a,l,null):h(c,u,i,a,l,null)}else h(c,[u],i,a,l,null);else n(u)?h([c],u,i,a,l,null):o(c)?o(u)&&(i.firstChild.nodeValue=u):g(c,u,i,a,l,d)}function C(e,n,t){var o=n.attrs,r=e.attrs;if(o)for(var i=0;i<o.length;i++){var a=r[i],l=o[i],d=a&&a.name,u=l&&l.name,c=a&&a.value,s=l&&l.value;d&&d===u&&m(d,c,s,t)}}function b(e,n,t){}function N(e,n,t){var o=e.key,r=void 0;if(null!==o){var i=e.static.static.keyed[o];r=i&&i.pop()}else{var i=e.static.static.nonKeyed;r=i&&i.pop()}return r?(g(r,e,null,n,t,null,!0),e.dom):void 0}function x(e){var n=e.key,t=e.static.static;if(null===n){var o=t.nonKeyed;o&&o.push(e)}else{var r=t.keyed;(r[n]||(r[n]=[])).push(e)}}function U(e,n,t){if(A[e]){var o=A[e];o.push({callback:t,target:n})}else document.addEventListener(e,function(n){for(var t=A[e],o=t.length-1;o>-1;o--){var r=t[o];r.target===n.target&&r.callback(n)}},!1),A[e]=[]}function w(e,t,r,i){if(n(e))for(var a=0;a<e.length;a++){var l=e[a];o(l)?u(l,t,!1):D(l,t,r,i)}else o(e)?u(e,t,!0):D(e,t,r,i)}function _(n,o,r,i,a,l,d,u){if(r=e(a,r),t(o)){var c=new o(r);c._diffNodes=g;var s=c.getChildContext();s&&(u=T.extends({},u,s)),c.context=u,c.componentWillMount();var f=c.render(),v=void 0;return f&&(v=D(f,null,d,u),c._lastNode=f,l&&l.appendChild(v),d.addListener(c.componentDidMount)),n.dom=v,n.instance=c,v}var m=function(){var e=void 0;i&&(i.componentWillMount&&i.componentWillMount(null,r),i.componentDidMount&&d.addListener(function(){i.componentDidMount(e,r)}));var t=o(r);return e=D(t,null,d,u),n.instance=t,l&&l.appendChild(e),n.dom=e,{v:e}}();return"object"===("undefined"==typeof m?"undefined":T.typeof(m))?m.v:void 0}function D(e,t,a,l){var d=void 0;if(!r(e)&&!n(e)){if(o(e))return document.createTextNode(e);if(O&&(d=N(e,a,l)))return t&&t.appendChild(d),d;if(i(e.tag))return _(e,e.tag,e.attrs,e.events,e.children,t,a,l);d=e.static.dom?e.static.dom.cloneNode(!0):document.createElement(e.tag);var u=e.children,c=e.attrs,s=e.events;return s&&(s.click&&U("click",d,s.click),s.created&&s.created(d),s.attached&&a.addListener(function(){s.attached(d)})),r(u)||w(u,d,a,l),c&&M(c,d),r(e.className)||(d.className=e.className),e.dom=d,null!==t&&t.appendChild(d),d}}function M(e,n){for(var t=0;t<e.length;t++){var o=e[t],r=o&&o.name,i=o&&o.value;r&&m(r,null,i,n)}}function S(e){for(var n=0;n<E.length;n++){var t=E[n];if(t.dom===e)return t}return null}function W(e){for(var n=0;n<E.length;n++){var t=E[n];if(t===e)return E.splice(n,1),!0}return!1}function L(e,n){var t=S(n),o=new j;r(t)?(D(e,n,o,{}),o.trigger(),E.push({node:e,dom:n})):(v(t.node,e,n,o,{}),o.trigger(),null===e&&W(t),t.node=e)}var T={};T.typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},T.classCallCheck=function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")},T.createClass=function(){function e(e,n){for(var t=0;t<n.length;t++){var o=n[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(n,t,o){return t&&e(n.prototype,t),o&&e(n,o),n}}(),T.extends=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e};var j=function(){function e(){T.classCallCheck(this,e),this._listeners=[]}return T.createClass(e,[{key:"addListener",value:function(e){this._listeners.push(e)}},{key:"trigger",value:function(){for(var e=0;e<this._listeners.length;e++)this._listeners[e]()}}]),e}(),O=!0,A={},E=[],K={render:L};return K});