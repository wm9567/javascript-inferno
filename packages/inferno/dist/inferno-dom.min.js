!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):e.InfernoDOM=n()}(this,function(){"use strict";function e(e,t){if(!l(e)){var r=n(e);(r&&e.length>0||!r)&&(t?t.children=e:t={children:e})}return t}function n(e){return e instanceof Array}function t(e){return!l(e)&&!l(e.prototype.render)}function r(e){return"string"==typeof e||"number"==typeof e}function l(e){return void 0===e||null===e}function o(e){return void 0===e||null===e||e===!1}function i(e){return"function"==typeof e}function a(e){return"o"===e[0]&&"n"===e[1]&&e.length>3}function s(e){return"string"==typeof e}function d(e){return e instanceof Promise}function u(e,n,t){e.splice(e.indexOf(n),1,t)}function f(e,n,t){l(t)?void 0!==n.append?n.append(e):e.appendChild(n):void 0!==n.insert?n.insert(e,t):void 0!==t.insert?e.insertBefore(n,t.childNodes[0]):e.insertBefore(n,t)}function c(e,n){return l(n)?document.createElement(e):document.createElementNS(n,e)}function v(e,n,t){if(!n)return document.createTextNode(e);if(!t){var r=document.createTextNode(e);return n.appendChild(r),r}if(""===e){var r=document.createTextNode("");return n.appendChild(r),r}n.textContent=e}function p(e,n,t,r,o,i,a){var s=null,d=e._lastNode;l(d)||(s=e,e=d);var u=z(n,null,r,o,i,a);n.dom=u,t.replaceChild(u,e.dom),null!==s&&(s._lastNode=n),h(e)}function h(e){if(!o(e)&&!r(e)){var t=e.instance,i=null,a=null;l(t)||(i=t.hooks,a=t.children,void 0!==t.render&&(t.componentWillUnmount(),t._unmounted=!0));var s=e.hooks||i;l(s)||(l(s.willDetach)||s.willDetach(e.dom),l(s.componentWillUnmount)||s.componentWillUnmount(e.dom,s));var d=e.children||a;if(!l(d))if(n(d))for(var u=0;u<d.length;u++)h(d[u]);else h(d)}}function m(){return document.createTextNode("")}function g(e,n){var t=e.dom;t===n?t.innerHTML="":(n.removeChild(t),se&&q(e)),h(e)}function y(e,n){for(var t in e)n[t]=null}function C(e,n,t){for(var r=0;r<n.length;r++)e.insertBefore(n[r],t)}function k(){return document.activeElement}function b(e){e!==document.body&&document.activeElement!==e&&e.focus()}function N(){var e=[],n=document.createTextNode(""),t=null,r={childNodes:e,appendChild:function(r){e.push(r),t&&t.insertBefore(r,n)},removeChild:function(n){t&&t.removeChild(n),e.splice(e.indexOf(n),1)},insertBefore:function(n,r){t&&t.insertBefore(n,r),e.splice(e.indexOf(r),0,n)},replaceChild:function(n,r){t.replaceChild(n,r),u(e,r,n)},append:function(r){r.appendChild(n),t=r,C(t,e,n)},insert:function(r,l){r.insertBefore(n,l),t=r,C(t,e,n)},remove:function(){t.removeChild(n);for(var r=0;r<e.length;r++)t.removeChild(e[r]);t=null},getElementsByTagName:null};return Object.defineProperty(r,"parentNode",{get:function(){return t}}),Object.defineProperty(r,"firstChild",{get:function(){return e[0]}}),r}function x(e,n){return n.length&&!l(n[0])&&!l(n[0].key)||e.length&&!l(e[0])&&!l(e[0].key)}function w(e,n){if("option"===e.tag){var t=e.attrs&&e.attrs.value;n[t]&&(e.attrs=e.attrs||{},e.attrs.selected="selected")}else for(var r=0,l=e.children.length;l>r;r++)w(e.children[r],n)}function O(e){if("select"===e.tag){var t=e.attrs&&e.attrs.value;if(!l(t)){var r={};if(n(t))for(var o=0,i=t.length;i>o;o++)r[t[o]]=t[o];else r[t]=t;w(e,r),e.attrs&&e.attrs[t]&&delete e.attrs.value}}}function U(e,n){var t=m();return null!==n&&n.appendChild(t),o(e)||(e.dom=t),t}function S(e,n,t){l(e.created)||e.created(t),l(e.attached)||n.addListener(function(){e.attached(t)})}function T(e,t,i,a,s,d,u,f){var c=t.children,v=e.children;if(v!==c){var p=null;e.domChildren&&(p=t.domChildren=e.domChildren),o(v)?r(c)?D(i,v,c):l(c)||(n(c)?Q(t,c,i,a,s,d,u):z(c,i,a,s,d,u)):o(c)?i.textContent="":n(v)?n(c)?null===p&&v.length>1?K(v,c,i,a,s,d,u):x(v,c)?K(v,c,i,a,s,d,u):I(v,c,i,p||(t.domChildren=[]),a,s,d,u,0):I(v,[c],i,p||[],a,s,d,u,0):n(c)?I([v],c,i,p||(t.domChildren=[i.firstChild]),a,s,d,u,0):r(c)?D(i,v,c):r(v)?W(v,c,i,a,s,d,u,null):W(v,c,i,a,s,d,u,f)}}function _(e,n,t,r){e&&(s(n)&&delete e.refs[n],s(t)&&(e.refs[t]=r))}function j(e,n,t){var r=n.events,o=e.events,i=!l(r),a=!l(o);i?a?L(o,r,t):Z(r,t):a&&y(o,t)}function M(e,n,t,r){"select"===e.tag&&O(n);var o=n.attrs,i=e.attrs,a=l(o),s=l(i);if(!a)for(var d=Object.keys(o),u=d.length,f=0;u>f;f++){var c=d[f],v=!s&&i[c],p=o[c];v!==p&&("ref"===c?_(r,v,p,t):P(c,p,t))}if(!s)for(var h=Object.keys(i),u=h.length,f=0;u>f;f++){var c=h[f];(a||l(o[c]))&&("ref"===c?_(r,i[c],null,t):t.removeAttribute(c))}}function E(e,n,r,o,i,a,s,d,u,f){var c=void 0;n.hasHooks===!0&&(c=n.hooks&&!l(c.willUpdate))&&c.willUpdate(e.dom);var v=n.tag||f&&r.tag,h=e.tag||f&&o.tag;if(h!==v)if(e.tpl.isComponent===!0){var m=e.instance;o.isComponent===!0?p(m||e,n,i,a,s,d,u):t(h)?A(m._lastNode,n,i,a,s,d,u,!0):A(m,n,i,a,s,d,u,!0)}else p(e,n,i,a,s,d,u);else if(l(h))n.dom=e.dom;else if(r.isComponent===!0)o.isComponent===!0&&(n.instance=e.instance,n.dom=e.dom,H(n,n.tag,n.instance,e.attrs||{},n.attrs||{},n.hooks,n.children,i,s,d));else{var g=e.dom;if(n.dom=g,r.childrenType>0&&T(e,n,g,a,s,d,u,f),r.hasAttrs===!0&&M(e,n,g,u),r.hasEvents===!0&&j(e,n,g),r.hasClassName===!0){var y=n.className;e.className!==y&&(l(y)?g.removeAttribute("class"):g.className=y)}if(r.hasStyle===!0){var C=n.style;e.style!==C&&V(e.style,C,g)}n.hasHooks!==!0||l(c.didUpdate)||c.didUpdate(g)}}function A(e,n,r,o,a,s,u,f){if(d(n))n.then(function(n){A(e,n,r,o,a,s,f,u)});else{var c=n.hooks,v=!l(c);v&&!l(c.willUpdate)&&c.willUpdate(e.dom);var h=n.tag||(f&&!l(n.tpl)?n.tpl.tag:null),m=e.tag||(f&&!l(e.tpl)?e.tpl.tag:null);if(o=o||"svg"===h?ae:"math"===h?ie:null,m!==h){var g=e.instance;i(m)?i(h)?p(g||e,n,r,o,a,s,u):t(m)?A(g._lastNode,n,r,o,a,s,u,!0):A(g,n,r,o,a,s,u,!0):p(g||e,n,r,o,a,s,u)}else if(l(m))n.dom=e.dom;else if(i(m))i(h)&&(n.instance=e.instance,n.dom=e.dom,H(n,n.tag,n.instance,e.attrs||{},n.attrs||{},n.hooks,n.children,r,a,s));else{var y=e.dom,C=n.className,k=n.style;n.dom=y,T(e,n,y,o,a,s,u,f),M(e,n,y,u),j(e,n,y),e.className!==C&&(l(C)?y.removeAttribute("class"):y.className=C),e.style!==k&&V(e.style,k,y),v&&!l(c.didUpdate)&&c.didUpdate(y)}}}function B(e){switch(e.length){case 5:return"value"===e;case 7:return"checked"===e;case 8:return"disabled"===e||"selected"===e;default:return!1}}function D(e,n,t){r(n)?e.firstChild.nodeValue=t:e.textContent=t}function W(e,n,t,l,i,a,s,d){if(null!==d){var u=e.tpl,f=n.tpl;void 0===u?A(e,n,t,l,i,a,s,!0):E(e,n,u,f,t,l,i,a,s,!0)}else if(o(e))z(n,t,l,i,a,s);else if(o(n))g(e,t);else if(r(e))if(r(n))t.firstChild.nodeValue=n;else{var c=z(n,null,l,i,a,s);n.dom=c,t.replaceChild(c,t.firstChild)}else if(r(n)){var v=document.createTextNode(n);t.replaceChild(v,e.dom)}else{var u=e.tpl,f=n.tpl,p=u!==f;void 0===u?A(e,n,t,l,i,a,s,p):E(e,n,u,f,t,l,i,a,s,p)}}function V(e,n,t){if(s(n))t.style.cssText=n;else if(l(e)){if(!l(n))for(var r=Object.keys(n),o=0;o<r.length;o++){var i=r[o],a=n[i];t.style[i]=a}}else if(l(n))t.removeAttribute("style");else{for(var r=Object.keys(n),o=0;o<r.length;o++){var i=r[o],a=n[i];t.style[i]=a}for(var d=Object.keys(e),o=0;o<d.length;o++){var i=d[o];l(n[i])&&(t.style[i]="")}}}function L(e,n,t){for(var r=Object.keys(n),o=0;o<r.length;o++){var i=r[o],a=e[i],s=n[i];a!==s&&(t[i]=s)}for(var d=Object.keys(e),o=0;o<d.length;o++){var i=d[o];l(n[i])&&(t[i]=null)}}function P(e,n,t){if(!a(e)){if(B(e))return void(t[e]=n);n===!1||l(n)?t.removeAttribute(e):":"===e[5]&&-1!==e.indexOf("xlink:")?t.setAttributeNS("http://www.w3.org/1999/xlink",e,n===!0?e:n):":"===e[4]&&-1!==e.indexOf("xml:")?t.setAttributeNS("http://www.w3.org/XML/1998/namespace",e,n===!0?e:n):t.setAttribute(e,n===!0?e:n)}}function H(n,r,o,i,a,s,d,u,f,c){if(a=e(d,a),t(r)){var v=o.props,p=o.state,h=o.state,m=o.getChildContext();l(m)||(c=le.extends({},c,m)),o.context=c;var g=o._updateComponent(p,h,v,a);l(g)||(A(n,g,u,null,f,c,o,!0),n.dom=g.dom,o._lastNode=g)}else{var y=!0,C=!l(s);if(C&&!l(s.componentShouldUpdate)&&(y=s.componentShouldUpdate(n.dom,i,a)),y!==!1){C&&!l(s.componentWillUpdate)&&s.componentWillUpdate(n.dom,i,a);var g=r(a),k=n.dom;g.dom=k,A(o,g,k,null,f,c,null,!0),n.instance=g,C&&!l(s.componentDidUpdate)&&s.componentDidUpdate(n.dom,i,a)}}}function I(e,t,i,a,s,d,u,c,v){var p=void 0===i.append,g=e.length,y=t.length,C=g===y;if(C===!1)if(g>y)for(;g!==y;){var k=e[g-1];o(k)||(i.removeChild(a[g-1+v]),h(k)),g--}else for(;g!==y;){var b=t[g],w=void 0;w=r(b)?document.createTextNode(b):z(b,null,s,d,u,c),f(i,w),p&&(1===g&&a.push(i.firstChild),p&&a.splice(g+v,0,w)),g++}for(var O=0;y>O;O++){var k=e[O],b=t[O],U=O+v;if(k!==b)if(o(b)){if(!o(k)){var S=a[U];if(!l(S))if(r(k))S.nodeValue="";else if(C===!0){var T=m();n(k)&&0===k.length?(f(i,T),p&&a.splice(U,0,T)):(i.replaceChild(T,a[U]),p&&a.splice(U,1,T),h(k))}}}else if(o(k)){if(r(b)){var T=document.createTextNode(b);i.replaceChild(T,a[U]),p&&a.splice(U,1,T)}else if(C===!0){var w=z(b,null,s,d,u,c);i.replaceChild(w,a[U]),p&&a.splice(U,1,w)}}else if(r(b))if(1===g)r(k)?void 0!==i.getElementsByTagName?i.firstChild.nodeValue=b:i.nodeValue=b:(h(k),i.textContent=b);else{var T=document.createTextNode(b),_=a[U];l(_)?i.nodeValue=T.nodeValue:void 0===_.append?(p&&a.splice(U,1,T),i.replaceChild(T,_)):(i.insertBefore(T,_.firstChild),_.remove(),a.splice(0,a.length,T)),h(k)}else if(n(b))if(x(k,b))K(k,b,a[U],s,d,u,c);else if(n(k)){var j=a[U];if(void 0===j.append)if(b.length>1&&1===k.length){var M=N();M.insert(i,j),M.appendChild(j),p&&a.splice(U,1,M),I(k,b,M,M.childNodes,s,d,u,c,0)}else I(k,b,i,a,s,d,u,c,0);else I(k,b,a[U],a[U].childNodes,s,d,u,c,0)}else if(b.length>1){var M=N();M.appendChild(i.firstChild),f(i,M,i.firstChild),p&&a.splice(U,1,M),I([k],b,M,M.childNodes,s,d,u,c,O)}else I([k],b,i,a,s,d,u,c,O);else n(k)?I(k,[b],a,a[U].childNodes,s,d,u,c,0):W(k,b,i,s,d,u,c,null)}}function K(e,n,t,r,o,i,a){var s=n.length,d=e.length;if(0===s&&d>=5){if(se)for(var u=0;d>u;u++)q(e[u]);return void(t.textContent="")}var c=void 0,v=!1,p=0,h=0,m=s-1,y=d-1,C=d>0?e[h]:null,k=s>0?n[p]:null,b=void 0,N=void 0,x=void 0;e:for(;!v&&m>=p&&y>=h;){for(v=!0;k.key===C.key;){if(W(C,k,t,r,o,i,a,!0),p++,h++,p>m||h>y)break e;k=n[p],C=e[h],v=!1}for(b=n[m],N=e[y];b.key===N.key;){if(W(N,b,t,r,o,i,a,!0),m--,y--,p>m||h>y)break e;b=n[m],N=e[y],v=!1}for(;b.key===C.key;){if(x=s>m+1?n[m+1].dom:null,W(C,b,t,r,o,i,a,!0),f(t,b.dom,x),m--,h++,p>m||h>y)break e;b=n[m],C=e[h],v=!1}for(;k.key===N.key;){if(x=e[h].dom,W(N,k,t,r,o,i,a,!0),f(t,k.dom,x),p++,y--,p>m||h>y)break e;k=n[p],N=e[y],v=!1}}if(h>y){if(m>=p)for(x=s>m+1?n[m+1].dom:null;m>=p;p++)f(t,z(n[p],null,r,o,i,a),x)}else if(p>m)for(;y>=h;h++)c=e[h],g(c,t);else{for(var w=new Map,u=h;y>=u;u++)c=e[u],w.set(c.key,c);x=s>m+1?n[m+1]:null;for(var u=m;u>=p;u--){var O=n[u],U=O.key;c=w.get(U),x=l(x)?void 0:x.dom,void 0===c?f(t,z(O,null,r,o,i,a),x):(w.delete(U),W(c,O,t,r,o,i,a,!0),O.dom.nextSibling!==x&&f(t,O.dom,x)),x=O}for(var u=h;y>=u;u++)c=e[u],w.has(c.key)&&g(c,t)}}function X(e,n,t,r,o){if(void 0!==n){var i=e.key,a=null===i?n.pools.nonKeyed:n.pools.keyed[i];if(!l(a)){var s=a.pop();if(!l(s))return W(s,e,null,null,t,r,o,!0),e.dom}}return null}function q(e){var n=e.tpl;if(!l(n)){var t=e.key,r=n.pools;if(null===t){var o=r.nonKeyed;o&&o.push(e)}else{var i=r.keyed;(i[t]||(i[t]=[])).push(e)}return!0}return!1}function z(e,t,r,l,i,a){if(o(e)||n(e))return U(e,t);var s=e.tpl;if(se){var d=X(e,s,l,i,a);if(null!==d)return null!==t&&t.appendChild(d),d}return void 0===s?G(e,t,r,l,i,a):F(e,s,t,r,l,i,a)}function F(e,n,t,r,l,o,i){var a=e.tag;if(n.isComponent===!0)return $(e,a,e.attrs||{},e.hooks,e.children,t,l,o);var s=n.dom.cloneNode(!0);switch(e.dom=s,n.hasHooks===!0&&S(e.hooks,l,s),n.childrenType){case 1:v(e.children,s,!0);break;case 2:z(e.children,s,r,l,o,i);break;case 3:Q(e,e.children,s,r,l,o,i);break;case 4:R(e,e.children,s,r,l,o,i)}return n.hasAttrs===!0&&ee(e,e.attrs,s,i),n.hasClassName===!0&&(s.className=e.className),n.hasStyle===!0&&V(null,e.style,s),n.hasEvents===!0&&Z(e.events,s),null!==t&&t.appendChild(s),s}function G(e,n,t,r,a,d){var u=e.tag;if(null===u)return U(e,n);if(i(u))return $(e,u,e.attrs||{},e.hooks,e.children,n,r,a);if(t=t||"svg"===u?ae:"math"===u?ie:null,!s(u)||""===u)throw Error("Inferno Error: Expected function or string for element tag type");var f=c(u,t),v=e.children,p=e.attrs,h=e.events,m=e.hooks,g=e.className,y=e.style;return e.dom=f,l(m)||S(m,r,f),o(v)||R(e,v,f,t,r,a,d),l(p)||ee(e,p,f,d),l(g)||(f.className=g),l(y)||V(null,y,f),l(h)||Z(h,f),null!==n&&n.appendChild(f),f}function J(e,n,t,r,l,o,i){var a=m();t&&t.push(a),e.then(function(e){var s=z(e,null,r,l,o,i);n.replaceChild(s,a),t&&u(t,a,s)}),n.appendChild(a)}function Q(e,t,i,a,s,u,c){for(var p=null,h=!1,m=!1,g=0;g<t.length;g++){var y=t[g];if(r(y))h=!0,p=p||[],p.push(v(y,i,!1));else if(!l(y)&&n(y)){var C=N();h=!0,Q(e,y,C,a,s,u,c),f(i,C),p=p||[],p.push(C)}else if(d(y))J(y,i,p,a,s,u,c);else{var k=z(y,i,a,s,u,c);h||!m&&y&&l(y.key)?(h=!0,p=p||[],p.push(k)):o(y)?(h=!0,p=p||[],p.push(k)):m===!1&&(m=!0)}}null!==p&&p.length>1&&h===!0&&(e.domChildren=p)}function R(e,t,l,o,i,a,s){n(t)?Q(e,t,l,o,i,a,s):r(t)?v(t,l,!0):d(t)?J(t,l,null,o,i,a,s):z(t,l,o,i,a,s)}function Y(e,n,t){!o(e)&&s(n)&&(e.refs[n]=t)}function Z(e,n){for(var t=Object.keys(e),r=0;r<t.length;r++){var l=t[r];n[l]=e[l]}}function $(n,r,o,i,a,s,d,u){o=e(a,o);var f=void 0;if(t(r)){var c=new r(o);c._diffNodes=A;var v=c.getChildContext();l(v)||(u=le.extends({},u,v)),c.context=u,c._pendingSetState=!0,c.componentWillMount();var p=c.shouldComponentUpdate();if(p){c.componentWillUpdate();var h=c._pendingState,m=c.state;c.state=le.extends({},m,h)}var g=c.render();return c._pendingSetState=!1,l(g)||(f=z(g,null,null,d,u,c),c._lastNode=g,null!==s&&s.appendChild(f),c.componentDidMount(),c.componentDidUpdate()),n.dom=f,n.instance=c,f}l(i)||(l(i.componentWillMount)||i.componentWillMount(null,o),l(i.componentDidMount)||d.addListener(function(){i.componentDidMount(f,o)}));var y=r(o);return f=z(y,null,null,d,u,null),n.instance=y,null!==s&&s.appendChild(f),n.dom=f,f}function ee(e,n,t,r){"select"===e.tag&&O(e);for(var l=Object.keys(n),o=0;o<l.length;o++){var i=l[o];"ref"===i?Y(r,n[i],t):P(i,n[i],t)}}function ne(e){for(var n=0;n<de.length;n++){var t=de[n];if(t.dom===e)return t}return null}function te(e){for(var n=0;n<de.length;n++){var t=de[n];if(t===e)return void de.splice(n,1)}}function re(e,n){var t=ne(n),r=new oe;if(null===t)z(e,n,null,r,{},null),r.trigger(),de.push({node:e,dom:n});else{var l=k();W(t.node,e,n,null,r,{},null,null),r.trigger(),null===e&&te(t),t.node=e,b(l)}}var le={};le.typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},le.classCallCheck=function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")},le.createClass=function(){function e(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(n,t,r){return t&&e(n.prototype,t),r&&e(n,r),n}}(),le.extends=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e};var oe=function(){function e(){le.classCallCheck(this,e),this._listeners=[]}return le.createClass(e,[{key:"addListener",value:function(e){this._listeners.push(e)}},{key:"trigger",value:function(){for(var e=0;e<this._listeners.length;e++)this._listeners[e]()}}]),e}(),ie="http://www.w3.org/1998/Math/MathML",ae="http://www.w3.org/2000/svg",se=!0,de=[],ue={render:re};return ue});