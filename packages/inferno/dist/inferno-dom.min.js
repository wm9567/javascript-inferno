!function(n,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):n.InfernoDOM=e()}(this,function(){"use strict";function n(n){return n instanceof Array}function e(n){return a(n._isStateful)}function t(n){return i(n)||l(n)}function r(n){return f(n)||u(n)}function o(n){return u(n)||n===!1||a(n)||f(n)}function i(n){return"string"==typeof n}function l(n){return"number"==typeof n}function u(n){return null===n}function a(n){return n===!0}function f(n){return void 0===n}function c(n){return n===Jn.KEYED_LIST}function s(n){return n===Jn.NON_KEYED_LIST}function d(n){return n===Jn.TEXT}function p(n){return n===Jn.NODE}function _(n){return n===Jn.UNKNOWN}function m(n,e,t,r){return new re(n,e,t,r)}function v(n){return new ne(n)}function h(){return new ee}function g(n){return new te(n)}function y(n){return n._type===$n.TEXT}function E(n){return n._type===$n.VARIABLE}function x(n){return n._type===$n.PLACEHOLDER}function k(n){return n._type===$n.FRAGMENT}function w(n){return n._type===$n.ELEMENT}function C(n){return n._type===$n.TEMPLATE}function T(n){return n._type===$n.COMPONENT}function N(n,e,t,r,o,i){if(n!==e)if(C(e))C(n)&&I(n,e,t,r,o,i);else if(C(n));else if(T(e))T(n)?S(n,e,t,r,o,i):(gn(t,Vn(e,null,r,o,i),n._dom),en(n,null));else if(T(n));else if(k(e))k(n)?W(n,e,t,r,o,i):(gn(t,Sn(e,null),n._dom),en(n,null));else if(w(e))w(n)?M(n,e,t,r,o,i):(gn(t,An(e,null,r,o,i),n._dom),en(n,null));else if(w(n))gn(t,An(e,null,r,o,i),n._dom),en(n,null);else if(k(n))mn(t,n,An(e,null,r,o,i));else if(x(e))x(n)?P(n,e):(gn(t,Un(e,null),n._dom),en(n,null));else if(x(n))gn(t,An(e,null,r,o,i),n._dom);else if(y(e))y(n)?R(n,e):(gn(t,Wn(e,null),n._dom),en(n,null));else{if(!y(n))throw Error("Inferno Error: Bad input argument called on patch(). Input argument may need normalising.");gn(t,An(e,null,r,o,i),n._dom)}}function O(n,e,t,r,o,i,l){if(d(n))sn(r,e,t);else if(p(n))N(e,t,r,o,i,l);else if(c(n))K(e,t,r,o,i,l,null);else if(s(n))U(e,t,r,o,i,l,null);else{if(!_(n))throw new Error("Inferno Error: Bad childrenType value specified when attempting to patchChildren");b(e,t,r,o,i,l)}}function b(e,r,i,l,u,a){o(r)?wn(i,e):o(e)?t(r)?sn(i,e,r):o(r)||(n(r)?mountChildren(r,i,l,u,a):An(r,i,l,u,a)):n(r)?n(e)?(r.complex=e.complex,Tn(e,r)?K(e,r,i,l,u,a,null):U(e,r,i,l,u,a,null)):U([e],r,i,l,u,a,null):n(e)?U(e,[r],i,l,u,a,null):N(e,r,i,l,u,a)}function I(n,e,t,r,o,i){var l=n._dom,u=n._tr,a=e._tr;if(u!==a){var f=Dn(e,null,r,o,i);gn(t,f,l),en(n,null,r)}else e._dom=l,a.patch(n,e,r,o,i)}function M(n,e,t,o,i,l){var u=e._hooks,a=!r(u);a&&!r(u.onWillUpdate)&&u.onWillUpdate(n._dom);var f=e._tag,c=n._tag;if("svg"===f&&(l=!0),c!==f)hn(n,e,t,o,i,l);else{var s=n._dom,d=n._props,p=e._props,_=n._children,m=e._children;if(e._dom=s,_!==m){var v=n._childrenType,h=e._childrenType;v===h?O(v,_,m,s,o,i,l):b(_,m,s,o,i,l)}d!==p&&A(n,e,d,p,s),a&&!r(u.onDidUpdate)&&u.onDidUpdate(s),Mn(f,e)}}function A(n,e,t,o,i){var l=e._tag;t=t||{},o=o||{},"select"===n._tag&&On(e);for(var u in o){var a=o[u],c=t[u];if(c!==a)if(r(a))D(l,u,i);else if("style"===u)L(c,a,i);else if(dn(l,u))i[u]=a;else{var s=fe[u];s?i.setAttributeNS(s,u,a):i.setAttribute(u,a)}}for(var d in t)f(o[d])&&D(l,d,i)}function D(n,e,t){"className"===e?t.removeAttribute("class"):"id"===e?t.removeAttribute("id"):dn(n,e)?t[e]=null:t.removeAttribute(e)}function L(n,e,t){if(i(e))t.style.cssText=e;else if(r(n)){if(!r(e))for(var o=Object.keys(e),u=0;u<o.length;u++){var a=o[u],f=e[a];l(f)&&!ce[a]?t.style[a]=f+"px":t.style[a]=f}}else if(r(e))t.removeAttribute("style");else{for(var c=Object.keys(e),s=0;s<c.length;s++){var d=c[s],p=e[d];l(p)&&!ce[d]?t.style[d]=p+"px":t.style[d]=p}for(var _=Object.keys(n),m=0;m<_.length;m++){var v=_[m];r(e[v])&&(t.style[v]="")}}}function S(n,t,i,l,u,a){var f=n._component,c=t._component,s=t._props||{};if(f!==c)hn(n,t,i,l,u,a);else if(e(t)){var d=(n._dom,n._instance),p=d.props,_=d.state,m=d.state,v=d.getChildContext();t._instance=d,d.context=u,r(v)||(u=Object.assign({},u,v));var g=d._updateComponent(_,m,p,s);g===qn?g=d._lastInput:r(g)&&(g=h()),N(d._lastInput,g,i,l,u,null,!1),d._lastInput=g,d.componentDidUpdate(p,_),t._dom=g._dom,pe.set(d,g._dom)}else{var y=!0,E=n._props,x=t._hooks,k=!r(x);if(k&&!r(x.onComponentShouldUpdate)&&(y=x.onComponentShouldUpdate(n._dom,E,s)),y!==!1){k&&!r(x.onComponentWillUpdate)&&x.onComponentWillUpdate(n._dom,E,s);var w=c(s,u),C=n._instance;o(w)&&(w=h()),t._dom=n._dom,N(C,w,i,l,u,null,null,!1),t._instance=w,k&&!r(x.onComponentDidUpdate)&&x.onComponentDidUpdate(C._dom,E,s)}}}function W(n,e,t,r,o,i){var l=n._items,u=e._items,a=n._pointer;e._dom=n._dom,e._pointer=a,!l!==u&&(Tn(l,u)?K(l,u,t,r,o,i,e):U(l,u,t,r,o,i,e))}function U(n,e,t,r,o,i,l){for(var u=n.length,a=e.length,f=u>a?a:u,c=0;f>c;c++){var s=n[c],d=En(e,c);N(s,d,t,r,o,i)}if(a>u)for(c=f;a>c;c++){var p=En(e,c);_n(t,An(p,null,r,o,i),l&&l.pointer)}else if(u>a)for(c=f;u>c;c++)en(n[c],t)}function P(n,e){e._dom=n._dom}function R(n,e){var t=e._text,r=n._dom;e._dom=r,n.text!==t&&(r.nodeValue=t)}function K(n,e,t,r,o,i,l){for(var u,a=n.length,f=e.length,c=a-1,s=f-1,d=0,p=0,_=null,m=null,v=null,h=null;c>=d&&s>=p&&(m=e[p],_=n[d],m._key===_._key);)N(_,m,t,r,o,i,!1),p++,d++;for(;c>=d&&s>=p&&(v=e[s],h=n[c],v._key===h._key);)N(h,v,t,r,o,i,!1),s--,c--;for(;c>=d&&s>=p&&(v=e[s],_=n[d],v._key===_._key);)u=f>s+1?e[s+1]._dom:null,N(_,v,t,r,o,i,!1),_n(t,v._dom,u),s--,d++;for(;c>=d&&s>=p&&(m=e[p],h=n[c],m._key===h._key);)u=n[d]._dom,N(h,m,t,r,o,i,!1),_n(t,m._dom,u),p++,c--;if(d>c){if(s>=p)for(u=f>s+1?e[s+1]._dom:l&&l.pointer;s>=p;p++)_n(t,An(e[p],null,r,o,i),u)}else if(p>s)for(;c>=d;)en(n[d++],t);else{var g,y=c-d+1,E=s-p+1,x=new Array(E);for(g=0;E>g;g++)x[g]=-1;var k,w=!1,C=0,T=0;if(16>=y*E)for(g=d;c>=g;g++){var O=!0;for(h=n[g],k=p;s>=k;k++)if(v=e[k],h._key===v._key){x[k-p]=g,T>k?w=!0:T=k,N(h,v,t,r,o,i,!1),O=!1;break}O&&(en(h,t),C++)}else{var b=new Map;for(g=p;s>=g;g++)b.set(e[g]._key,g);for(g=c;g>=d;g--)h=n[g],k=b.get(h._key),void 0===k?(en(h,t),C++):(v=e[k],x[k-p]=g,T>k?w=!0:T=k,N(h,v,t,r,o,i,!1))}var I;if(w){var M=B(x);for(k=M.length-1,g=E-1;g>=0;g--)-1===x[g]?(I=g+p,u=f>I+1?e[I+1]._dom:l&&l.pointer,_n(t,An(e[I],null,r,o,i),u)):0>k||g!==M[k]?(I=g+p,u=f>I+1?e[I+1]._dom:l&&l.pointer,_n(t,e[I]._dom,u)):k--}else if(y-C!==E)for(g=E-1;g>=0;g--)-1===x[g]&&(I=g+p,u=f>I+1?e[I+1]._dom:l&&l.pointer,_n(t,An(e[I],null,r,o,i),u))}}function B(n){var e=n.slice(0),t=[];t.push(0);var r,o,i,l,u;for(r=0;r<n.length;r++)if(-1!==n[r])if(o=t[t.length-1],n[o]<n[r])e[r]=o,t.push(r);else{for(i=0,l=t.length-1;l>i;)u=(i+l)/2|0,n[t[u]]<n[r]?i=u+1:l=u;n[r]<n[t[i]]&&(i>0&&(e[r]=t[i-1]),t[i]=r)}for(i=t.length,l=t[i-1];i-- >0;)t[i]=l,l=e[l];return t}function V(n,e,t,r){var o=n._arg;return function(n,i,l,u,a,f){var c=n.read(o),s=i.read(o);c!==s&&(t?O(r,c,s,l,u,a,f||e):N(c,s,l,u,a,f||e))}}function j(n,e,t){var r=n.read(t);return e.write(t,r),r}function F(n){return function(e,t){return j(e,t,n)}}function G(e,r,i,l,a,f,c){if(!o(e)){var s,d,p,_=Qn,v=r?Zn:Qn,h=!1;if(E(e))s=Fn(e,a,f,c),d=V(e,a,f,c),p=un(e,f,c);else if(w(e)){var g=[],y=[],x=[],k=e._tag;"svg"===k&&(a=!0);var C=vn(k,a),N=e._key;!u(N)&&E(N)&&(_=N._arg);e._props,e._hooks;y.length>0&&v===Qn&&(v=i.length++);var O=e._children;if(!o(O))if(t(O));else if(n(O));else{var b=G(O,!1,i,C,a,!0,e._childrenType);if(!o(b)){g.push(b.mount);var I=b.patch,M=b.unmount;u(I)||y.push(I),u(M)||x.push(M)}}s=X(v,Gn(C,r,h),g),d=z(v,y),p=Q(v,x)}else if(T(e))throw new Error("Inferno Error: templates cannot contain VComponent nodes. Pass a VComponent node into a template as a variable instead.");return m(_,s,d,p)}}function X(n,e,t){return n===Qn&&0===t.length?e:t.length<=5?H(n,e,t[0],t[1],t[2],t[3]):Y(n,e,t)}function H(n,e,t,r,o,i){var l=n!==Qn;return function(u,a,f,c,s){var d=e(u,a,f,c,s);return l&&u.write(n,d),t&&(t(u,d,f,c,s),r&&(r(u,d,f,c,s),o&&(o(u,d,f,c,s),i&&i(u,d,f,c,s)))),d}}function Y(n,e,t){var r=n!==Qn;return function(o,i,l,u,a){var f=e(o,i,l,context);r&&o.write(n,f);for(var c=0;c<t.length;c++)t[c](o,f,l,context,a);return f}}function z(n,e){return 0===e.length?n!==Qn?F(n):null:e.length<=5?q(n,e[0],e[1],e[2],e[3],e[4]):J(n,e)}function q(n,e,t,r,o,i){var l=n!==Qn;return function(u,a,f,c,s){var d;l&&(d=j(u,a,n)),e&&(e(u,a,d,f,c,s),t&&(t(u,a,d,f,c,s),r&&(r(u,a,d,f,c,s),o&&(o(u,a,d,f,c,s),i&&i(u,a,d,f,c,s)))))}}function J(n,e){var t=n!==Qn;return function(r,o,i,l,u){var a;t&&(a=j(r,o,n));for(var f=0;f<e.length;f++)e[f](r,o,a,i,l,u)}}function Q(n,e){return e.length>0&&e.length<=5?Z(n,e[0],e[1],e[2],e[3],e[4]):null}function Z(n,e,t,r,o,i){return function(n){e&&(e(n),t&&(t(n),r&&(r(n),o&&(o(n),i&&i(n)))))}}function $(n,e,t,o){var i=n._tr,l=n._key,u=null===l?i._pools.nonKeyed:i._pools.keyed.get(l);if(!f(u)){var a=u.pop();if(!r(a))return I(a,n,null,e,t,o),n._dom}return null}function nn(n){var e=n._tr,t=n._key,r=e._pools;if(null===t){var o=r.nonKeyed;o&&o.push(n)}else{var i=r.keyed.get(t);f(i)&&(i=[],r.keyed.set(t,i)),i.push(n)}return!0}function en(n,e,t){C(n)?tn(n,e):k(n)?rn(n,e,!0):w(n)?ln(n,e):T(n)&&on(n,e)}function tn(n,e){var t=n._dom,r=n._tr;r.unmount(n),u(e)||xn(e,t),oe&&nn(n)}function rn(n,e,t){var r=n._items,o=r.length,i=r._pointer;if(o>0)for(var l=0;o>l;l++){var u=r[l];k(u)?rn(u,e,!0):(e&&xn(e,u._dom),en(u,null))}e&&t&&xn(e,i)}function on(n,e){var t=n._instance,o=null,i=null;r(t)||(o=t._hooks,i=t._children,void 0!==t.render&&(t.componentWillUnmount(),t._unmounted=!0,pe.delete(t),en(t._lastInput,null)));var l=n._hooks||o;r(l)||r(l.onComponentWillUnmount)||l.onComponentWillUnmount(n._dom,l)}function ln(e,t){var o=e._hooks,i=e._dom;r(o)||r(o.onWillDetach)||o.onWillDetach(e._dom);var l=e._children;if(!r(l))if(n(l))for(var u=0;u<l.length;u++)en(l[u],null);else en(l,null);t&&xn(t,i)}function un(n,e){return function(n){}}function an(n,e,t){n.split(",").forEach(function(n){return e[n]=t})}function fn(n){var e=document.createElement(n),t={};for(var r in e)t[r]=!0;return se.set(n,t),t}function cn(n,e){""!==e?n.textContent=e:n.appendChild(document.createTextNode(""))}function sn(n,e,r){t(e)?n.firstChild.nodeValue=r:n.textContent=r}function dn(n,e){var t=se.get(n);return f(t)&&(t=fn(n)),t[e]}function pn(n,e){n.appendChild(e)}function _n(n,e,t){r(t)?pn(n,e):n.insertBefore(e,t)}function mn(n,e,t){var r=e._pointer;rn(e,n,!1),gn(n,t,r)}function vn(n,e){var t;return t=e===!0?document.createElementNS("http://www.w3.org/2000/svg",n):document.createElement(n)}function hn(n,e,t,o,i,l){var u=null,a=n._lastInput;r(a)||(u=n,n=a),en(n,!1);var f=An(e,null,o,i,l);e._dom=f,gn(t,f,n._dom),null!==u&&(u._lasInput=e)}function gn(n,e,t){n.replaceChild(e,t)}function yn(e){return t(e)?v(e):o(e)?h():n(e)?g(e):e}function En(n,e){var t=n[e];return n[e]=yn(t)}function xn(n,e){n.removeChild(e)}function kn(){return document.activeElement}function wn(n,e){if(recyclingEnabled){var t=e.length;if(t>5)for(var r=0;t>r;r++){var i=e[r];o(i)||pool(i)}}n.textContent=""}function Cn(n){null!==n&&n!==document.body&&document.activeElement!==n&&n.focus()}function Tn(n,e){return n.complex?!1:e.length&&!r(e[0])&&!r(e[0]._key)&&n.length&&!r(n[0])&&!r(n[0]._key)}function Nn(n,e){if("option"===n._tag){var t=n._props&&n._props.value;e[t]?(n._props=n._props||{},n._props.selected=!0,n._dom.selected=!0):n._dom.selected=!1}else for(var r=0,o=n._children.length;o>r;r++)Nn(n._children[r],e)}function On(e){var t=e._props&&e._props.value,r={};if(n(t))for(var o=0,i=t.length;i>o;o++)r[t[o]]=t[o];else r[t]=t;for(var l=0,u=e._children.length;u>l;l++)Nn(e._children[l],r);e._props&&e._props[t]&&delete e._props.value}function bn(n,e,t){r(n.onCreated)||n.onCreated(t),r(n.onAttached)||e.addListener(function(){n.onAttached(t)})}function In(n){var e=n.attrs.value;r(e)||(n._dom.value=e)}function Mn(n,e){if("input"===n){var t=e.attrs.type;if("text"===t)In(e);else if("checkbox"===t||"radio"===t){var r=e.attrs.checked;e._dom.checked=!!r}}else"textarea"===n&&In(e)}function An(n,e,t,r,o){if(C(n))return Dn(n,e,t,r,o);if(x(n))return Un(n,e);if(y(n))return Wn(n,e);if(k(n))return Sn(n,e,t,r,o);if(w(n))return Ln(n,e,t,r,o);if(T(n))return Vn(n,e,t,r,o);throw Error("Inferno Error: Bad input argument called on mount(). Input argument may need normalising.")}function Dn(n,e,t,r,o){var i=n._tr,l=null;return oe&&(l=$(n,t,r,o)),u(l)&&(l=i.mount(n,null,t,r,o)),n._dom=l,u(e)||pn(e,l),l}function Ln(n,e,t,o,l){var a=n._tag;if(!i(a))throw new Error("Inferno Error: expects VElement to have a string as the tag name");"svg"===a&&(l=!0);var f=vn(a,l),c=n._children,s=n._props,d=n._hooks;return n._dom=f,r(d)||bn(d,t,f),r(c)||Bn(n._childrenType,c,f,t,o,l),r(s)||(Pn(n),jn(n,s,f)),u(e)||pn(e,f),f}function Sn(n,e,t,r,o){var i=n._items,l=document.createTextNode(""),u=document.createDocumentFragment();return mountArrayChildren(i,u,t,r,o),n._pointer=l,n._dom=u,pn(u,l),e&&pn(e,u),u}function Wn(n,e){var t=document.createTextNode(n._text);return n._dom=t,e&&pn(e,t),t}function Un(n,e){var t=document.createTextNode("");return n._dom=t,e&&pn(e,t),t}function Pn(n){"select"===n.tag&&On(n)}function Rn(n,e,t,r,o){n.complex=!1;for(var i=0;i<n.length;i++){var l=En(n,i);y(l)?(Wn(l,e),n.complex=!0):x(l)?(Un(l,e),n.complex=!0):k(l)?(Sn(l,e,t,r,o),n.complex=!0):An(l,e,t,r,o)}}function Kn(e,r,i,l,u){n(e)?Rn(e,r,i,l,u):t(e)?cn(r,e):o(e)||An(e,r,i,l,u)}function Bn(n,e,t,r,o,i){if(d(n))cn(t,e);else if(p(n))An(e,t,r,o,i);else if(c(n)||s(n))for(var l=0;l<e.length;l++)An(e[l],t,r,o,i);else{if(!_(n))throw new Error("Inferno Error: Bad childrenType value specified when attempting to mountChildren");Kn(e,t,r,o,i)}}function Vn(n,t,i,l,u){var a,f=n._component,c=n._props,s=n._hooks;if(e(n)){var d=new f(c,l);d._patch=N,d._componentToDOMNodeMap=pe;var p=d.getChildContext();r(p)||(l=Object.assign({},l,p)),d._unmounted=!1,d._pendingSetState=!0,d.componentWillMount();var _=d.render();o(_)&&(_=h()),d._pendingSetState=!1,a=An(_,null,i,l,!1),d._lastInput=_,d.componentDidMount(),null===t||o(a)||pn(t,a),pe.set(d,a),n._dom=a,n._instance=d}else{r(s)||(r(s.onComponentWillMount)||s.onComponentWillMount(null,c),r(s.onComponentDidMount)||i.addListener(function(){s.onComponentDidMount(a,c)}));var m=f(c,l);o(m)&&(node=h()),a=An(m,null,i,l,null,!1),n._instance=m,null===t||o(a)||pn(t,a),n._dom=a}return a}function jn(n,e,t){for(var o in e){var i=e[o];if(!r(i))if("style"===o)L(null,i,t);else if(dn(n._tag,o))t[o]=i;else{var l=fe[o];l?t.setAttributeNS(l,o,i):t.setAttribute(o,i)}}}function Fn(n,e,t,r){var o=n._arg;return function(n,i,l,u,a){var f=n.read(o);return t?Bn(r,f,i,l,u,a||e):An(f,i,l,u,a||e)}}function Gn(n,e,t){return function(e,r,o,i){var l=n.cloneNode(t);return u(r)||pn(r,l),l}}function Xn(n,e,t){}function Hn(n){return pe.get(n)||null}function Yn(n,e){var t=de.get(e),r=new zn;if(f(t))o(n)||(Xn(n,e,r)||An(n,e,r,{},!1),r.trigger(),de.set(e,{input:n}));else{var i=kn();u(n)?(en(t.input,e),de.delete(e)):N(t.input,n,e,r,{},!1),r.trigger(),t.input=n,Cn(i)}}var zn=function(){this._listeners=[]};zn.prototype.addListener=function(n){this._listeners.push(n)},zn.prototype.trigger=function(){for(var n=this,e=0;e<this._listeners.length;e++)n._listeners[e]()};var qn="NO_OP",Jn={KEYED_LIST:0,NON_KEYED_LIST:1,TEXT:2,NODE:3,UNKNOWN:4},Qn=-1,Zn=-2,$n={ELEMENT:0,COMPONENT:1,TEMPLATE:2,TEXT:3,PLACEHOLDER:4,FRAGMENT:5,VARIABLE:6},ne=function(n){this._type=$n.TEXT,this._text=n,this._dom=null},ee=function(){this._type=$n.PLACEHOLDER,this._dom=null},te=function(n){this._type=$n.FRAGMENT,this._dom=null,this._pointer=null,this._items=n},re=function(n,e,t,r){this._keyIndex=n,this._schema=null,this._pools={nonKeyed:[],keyed:new Map},this.mount=e,this.patch=t,this.unmount=r},oe=!0,ie="http://www.w3.org/1999/xlink",le="http://www.w3.org/XML/1998/namespace",ue={},ae={},fe={},ce={};an("xlink:href,xlink:arcrole,xlink:actuate,xlink:role,xlink:titlef,xlink:type",fe,ie),an("xml:base,xml:lang,xml:space",fe,le),an("volume,value",ue,!0),an("muted,scoped,loop,open,checked,default,capture,disabled,selected,readonly,multiple,required,autoplay,controls,seamless,reversed,allowfullscreen,novalidate",ae,!0),an("animationIterationCount,borderImageOutset,borderImageSlice,borderImageWidth,boxFlex,boxFlexGroup,boxOrdinalGroup,columnCount,flex,flexGrow,flexPositive,flexShrink,flexNegative,flexOrder,gridRow,gridColumn,fontWeight,lineClamp,lineHeight,opacity,order,orphans,tabSize,widows,zIndex,zoom,fillOpacity,floodOpacity,stopOpacity,strokeDasharray,strokeDashoffset,strokeMiterlimit,strokeOpacity,strokeWidth,",ce,!0);var se=new Map,de=new Map,pe=new Map,_e={render:Yn,findDOMNode:Hn,mount:An,patch:N,unmount:en,createTemplateReducers:G};return _e});