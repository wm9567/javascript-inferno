!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):e.InfernoDOM=n()}(this,function(){"use strict";function e(){this._listeners=[]}function n(e,n){if(!o(e)){var l=t(e);(l&&e.length>0||!l)&&(n?n.children=e:n={children:e})}return n}function t(e){return e instanceof Array}function l(e){return void 0!==e.prototype.render}function r(e){return"string"==typeof e||"number"==typeof e}function o(e){return void 0===e||null===e}function i(e){return void 0===e||null===e||e===!1}function a(e){return"function"==typeof e}function d(e){return"string"==typeof e}function s(e){return e instanceof Promise}function f(e,n,t){e.splice(e.indexOf(n),1,t)}function u(e){return!o(e.append)}function c(e,n,t){o(t)?u(n)?n.append(e):e.appendChild(n):u(n)?n.insert(e,t):u(t)?e.insertBefore(n,t.childNodes[0]):e.insertBefore(n,t)}function h(e,n,t){o(t)?e.appendChild(n):e.insertBefore(n,t)}function v(e,n){return o(n)?document.createElement(e):document.createElementNS(n,e)}function p(e,n,t){if(!n)return document.createTextNode(e);if(!t){var l=document.createTextNode(e);return n.appendChild(l),l}if(""===e){var r=document.createTextNode("");return n.appendChild(r),r}n.textContent=e}function m(e,n,t,l,r,i,a){var d=null,s=e._lastNode;o(s)||(d=e,e=s);var f=Q(n,null,l,r,i,a);n.dom=f,t.replaceChild(f,e.dom),null!==d&&(d._lastNode=n),g(e)}function g(e){if(!i(e)&&!r(e)){var n=e.instance,l=null,a=null;o(n)||(l=n.hooks,a=n.children,void 0!==n.render&&(n.componentWillUnmount(),n._unmounted=!0));var d=e.hooks||l;o(d)||(o(d.willDetach)||d.willDetach(e.dom),o(d.componentWillUnmount)||d.componentWillUnmount(e.dom,d));var s=e.children||a;if(!o(s))if(t(s))for(var f=0;f<s.length;f++)g(s[f]);else g(s)}}function y(){return document.createTextNode("")}function C(e,n){var t=e.dom;t===n?t.innerHTML="":(n.removeChild(t),pe&&J(e)),g(e)}function k(e,n){for(var t in e)n[t]=null}function b(e,n,t){for(var l=0;l<n.length;l++)e.insertBefore(n[l],t)}function N(){return document.activeElement}function x(e,n){if(pe){var t=n.length;if(t>5)for(var l=0;t>l;l++){var r=n[l];i(r)||J(r)}}e.textContent=""}function w(e){e!==document.body&&document.activeElement!==e&&e.focus()}function U(){var e=[],n=document.createTextNode(""),t=null,l={childNodes:e,appendChild:function(l){e.push(l),t&&t.insertBefore(l,n)},removeChild:function(n){t&&t.removeChild(n),e.splice(e.indexOf(n),1)},insertBefore:function(n,l){t&&t.insertBefore(n,l),e.splice(e.indexOf(l),0,n)},replaceChild:function(n,l){t.replaceChild(n,l),f(e,l,n)},append:function(l){l.appendChild(n),t=l,b(t,e,n)},insert:function(l,r){l.insertBefore(n,r),t=l,b(t,e,n)},remove:function(){t.removeChild(n);for(var l=0;l<e.length;l++)t.removeChild(e[l]);t=null},getElementsByTagName:null};return Object.defineProperty(l,"parentNode",{get:function(){return t}}),Object.defineProperty(l,"firstChild",{get:function(){return e[0]}}),l}function O(e,n){return n.length&&!o(n[0])&&void 0!==n[0].key||e.length&&!o(e[0])&&void 0!==e[0].key}function T(e,n){if("option"===e.tag){var t=e.attrs&&e.attrs.value;n[t]&&(e.attrs=e.attrs||{},e.attrs.selected="selected")}else for(var l=0,r=e.children.length;r>l;l++)T(e.children[l],n)}function _(e){if("select"===e.tag){var n=e.attrs&&e.attrs.value;if(!o(n)){var l={};if(t(n))for(var r=0,i=n.length;i>r;r++)l[n[r]]=n[r];else l[n]=n;T(e,l),e.attrs&&e.attrs[n]&&delete e.attrs.value}}}function S(e,n){var t=y();return null!==n&&n.appendChild(t),i(e)||(e.dom=t),t}function j(e,n,t){o(e.created)||e.created(t),o(e.attached)||n.addListener(function(){e.attached(t)})}function M(e,n,l,a,d,s,f,u){var c=n.children,h=e.children;if(h!==c){var v=null;e.domChildren&&(v=n.domChildren=e.domChildren),i(h)?r(c)?L(l,h,c):o(c)||(t(c)?ee(n,c,l,a,d,s,f):Q(c,l,a,d,s,f)):i(c)?x(l,h):t(h)?t(c)?null===v&&h.length>1?z(h,c,l,a,d,s,f):O(h,c)?z(h,c,l,a,d,s,f):q(h,c,l,v||(n.domChildren=[]),a,d,s,f,0):q(h,[c],l,v||[],a,d,s,f,0):t(c)?q([h],c,l,v||(n.domChildren=[l.firstChild]),a,d,s,f,0):r(c)?L(l,h,c):r(h)?H(h,c,l,a,d,s,f,null):H(h,c,l,a,d,s,f,u)}}function A(e,n,t,l){e&&(d(n)&&delete e.refs[n],d(t)&&(e.refs[t]=l))}function B(e,n,t){var l=n.events,r=e.events,i=!o(l),a=!o(r);i?a?I(r,l,t):le(l,t):a&&k(r,t)}function E(e,n,t,l){"select"===e.tag&&_(n);var r=n.attrs,i=e.attrs,a=o(r),d=o(i);if(!a)for(var s=Object.keys(r),f=s.length,u=0;f>u;u++){var c=s[u],h=!d&&i[c],v=r[c];h!==v&&("ref"===c?A(l,h,v,t):K(c,v,t))}if(!d)for(var p=Object.keys(i),m=p.length,g=0;m>g;g++){var y=p[g];(a||o(r[y]))&&("ref"===y?A(l,i[y],null,t):t.removeAttribute(y))}}function D(e,n,t,r,a,d,s,f,u,c){var h=void 0;n.hasHooks===!0&&(h=n.hooks&&!o(h.willUpdate))&&h.willUpdate(e.dom);var v=n.tag||c&&t.tag,p=e.tag||c&&r.tag;if(p!==v)if(e.tpl.isComponent===!0){var g=e.instance;r.isComponent===!0?m(g||e,n,a,d,s,f,u):l(p)?W(g._lastNode,n,a,d,s,f,u,!0):W(g,n,a,d,s,f,u,!0)}else m(e,n,a,d,s,f,u);else if(o(p))n.dom=e.dom;else if(t.isComponent===!0)r.isComponent===!0&&(n.instance=e.instance,n.dom=e.dom,X(!0,n,n.tag,t,r,n.instance,e.attrs||{},n.attrs||{},n.hooks,n.children,a,s,f));else{var y=e.dom,C=t.childrenType;if(n.dom=y,C>0){var k=r.childrenType,b=e.children,N=n.children;b!==N&&(4===C?4===k&&z(b,N,y,d,s,f,u):2===C?2===k&&(i(N)?x(y,b):i(b)?Q(N,y,d,s,f,u):H(b,N,y,d,s,f,u,c)):1===C?1===k&&L(y,b,N):M(e,n,y,d,s,f,u,c))}if(t.hasAttrs===!0&&E(e,n,y,u),t.hasEvents===!0&&B(e,n,y),t.hasClassName===!0){var w=n.className;e.className!==w&&(o(w)?y.removeAttribute("class"):y.className=w)}if(t.hasStyle===!0){var U=n.style;e.style!==U&&P(e.style,U,y)}n.hasHooks!==!0||o(h.didUpdate)||h.didUpdate(y)}}function W(e,n,t,r,i,d,f,u){if(s(n))n.then(function(n){W(e,n,t,r,i,d,u,f)});else{var c=n.hooks,h=!o(c);h&&!o(c.willUpdate)&&c.willUpdate(e.dom);var v=n.tag||(u&&!o(n.tpl)?n.tpl.tag:null),p=e.tag||(u&&!o(e.tpl)?e.tpl.tag:null);if(r=r||"svg"===v?ue:"math"===v?fe:null,p!==v){var g=e.instance;a(p)?a(v)?m(g||e,n,t,r,i,d,f):l(p)?W(g._lastNode,n,t,r,i,d,f,!0):W(g,n,t,r,i,d,f,!0):m(g||e,n,t,r,i,d,f)}else if(o(p))n.dom=e.dom;else if(a(p))a(v)&&(n.instance=e.instance,n.dom=e.dom,X(!1,n,n.tag,null,null,n.instance,e.attrs||{},n.attrs||{},n.hooks,n.children,t,i,d));else{var y=e.dom,C=n.className,k=n.style;n.dom=y,M(e,n,y,r,i,d,f,u),E(e,n,y,f),B(e,n,y),e.className!==C&&(o(C)?y.removeAttribute("class"):y.className=C),e.style!==k&&P(e.style,k,y),h&&!o(c.didUpdate)&&c.didUpdate(y)}}}function V(e){switch(e.length){case 5:return"value"===e;case 7:return"checked"===e;case 8:return"disabled"===e||"selected"===e;default:return!1}}function L(e,n,t){r(n)?e.firstChild.nodeValue=t:e.textContent=t}function H(e,n,t,l,o,a,d,s){if(null!==s){var f=e.tpl,u=n.tpl;void 0===f?W(e,n,t,l,o,a,d,!0):D(e,n,f,u,t,l,o,a,d,!0)}else if(i(e))Q(n,t,l,o,a,d);else if(i(n))C(e,t);else if(r(e))if(r(n))t.firstChild.nodeValue=n;else{var c=Q(n,null,l,o,a,d);n.dom=c,t.replaceChild(c,t.firstChild)}else if(r(n)){var h=document.createTextNode(n);t.replaceChild(h,e.dom)}else{var v=e.tpl,p=n.tpl,m=v!==p;void 0===v?W(e,n,t,l,o,a,d,m):D(e,n,v,p,t,l,o,a,d,m)}}function P(e,n,t){if(d(n))t.style.cssText=n;else if(o(e)){if(!o(n))for(var l=Object.keys(n),r=0;r<l.length;r++){var i=l[r],a=n[i];t.style[i]=a}}else if(o(n))t.removeAttribute("style");else{for(var s=Object.keys(n),f=0;f<s.length;f++){var u=s[f],c=n[u];t.style[u]=c}for(var h=Object.keys(e),v=0;v<h.length;v++){var p=h[v];o(n[p])&&(t.style[p]="")}}}function I(e,n,t){for(var l=Object.keys(n),r=0;r<l.length;r++){var i=l[r],a=e[i],d=n[i];a!==d&&(t[i]=d)}for(var s=Object.keys(e),f=0;f<s.length;f++){var u=s[f];o(n[u])&&(t[u]=null)}}function K(e,n,t){if(V(e))t[e]=n;else if(n===!1||o(n))t.removeAttribute(e);else{var l=ve[e];l?t.setAttributeNS(l,e,n===!0?e:n):t.setAttribute(e,n===!0?e:n)}}function X(e,t,r,i,a,d,s,f,u,c,h,v,p){if(f=n(c,f),l(r)){var m=d.props,g=d.state,y=d.state,C=d.getChildContext();o(C)||(p=se.extends({},p,C)),d.context=p;var k=d._updateComponent(g,y,m,f);o(k)||(H(t,k,h,null,v,p,d,!0),t.dom=k.dom,d._lastNode=k)}else{var b=!0,N=e&&a.hasHooks===!0||!o(u);if(N&&!o(u.componentShouldUpdate)&&(b=u.componentShouldUpdate(t.dom,s,f)),b!==!1){N&&!o(u.componentWillUpdate)&&u.componentWillUpdate(t.dom,s,f);var x=r(f),w=t.dom;x.dom=w,H(d,x,w,null,v,p,null,!0),t.instance=x,N&&!o(u.componentDidUpdate)&&u.componentDidUpdate(t.dom,s,f)}}}function q(e,n,l,a,d,s,f,u,h){var v=void 0===l.append,p=e.length,m=n.length,C=p===m;if(C===!1)if(p>m)for(;p!==m;){var k=e[p-1];i(k)||(l.removeChild(a[p-1+h]),g(k)),p--}else for(;p!==m;){var b=n[p],N=void 0;N=r(b)?document.createTextNode(b):Q(b,null,d,s,f,u),c(l,N),v&&(1===p&&a.push(l.firstChild),v&&a.splice(p+h,0,N)),p++}for(var x=0;m>x;x++){var w=e[x],T=n[x],_=x+h;if(w!==T)if(i(T)){if(!i(w)){var S=a[_];if(!o(S))if(r(w))S.nodeValue="";else if(C===!0){var j=y();t(w)&&0===w.length?(c(l,j),v&&a.splice(_,0,j)):(l.replaceChild(j,a[_]),v&&a.splice(_,1,j),g(w))}}}else if(i(w)){if(r(T)){var M=document.createTextNode(T);l.replaceChild(M,a[_]),v&&a.splice(_,1,M)}else if(C===!0){var A=Q(T,null,d,s,f,u);l.replaceChild(A,a[_]),v&&a.splice(_,1,A)}}else if(r(T))if(1===p)r(w)?void 0!==l.getElementsByTagName?l.firstChild.nodeValue=T:l.nodeValue=T:(g(w),l.textContent=T);else{var B=document.createTextNode(T),E=a[_];o(E)?l.nodeValue=B.nodeValue:void 0===E.append?(v&&a.splice(_,1,B),l.replaceChild(B,E)):(l.insertBefore(B,E.firstChild),E.remove(),a.splice(0,a.length,B)),g(w)}else if(t(T))if(O(w,T))z(w,T,a[_],d,s,f,u);else if(t(w)){var D=a[_];if(void 0===D.append)if(T.length>1&&1===w.length){var W=U();W.insert(l,D),W.appendChild(D),v&&a.splice(_,1,W),q(w,T,W,W.childNodes,d,s,f,u,0)}else q(w,T,l,a,d,s,f,u,0);else q(w,T,a[_],a[_].childNodes,d,s,f,u,0)}else if(T.length>1){var V=U();V.appendChild(l.firstChild),c(l,V,l.firstChild),v&&a.splice(_,1,V),q([w],T,V,V.childNodes,d,s,f,u,x)}else q([w],T,l,a,d,s,f,u,x);else t(w)?q(w,[T],a,a[_].childNodes,d,s,f,u,0):H(w,T,l,d,s,f,u,null)}}function z(e,n,t,l,r,o,i){var a=0,d=0,s=e.length,f=n.length,u=s-1,c=f-1,v=s>0?e[a]:null,p=f>0?n[d]:null,m=e[u],g=n[c],y=void 0,k=void 0,b=!1,N=void 0,x=0,w=void 0,U=void 0;e:for(;!b&&u>=a&&c>=d;){for(b=!0;v.key===p.key;){if(H(v,p,t,l,r,o,i,!0),a++,d++,a>u||d>c)break e;v=e[a],p=n[d],b=!1}for(;g.key===m.key;){if(H(m,g,t,l,r,o,i,!0),u--,c--,a>u||d>c)break e;g=n[c],m=e[u],b=!1}for(;v.key===g.key;){if(H(v,g,t,l,r,o,i,!0),N=f>c+1?n[c+1].dom:null,h(t,g.dom,N),a++,c--,a>u||d>c)break e;g=n[c],v=e[a],b=!1}for(;p.key===m.key;){if(N=e[a].dom,H(m,p,t,l,r,o,i,!0),h(t,p.dom,N),d++,u--,a>u||d>c)break e;p=n[d],m=e[u],b=!1}}if(a>u){if(c>=d)for(N=f>c+1?n[c+1].dom:null;c>=d;d++)h(t,Q(n[d],null,l,r,o,i),N)}else if(d>c)for(;u>=a;a++)C(e[a],t);else{var O=u-a+1,T=c-d+1,_=new Array(T);for(y=0;T>y;y++)_[y]=-1;var S=!1,j=0;if(16>=O*T)for(y=a;u>=y;y++){var M=!0;for(m=e[y],k=d;c>=k;k++)if(g=n[k],m.key===g.key){_[k-d]=y,x>k?S=!0:x=k,H(m,g,t,l,r,o,i,!0),M=!1;break}M&&(C(m,t),j++)}else{var A={};for(y=d;c>=y;y++)U=n[y],A[U.key]=y;for(y=u;y>=a;y--)m=e[y],k=A[m.key],void 0!==k?(g=n[k],_[k-d]=y,x>k?S=!0:x=k,H(m,g,t,l,r,o,i,!0)):(C(m,t),j++)}if(S){var B=F(_);for(k=B.length-1,y=T-1;y>=0;y--)-1===_[y]?(w=y+d,N=f>w+1?n[w+1].dom:null,h(t,Q(n[w],null,l,r,o,i),N)):0>k||y!==B[k]?(w=y+d,N=f>w+1?n[w+1].dom:null,h(t,n[w].dom,N)):k--}else if(O-j!==T)for(y=T-1;y>=0;y--)-1===_[y]&&(w=y+d,N=f>w+1?n[w+1].dom:null,h(t,Q(n[w],null,l,r,o,i),N))}}function F(e){var n=e.slice(0),t=[];t.push(0);var l=void 0,r=void 0,o=void 0,i=void 0,a=void 0;for(l=0;l<e.length;l++)if(-1!==e[l])if(r=t[t.length-1],e[r]<e[l])n[l]=r,t.push(l);else{for(o=0,i=t.length-1;i>o;)a=(o+i)/2|0,e[t[a]]<e[l]?o=a+1:i=a;e[l]<e[t[o]]&&(o>0&&(n[l]=t[o-1]),t[o]=l)}for(o=t.length,i=t[o-1];o-- >0;)t[o]=i,i=n[i];return t}function G(e,n,t,l,r){if(void 0!==n){var i=e.key,a=null===i?n.pools.nonKeyed:n.pools.keyed[i];if(!o(a)){var d=a.pop();if(!o(d))return H(d,e,null,null,t,l,r,!0),e.dom}}return null}function J(e){var n=e.tpl;if(!o(n)){var t=e.key,l=n.pools;if(null===t){var r=l.nonKeyed;r&&r.push(e)}else{var i=l.keyed;(i[t]||(i[t]=[])).push(e)}return!0}return!1}function Q(e,n,l,r,o,a){if(i(e)||t(e))return S(e,n);var d=e.tpl;if(pe){var s=G(e,d,r,o,a);if(null!==s)return null!==n&&n.appendChild(s),s}return void 0===d?Y(e,n,l,r,o,a):R(e,d,n,l,r,o,a)}function R(e,n,t,l,r,o,i){var a=e.tag;if(n.isComponent===!0)return re(e,a,e.attrs||{},e.hooks,e.children,t,r,o);var d=n.dom.cloneNode(!1);switch(e.dom=d,n.hasHooks===!0&&j(e.hooks,r,d),n.childrenType){case 1:p(e.children,d,!0);break;case 2:Q(e.children,d,l,r,o,i);break;case 3:ee(e,e.children,d,l,r,o,i);break;case 4:$(e.children,d,l,r,o,i);break;case 5:ne(e,e.children,d,l,r,o,i)}return n.hasAttrs===!0&&oe(e,e.attrs,d,i),n.hasClassName===!0&&(d.className=e.className),n.hasStyle===!0&&P(null,e.style,d),n.hasEvents===!0&&le(e.events,d),null!==t&&t.appendChild(d),d}function Y(e,n,t,l,r,s){var f=e.tag;if(null===f)return S(e,n);if(a(f))return re(e,f,e.attrs||{},e.hooks,e.children,n,l,r);if(t=t||"svg"===f?ue:"math"===f?fe:null,!d(f)||""===f)throw Error("Inferno Error: Expected function or string for element tag type");var u=v(f,t),c=e.children,h=e.attrs,p=e.events,m=e.hooks,g=e.className,y=e.style;return e.dom=u,o(m)||j(m,l,u),i(c)||ne(e,c,u,t,l,r,s),o(h)||oe(e,h,u,s),o(g)||(u.className=g),o(y)||P(null,y,u),o(p)||le(p,u),null!==n&&n.appendChild(u),u}function Z(e,n,t,l,r,o,i){var a=y();t&&t.push(a),e.then(function(e){var d=Q(e,null,l,r,o,i);n.replaceChild(d,a),t&&f(t,a,d)}),n.appendChild(a)}function $(e,n,t,l,r,o){for(var i=0;i<e.length;i++)Q(e[i],n,t,l,r,o)}function ee(e,n,l,a,d,f,u){for(var h=null,v=!1,m=!1,g=0;g<n.length;g++){var y=n[g];if(r(y))v=!0,h=h||[],h.push(p(y,l,!1));else if(!o(y)&&t(y)){var C=U();v=!0,ee(e,y,C,a,d,f,u),c(l,C),h=h||[],h.push(C)}else if(s(y))Z(y,l,h,a,d,f,u);else{var k=Q(y,l,a,d,f,u);v||!m&&y&&o(y.key)?(v=!0,h=h||[],h.push(k)):i(y)?(v=!0,h=h||[],h.push(k)):m===!1&&(m=!0)}}null!==h&&h.length>1&&v===!0&&(e.domChildren=h)}function ne(e,n,l,o,i,a,d){t(n)?ee(e,n,l,o,i,a,d):r(n)?p(n,l,!0):s(n)?Z(n,l,null,o,i,a,d):Q(n,l,o,i,a,d)}function te(e,n,t){!i(e)&&d(n)&&(e.refs[n]=t)}function le(e,n){for(var t=Object.keys(e),l=0;l<t.length;l++){var r=t[l];n[r]=e[r]}}function re(e,t,r,i,a,d,s,f){r=n(a,r);var u=void 0;if(l(t)){var c=new t(r);c._diffNodes=W;var h=c.getChildContext();o(h)||(f=se.extends({},f,h)),c.context=f,c._pendingSetState=!0,c.componentWillMount();var v=c.shouldComponentUpdate();if(v){c.componentWillUpdate();var p=c._pendingState,m=c.state;c.state=se.extends({},m,p)}var g=c.render();c._pendingSetState=!1,o(g)||(u=Q(g,null,null,s,f,c),c._lastNode=g,null!==d&&d.appendChild(u),c.componentDidMount(),c.componentDidUpdate()),e.dom=u,e.instance=c}else{o(i)||(o(i.componentWillMount)||i.componentWillMount(null,r),o(i.componentDidMount)||s.addListener(function(){i.componentDidMount(u,r)}));var y=t(r);u=Q(y,null,null,s,f,null),e.instance=y,null!==d&&d.appendChild(u),e.dom=u}return u}function oe(e,n,t,l){"select"===e.tag&&_(e);for(var r=Object.keys(n),o=0;o<r.length;o++){var i=r[o];"ref"===i?te(l,n[i],t):K(i,n[i],t)}}function ie(e){for(var n=0;n<me.length;n++){var t=me[n];if(t.dom===e)return t}return null}function ae(e){for(var n=0;n<me.length;n++){var t=me[n];if(t===e)return void me.splice(n,1)}}function de(n,t){var l=ie(t),r=new e;if(null===l)Q(n,t,null,r,{},null),r.trigger(),me.push({node:n,dom:t});else{var o=N();H(l.node,n,t,null,r,{},null,null),r.trigger(),null===n&&ae(l),l.node=n,w(o)}}var se={};se.typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},se.extends=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var l in t)Object.prototype.hasOwnProperty.call(t,l)&&(e[l]=t[l])}return e},e.prototype={addListener:function(e){this._listeners.push(e)},trigger:function(){for(var e=0;e<this._listeners.length;e++)this._listeners[e]()}};var fe="http://www.w3.org/1998/Math/MathML",ue="http://www.w3.org/2000/svg",ce="http://www.w3.org/1999/xlink",he="http://www.w3.org/XML/1998/namespace",ve={"xlink:href":ce,"xlink:arcrole":ce,"xlink:actuate":ce,"xlink:role":ce,"xlink:row":ce,"xlink:titlef":ce,"xlink:type":ce,"xml:base":he,"xml:lang":he,"xml:space":he},pe=!0,me=[],ge={render:de};return ge});