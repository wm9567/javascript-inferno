!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.InfernoDOM=t()}(this,function(){"use strict";function e(e,n){return r(e)||(t(e)&&e.length>0||!t(e))&&(n?n.children=e:n={children:e}),n}function t(e){return e.constructor===Array}function n(e){return e&&e.prototype&&e.prototype.render}function o(e){return"string"==typeof e||"number"==typeof e}function r(e){return void 0===e||null===e}function i(e){return"function"==typeof e}function l(e){return"o"===e[0]&&"n"===e[1]&&e.length>3}function a(e){return"string"==typeof e}function d(e,t,n){n?e.insertBefore(t,n):e.appendChild(t)}function u(e,t){return t?document.createElementNS(t,e):document.createElement(e)}function c(e,t,n){if(n)""!==e?t.textContent=e:t.appendChild(document.createTextNode(""));else{var o=document.createTextNode(e);t.appendChild(o)}}function f(e,t,n,o,r,i){var l=j(t,null,o,r,i);n.replaceChild(l,e.dom),t.dom=l}function s(e){n(e.instance)&&(e.instance.componentWillUnmount(),e.instance._unmounted=!0),e.events&&e.events.willDetach&&e.events.willDetach(e.dom),e.events&&e.events.componentWillUnmount&&e.events.componentWillUnmount(e.dom,e.events);var o=e.children;if(o)if(t(o))for(var r=0;r<o.length;r++)s(o[r]);else s(o)}function v(e,t){var n=e.dom;s(e),n===t?n.innerHTML="":(t.removeChild(n),T&&w(e))}function p(e,t,n,o,i,l){return r(e)?void j(t,n,o,i):r(t)?void v(e,n):void k(e,t,n,o,i,l,null!==e.static&&null!==t.static)}function m(e,t,n,o){if(t!==n)if("style"===e)if(a(n))o.style.cssText=n;else for(var i=Object.keys(n),d=0;d<i.length;d++){var u=i[d];o.style[u]=n[u]}else if(!l(e)){var c=null;":"===e[5]&&-1!==e.indexOf("xlink:")&&(c="http://www.w3.org/1999/xlink"),n===!1||r(n)?o.removeAttribute(e):c?n===!0?o.setAttributeNS(c,e,e):o.setAttributeNS(c,e,n):n===!0?o.setAttribute(e,e):o.setAttribute(e,n)}}function h(t,o,r,i,l,a,d,u,c,f){if(l=e(d,l),n(o)){var s=r.props,v=r.state,p=r.state,m=r.getChildContext();m&&(f=A.extends({},f,m)),r.context=f;var h=r._updateComponent(v,p,s,l);h&&(k(t,h,u,c,f,!1),t.dom=h.dom,r._lastNode=h)}else{var y=!0;if(a&&a.componentShouldUpdate&&(y=a.componentShouldUpdate(t.dom,i,l)),y!==!1){a&&a.componentWillUpdate&&a.componentWillUpdate(t.dom,i,l);var h=o(l),g=t.dom;h.dom=g,k(r,h,g,c,f,!1),t.instance=h,a&&a.componentDidUpdate&&a.componentDidUpdate(t.dom,i,l)}}}function y(e,t,n,o,r,i,l){var a=e.length,d=t.length;if(a>d)for(var u=void 0;a!==d;){var c=e[a-1];n.removeChild((u=c.dom)||u&&(u=u.previousSibling)||(u=n.lastChild)),a--}else if(d>a)for(var f=0;a!==d;){var s=t[a+f],v=j(s,null,o,o,r,i);n.appendChild(v),d--,f++}for(var m=0;d>m;m++){var c=e[m],s=t[m];c!==s&&p(c,s,n,o,r,i)}}function g(e,t,n,o,r,i,l){var a=!1,u=0,c=0,f=t.length,s=e.length,p=void 0,m=void 0;if(0===f&&s>=5){if(T)for(var h=0;s>h;h++)w(e[h]);return void(n.textContent="")}var y=f-1,g=s-1,b=s>0?e[c]:null,C=f>0?t[u]:null,x=void 0,N=void 0,U=void 0;e:for(;!a&&y>=u&&g>=c;){for(a=!0;C.key===b.key;){if(k(b,C,n,o,r,i,!0),u++,c++,u>y||c>g)break e;C=t[u],b=e[c],a=!1}for(x=t[y],N=e[g];x.key===N.key;){if(k(N,x,n,o,r,i,!0),y--,g--,u>y||c>g)break e;x=t[y],N=e[g],a=!1}for(;x.key===b.key;){if(U=f>y+1?t[y+1].dom:l,k(b,x,n,o,r,i,!0),d(n,x.dom,U),y--,c++,u>y||c>g)break e;x=t[y],b=e[c],a=!1}for(;C.key===N.key;){if(U=e[c].dom,k(N,C,n,o,r,i,!0),d(n,C.dom,U),u++,g--,u>y||c>g)break e;C=t[u],N=e[g],a=!1}}if(c>g){if(y>=u)for(U=f>y+1?t[y+1].dom:l;y>=u;u++)p=t[u],d(n,j(p,null,o,r,i),U)}else if(u>y)for(;g>=c;c++)m=e[c],v(m,n);else{for(var S={},h=c;g>=h;h++)m=e[h],S[m.key]=m;for(var _=f>y+1?t[y+1]:null,h=y;h>=u;h--){p=t[h];var O=p.key;m=S[O],void 0!==m?(S[O]=null,k(m,p,n,o,r,!0),p.dom.nextSibling!==_&&(_=_&&_.dom||l,d(n,p.dom,_)),_=p):(_=_&&_.dom||l,d(n,j(p,null,o,r,i),_)),_=p}for(var h=c;g>=h;h++)m=e[h],null!==S[m.key]&&v(m,n)}}function k(e,t,r,l,a,d,u){if(t!==!1&&null!==t){if(o(e))return void(o(t)&&(r.firstChild.nodeValue=t));var c=t.tag||(u&&t.static?t.static.tag:null),s=e.tag||(u&&e.static?e.static.tag:null);if(e.events&&e.events.willUpdate&&e.events.willUpdate(e.dom),s!==c)return void(i(s)&&!i(c)?n(s)?k(e.instance._lastNode,t,r,l,a,d,!0):k(e.instance,t,r,l,a,d,!0):f(e,t,r,l,a,d));if(i(s)&&i(c))return t.instance=e.instance,t.dom=e.dom,void h(t,t.tag,t.instance,e.attrs,t.attrs,t.events,t.children,r,a,d);var v=e.dom;t.dom=v,b(e,t,v,l,a,d,u),e.className!==t.className&&(v.className=t.className),C(e,t,v),x(e,t,v),t.events&&t.events.didUpdate&&t.events.didUpdate(v)}}function b(e,n,i,l,a,d,u){var c=n.children,f=e.children;if(f!==c)if(r(f))o(c)?i.textContent=c:c&&t(c)?S(c,i,l,a,d):c&&"object"===("undefined"==typeof c?"undefined":A.typeof(c))&&j(c,i,l,a,d);else if(r(c))i.textContent="";else if(t(f))if(t(c)){var s=!0;s?g(f,c,i,l,a,d,null):y(f,c,i,l,a,d,null)}else y(f,[c],i,l,a,d,null);else t(c)?y([f],c,i,l,a,d,null):o(f)?o(c)&&(i.firstChild.nodeValue=c):k(f,c,i,l,a,d,u)}function C(e,t,n){var o=t.attrs,r=e.attrs,i=o&&Object.keys(o);if(o&&0!==i.length)for(var l=0;l<i.length;l++){var a=i[l],d=r[a],u=o[a];d!==u&&m(a,d,u,n)}}function x(e,t,n){}function N(e,t,n){var o=e.key,r=void 0;if(null!==o){var i=e.static.static.keyed[o];r=i&&i.pop()}else{var i=e.static.static.nonKeyed;r=i&&i.pop()}return r?(k(r,e,null,t,n,null,!0),e.dom):void 0}function w(e){var t=e.key,n=e.static.static;if(null===t){var o=n.nonKeyed;o&&o.push(e)}else{var r=n.keyed;(r[t]||(r[t]=[])).push(e)}}function U(e,t,n){if(E[e]){var o=E[e];o.push({callback:n,target:t})}else document.addEventListener(e,function(t){for(var n=E[e],o=n.length-1;o>-1;o--){var r=n[o];r.target===t.target&&r.callback(t)}},!1),E[e]=[]}function S(e,n,r,i,l){if(t(e))for(var a=0;a<e.length;a++){var d=e[a];o(d)?c(d,n,!1):j(d,n,r,i,l)}else o(e)?c(e,n,!0):j(e,n,r,i,l)}function _(t,o,r,i,l,a,d,u){if(r=e(l,r),n(o)){var c=new o(r);c._diffNodes=k;var f=c.getChildContext();f&&(u=A.extends({},u,f)),c.context=u,c.componentWillMount();var s=c.render(),v=void 0;return s&&(v=j(s,null,d,u),c._lastNode=s,a&&a.appendChild(v),d.addListener(c.componentDidMount)),t.dom=v,t.instance=c,v}var p=function(){var e=void 0;i&&(i.componentWillMount&&i.componentWillMount(null,r),i.componentDidMount&&d.addListener(function(){i.componentDidMount(e,r)}));var n=o(r);return e=j(n,null,d,u),t.instance=n,a&&a.appendChild(e),t.dom=e,{v:e}}();return"object"===("undefined"==typeof p?"undefined":A.typeof(p))?p.v:void 0}function j(e,n,l,a,d){var c=void 0;if(!r(e)&&!t(e)){if(o(e))return document.createTextNode(e);if(T&&(c=N(e,a,d)))return n&&n.appendChild(c),c;var f=e.tag;if(i(f))return _(e,f,e.attrs,e.events,e.children,n,a,d);c=e.static&&e.static.dom?e.static.dom.cloneNode(!0):u(f,l);var s=e.children,v=e.attrs,p=e.events;return p&&(p.click&&U("click",c,p.click),p.created&&p.created(c),p.attached&&a.addListener(function(){p.attached(c)})),r(s)||S(s,c,l,a,d),v&&O(v,c),r(e.className)||(c.className=e.className),e.dom=c,null!==n&&n.appendChild(c),c}}function O(e,t){for(var n=Object.keys(e),o=0;o<n.length;o++){var r=n[o];m(r,null,e[r],t)}}function D(e){for(var t=0;t<K.length;t++){var n=K[t];if(n.dom===e)return n}return null}function M(e){for(var t=0;t<K.length;t++){var n=K[t];if(n===e)return K.splice(t,1),!0}return!1}function W(e,t){var n=D(t),o=new L;r(n)?(j(e,t,null,o,{}),o.trigger(),K.push({node:e,dom:t})):(p(n.node,e,t,null,o,{}),o.trigger(),null===e&&M(n),n.node=e)}var A={};A.typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},A.classCallCheck=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},A.createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),A.extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e};var L=function(){function e(){A.classCallCheck(this,e),this._listeners=[]}return A.createClass(e,[{key:"addListener",value:function(e){this._listeners.push(e)}},{key:"trigger",value:function(){for(var e=0;e<this._listeners.length;e++)this._listeners[e]()}}]),e}(),T=!0,E={},K=[],P={render:W};return P});