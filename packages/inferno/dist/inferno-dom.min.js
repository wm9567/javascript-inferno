!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):e.InfernoDOM=n()}(this,function(){"use strict";function e(e,t){return r(e)||(n(e)&&e.length>0||!n(e))&&(t?t.children=e:t={children:e}),t}function n(e){return e.constructor===Array}function t(e){return e&&e.prototype&&e.prototype.render}function o(e){return"string"==typeof e||"number"==typeof e}function r(e){return void 0===e||null===e}function i(e){return"function"==typeof e}function l(e){return"o"===e[0]&&"n"===e[1]&&e.length>3}function a(e){return"string"==typeof e}function u(e,n,t){t?e.insertBefore(n,t):e.appendChild(n)}function d(e,n,t){if(t)""!==e?n.textContent=e:n.appendChild(document.createTextNode(""));else{var o=document.createTextNode(e);n.appendChild(o)}}function c(e,n,t,o,r){var i=D(n,null,o,r);t.replaceChild(i,e.dom),n.dom=i}function f(e){t(e.instance)&&(e.instance.componentWillUnmount(),e.instance._unmounted=!0),e.events&&e.events.willDetach&&e.events.willDetach(e.dom),e.events&&e.events.componentWillUnmount&&e.events.componentWillUnmount(e.dom,e.events);var o=e.children;if(o)if(n(o))for(var r=0;r<o.length;r++)f(o[r]);else f(o)}function s(e,n){var t=e.dom;f(e),t===n?t.innerHTML="":(n.removeChild(t),O&&U(e))}function v(e,n,t,o,i){return r(e)?void D(n,t,o):r(n)?void s(e,t):void g(e,n,t,o,i,e.static!==n.static)}function p(e,n,t,o){if(n!==t)if("className"===e)o.className=t;else if("style"===e)if(a(t))o.style.cssText=t;else for(var i in t)o.style[i]=t[i];else l(e)||(t===!1||r(t)?o.removeAttribute(e):t===!0?o.setAttribute(e,e):o.setAttribute(e,t))}function m(n,o,r,i,l,a,u,d,c,f){if(l=e(u,l),t(o)){var s=r.props,v=r.state,p=r.state,m=r.getChildContext();m&&(f=A({},f,m)),r.context=f;var h=r._updateComponent(v,p,s,l);h&&(g(n,h,d,c,f,!1),n.dom=h.dom,r._lastNode=h)}else{var y=!0;if(a&&a.componentShouldUpdate&&(y=a.componentShouldUpdate(n.dom,i,l)),y!==!1){a&&a.componentWillUpdate&&a.componentWillUpdate(n.dom,i,l);var h=o(l),k=n.dom;h.dom=k,g(r,h,k,c,f,!1),n.instance=h,a&&a.componentDidUpdate&&a.componentDidUpdate(n.dom,i,l)}}}function h(e,n,t,o,r,i){var l=e.length,a=n.length,u=0,d=void 0;if(l>a)for(;l!==a;){var c=e[l-1];t.removeChild((d=c.dom)||d&&(d=d.previousSibling)||(d=t.lastChild)),l--}else if(a>l)for(;l!==a;){var f=n[l+u],s=D(f,null,o,r);t.appendChild(s),a--,u++}for(var p=0;a>p;p++){var c=e[p],f=n[p];c!==f&&v(c,f,t,o,r)}}function y(e,n,t,o,r,i){var l=!1,a=0,d=0,c=n.length,f=e.length,v=void 0,p=void 0;if(0===c&&f>=5){if(O)for(var m=0;f>m;m++)U(e[m]);return void(t.textContent="")}var h=c-1,y=f-1,k=f>0?e[d]:null,C=c>0?n[a]:null,b=void 0,x=void 0,w=void 0;e:for(;!l&&h>=a&&y>=d;){for(l=!0;C.key===k.key;){if(g(k,C,t,o,r,!0),a++,d++,a>h||d>y)break e;C=n[a],k=e[d],l=!1}for(b=n[h],x=e[y];b.key===x.key;){if(g(x,b,t,o,r,!0),h--,y--,a>h||d>y)break e;b=n[h],x=e[y],l=!1}for(;b.key===k.key;){if(w=c>h+1?n[h+1].dom:i,g(k,b,t,o,r,!0),u(t,b.dom,w),h--,d++,a>h||d>y)break e;b=n[h],k=e[d],l=!1}for(;C.key===x.key;){if(w=e[d].dom,g(x,C,t,o,r,!0),u(t,C.dom,w),a++,y--,a>h||d>y)break e;C=n[a],x=e[y],l=!1}}if(d>y){if(h>=a)for(w=c>h+1?n[h+1].dom:i;h>=a;a++)v=n[a],u(t,D(v,null,o,r),w)}else if(a>h)for(;y>=d;d++)p=e[d],s(p,t);else{for(var N={},m=d;y>=m;m++)p=e[m],N[p.key]=p;for(var _=c>h+1?n[h+1]:null,m=h;m>=a;m--){v=n[m];var M=v.key;p=N[M],void 0!==p?(N[M]=null,g(p,v,t,o,!0),v.dom.nextSibling!==_&&(_=_&&_.dom||i,u(t,v.dom,_)),_=v):(_=_&&_.dom||i,u(t,D(v,null,o,r),_)),_=v}for(var m=d;y>=m;m++)p=e[m],null!==N[p.key]&&s(p,t)}}function g(e,n,r,l,a,u){if(n!==!1&&null!==n){if(o(e))return void(o(n)&&(r.firstChild.nodeValue=n));var d=n.tag||(u?n.static.tag:null),f=e.tag||(u?e.static.tag:null);if(e.events&&e.events.willUpdate&&e.events.willUpdate(e.dom),f!==d)return void(i(f)&&!i(d)?t(f)?g(e.instance._lastNode,n,r,l,a,!0):g(e.instance,n,r,l,a,!0):c(e,n,r,l,a));if(i(f)&&i(d))return n.instance=e.instance,n.dom=e.dom,void m(n,n.tag,n.instance,e.attrs,n.attrs,n.events,n.children,r,l,a);var s=e.dom;n.dom=s,k(e,n,s,l,a,u),C(e,n,s),b(e,n,s),n.events&&n.events.didUpdate&&n.events.didUpdate(s)}}function k(e,t,i,l,a,u){var d=t.children,c=e.children;if(c!==d&&!r(c)&&!r(d))if(n(c))if(n(d)){var f=d.length&&!r(d[0].key)||c.length&&!r(c[0].key);f?y(c,d,i,l,a,null):h(c,d,i,l,a,null)}else h(c,[d],i,l,a,null);else n(d)?h([c],d,i,l,a,null):o(c)?o(d)&&(i.firstChild.nodeValue=d):g(c,d,i,l,a,u)}function C(e,n,t){var o=n.attrs,r=e.attrs;if(o)for(var i=0;i<o.length;i++){var l=r[i],a=o[i],u=l&&l.name,d=a&&a.name,c=l&&l.value,f=a&&a.value;u&&u===d&&p(u,c,f,t)}}function b(e,n,t){}function x(e,n,t){var o=e.key,r=void 0;if(null!==o){var i=e.static.static.keyed[o];r=i&&i.pop()}else{var i=e.static.static.nonKeyed;r=i&&i.pop()}return r?(g(r,e,null,n,t,null,!0),e.dom):void 0}function U(e){var n=e.key,t=e.static.static;if(null===n){var o=t.nonKeyed;o&&o.push(e)}else{var r=t.keyed;(r[n]||(r[n]=[])).push(e)}}function w(e,n,t){if(E[e]){var o=E[e];o.push({callback:t,target:n})}else document.addEventListener(e,function(n){for(var t=E[e],o=t.length-1;o>-1;o--){var r=t[o];r.target===n.target&&r.callback(n)}},!1),E[e]=[]}function N(e,t,r,i){if(n(e))for(var l=0;l<e.length;l++){var a=e[l];o(a)?d(a,t,!1):D(a,t,r,i)}else o(e)?d(e,t,!0):D(e,t,r,i)}function _(n,o,r,i,l,a,u,d){if(r=e(l,r),t(o)){var c=new o(r);c._diffNodes=g;var f=c.getChildContext();f&&(d=A({},d,f)),c.context=d,c.componentWillMount();var s=c.render(),v=void 0;return s&&(v=D(s,null,u,d),c._lastNode=s,a&&a.appendChild(v),u.addListener(c.componentDidMount)),n.dom=v,n.instance=c,v}var p=function(){var e=void 0;i&&(i.componentWillMount&&i.componentWillMount(null,r),i.componentDidMount&&u.addListener(function(){i.componentDidMount(e,r)}));var t=o(r);return e=D(t,null,u,d),n.instance=t,a&&a.appendChild(e),n.dom=e,{v:e}}();return"object"===("undefined"==typeof p?"undefined":T.typeof(p))?p.v:void 0}function D(e,t,l,a){var u=void 0;if(null!==e&&!r(e)&&!n(e)){if(o(e))return document.createTextNode(e);if(O&&(u=x(e,l,a)))return t&&t.appendChild(u),u;if(i(e.tag))return _(e,e.tag,e.attrs,e.events,e.children,t,l,a);u=e.static.dom?e.static.dom.cloneNode(!0):document.createElement(e.tag);var d=e.children,c=e.attrs,f=e.events;return f&&(f.click&&w("click",u,f.click),f.created&&f.created(u),f.attached&&l.addListener(function(){f.attached(u)})),c&&M(c,u),r(d)||N(d,u,l,a),e.dom=u,null!==t&&t.appendChild(u),u}}function M(e,n){for(var t=0;t<e.length;t++){var o=e[t],r=o&&o.name,i=o&&o.value;r&&p(r,null,i,n)}}function S(e){for(var n=0;n<K.length;n++){var t=K[n];if(t.dom===e)return t}return null}function W(e){for(var n=0;n<K.length;n++){var t=K[n];if(t===e)return K.splice(n,1),!0}return!1}function L(e,n){var t=S(n),o=new j;r(t)?(D(e,n,o,{}),o.trigger(),K.push({node:e,dom:n})):(v(t.node,e,n,o,{}),o.trigger(),null===e&&W(t),t.node=e)}var T={};T.typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},T.classCallCheck=function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")},T.createClass=function(){function e(e,n){for(var t=0;t<n.length;t++){var o=n[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(n,t,o){return t&&e(n.prototype,t),o&&e(n,o),n}}();var j=function(){function e(){T.classCallCheck(this,e),this._listeners=[]}return T.createClass(e,[{key:"addListener",value:function(e){this._listeners.push(e)}},{key:"trigger",value:function(){for(var e=0;e<this._listeners.length;e++)this._listeners[e]()}}]),e}(),A=Object.assign||function(e){for(var n=arguments.length,t=Array(n>1?n-1:0),o=1;n>o;o++)t[o-1]=arguments[o];for(var r=t.length,i=1;r>i;i++){var l=t[i];for(var a in l)Object.prototype.hasOwnProperty.call(l,a)&&(e[a]=l[a])}return e},O=!0,E={},K=[],P={render:L};return P});