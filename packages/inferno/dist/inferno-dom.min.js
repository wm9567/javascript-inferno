!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):e.InfernoDOM=n()}(this,function(){"use strict";function e(){this._listeners=[]}function n(e,n){if(!o(e)){var r=t(e);(r&&e.length>0||!r)&&(n?n.children=e:n={children:e})}return n}function t(e){return e instanceof Array}function r(e){return void 0!==e.prototype.render}function l(e){return"string"==typeof e||"number"==typeof e}function o(e){return void 0===e||null===e}function i(e){return void 0===e||null===e||e===!1}function a(e){return"function"==typeof e}function d(e){return"string"==typeof e}function s(e){return e instanceof Promise}function f(e,n,t){e.splice(e.indexOf(n),1,t)}function u(e){return!o(e.append)}function c(e,n,t){o(t)?u(n)?n.append(e):e.appendChild(n):u(n)?n.insert(e,t):u(t)?e.insertBefore(n,t.childNodes[0]):e.insertBefore(n,t)}function v(e,n,t){o(t)?e.appendChild(n):e.insertBefore(n,t)}function h(e,n){return o(n)?document.createElement(e):document.createElementNS(n,e)}function p(e,n,t){if(!n)return document.createTextNode(e);if(!t){var r=document.createTextNode(e);return n.appendChild(r),r}if(""===e){var l=document.createTextNode("");return n.appendChild(l),l}n.textContent=e}function m(e,n,t,r,l,i,a){var d=null,s=e._lastNode;o(s)||(d=e,e=s);var f=Q(n,null,r,l,i,a);n.dom=f,t.replaceChild(f,e.dom),null!==d&&(d._lastNode=n),g(e)}function g(e){if(!i(e)&&!l(e)){var n=e.instance,r=null,a=null;o(n)||(r=n.hooks,a=n.children,void 0!==n.render&&(n.componentWillUnmount(),n._unmounted=!0));var d=e.hooks||r;o(d)||(o(d.willDetach)||d.willDetach(e.dom),o(d.componentWillUnmount)||d.componentWillUnmount(e.dom,d));var s=e.children||a;if(!o(s))if(t(s))for(var f=0;f<s.length;f++)g(s[f]);else g(s)}}function y(){return document.createTextNode("")}function C(e,n){var t=e.dom;t===n?t.innerHTML="":(n.removeChild(t),ce&&J(e)),g(e)}function k(e,n){for(var t in e)n[t]=null}function N(e,n,t){for(var r=0;r<n.length;r++)e.insertBefore(n[r],t)}function b(){return document.activeElement}function x(e,n){if(ce){var t=n.length;if(t>5)for(var r=0;t>r;r++){var l=n[r];i(l)||J(l)}}e.textContent=""}function w(e){e!==document.body&&document.activeElement!==e&&e.focus()}function O(){var e=[],n=document.createTextNode(""),t=null,r={childNodes:e,appendChild:function(r){e.push(r),t&&t.insertBefore(r,n)},removeChild:function(n){t&&t.removeChild(n),e.splice(e.indexOf(n),1)},insertBefore:function(n,r){t&&t.insertBefore(n,r),e.splice(e.indexOf(r),0,n)},replaceChild:function(n,r){t.replaceChild(n,r),f(e,r,n)},append:function(r){r.appendChild(n),t=r,N(t,e,n)},insert:function(r,l){r.insertBefore(n,l),t=r,N(t,e,n)},remove:function(){t.removeChild(n);for(var r=0;r<e.length;r++)t.removeChild(e[r]);t=null},getElementsByTagName:null};return Object.defineProperty(r,"parentNode",{get:function(){return t}}),Object.defineProperty(r,"firstChild",{get:function(){return e[0]}}),r}function U(e,n){return n.length&&!o(n[0])&&void 0!==n[0].key||e.length&&!o(e[0])&&void 0!==e[0].key}function S(e,n){if("option"===e.tag){var t=e.attrs&&e.attrs.value;n[t]&&(e.attrs=e.attrs||{},e.attrs.selected="selected")}else for(var r=0,l=e.children.length;l>r;r++)S(e.children[r],n)}function T(e){if("select"===e.tag){var n=e.attrs&&e.attrs.value;if(!o(n)){var r={};if(t(n))for(var l=0,i=n.length;i>l;l++)r[n[l]]=n[l];else r[n]=n;S(e,r),e.attrs&&e.attrs[n]&&delete e.attrs.value}}}function _(e,n){var t=y();return null!==n&&n.appendChild(t),i(e)||(e.dom=t),t}function j(e,n,t){o(e.created)||e.created(t),o(e.attached)||n.addListener(function(){e.attached(t)})}function A(e,n,r,a,d,s,f,u){var c=n.children,v=e.children;if(v!==c){var h=null;e.domChildren&&(h=n.domChildren=e.domChildren),i(v)?l(c)?L(r,v,c):o(c)||(t(c)?ee(n,c,r,a,d,s,f):Q(c,r,a,d,s,f)):i(c)?x(r,v):t(v)?t(c)?null===h&&v.length>1?F(v,c,r,a,d,s,f):U(v,c)?F(v,c,r,a,d,s,f):q(v,c,r,h||(n.domChildren=[]),a,d,s,f,0):q(v,[c],r,h||[],a,d,s,f,0):t(c)?q([v],c,r,h||(n.domChildren=[r.firstChild]),a,d,s,f,0):l(c)?L(r,v,c):l(v)?H(v,c,r,a,d,s,f,null):H(v,c,r,a,d,s,f,u)}}function M(e,n,t,r){e&&(d(n)&&delete e.refs[n],d(t)&&(e.refs[t]=r))}function B(e,n,t){var r=n.events,l=e.events,i=!o(r),a=!o(l);i?a?I(l,r,t):re(r,t):a&&k(l,t)}function E(e,n,t,r){"select"===e.tag&&T(n);var l=n.attrs,i=e.attrs,a=o(l),d=o(i);if(!a)for(var s=Object.keys(l),f=s.length,u=0;f>u;u++){var c=s[u],v=!d&&i[c],h=l[c];v!==h&&("ref"===c?M(r,v,h,t):K(c,h,t))}if(!d)for(var p=Object.keys(i),m=p.length,g=0;m>g;g++){var y=p[g];(a||o(l[y]))&&("ref"===y?M(r,i[y],null,t):t.removeAttribute(y))}}function D(e,n,t,l,a,d,s,f,u,c){var v=void 0;n.hasHooks===!0&&(v=n.hooks&&!o(v.willUpdate))&&v.willUpdate(e.dom);var h=n.tag||c&&t.tag,p=e.tag||c&&l.tag;if(p!==h)if(e.tpl.isComponent===!0){var g=e.instance;l.isComponent===!0?m(g||e,n,a,d,s,f,u):r(p)?W(g._lastNode,n,a,d,s,f,u,!0):W(g,n,a,d,s,f,u,!0)}else m(e,n,a,d,s,f,u);else if(o(p))n.dom=e.dom;else if(t.isComponent===!0)l.isComponent===!0&&(n.instance=e.instance,n.dom=e.dom,X(!0,n,n.tag,t,l,n.instance,e.attrs||{},n.attrs||{},n.hooks,n.children,a,s,f));else{var y=e.dom,C=t.childrenType;if(n.dom=y,C>0){var k=l.childrenType,N=e.children,b=n.children;N!==b&&(4===C?4===k&&F(N,b,y,d,s,f,u):2===C?2===k&&(i(b)?x(y,N):i(N)?Q(b,y,d,s,f,u):H(N,b,y,d,s,f,u,c)):1===C?1===k&&L(y,N,b):A(e,n,y,d,s,f,u,c))}if(t.hasAttrs===!0&&E(e,n,y,u),t.hasEvents===!0&&B(e,n,y),t.hasClassName===!0){var w=n.className;e.className!==w&&(o(w)?y.removeAttribute("class"):y.className=w)}if(t.hasStyle===!0){var O=n.style;e.style!==O&&P(e.style,O,y)}n.hasHooks!==!0||o(v.didUpdate)||v.didUpdate(y)}}function W(e,n,t,l,i,d,f,u){if(s(n))n.then(function(n){W(e,n,t,l,i,d,u,f)});else{var c=n.hooks,v=!o(c);v&&!o(c.willUpdate)&&c.willUpdate(e.dom);var h=n.tag||(u&&!o(n.tpl)?n.tpl.tag:null),p=e.tag||(u&&!o(e.tpl)?e.tpl.tag:null);if(l=l||"svg"===h?ue:"math"===h?fe:null,p!==h){var g=e.instance;a(p)?a(h)?m(g||e,n,t,l,i,d,f):r(p)?W(g._lastNode,n,t,l,i,d,f,!0):W(g,n,t,l,i,d,f,!0):m(g||e,n,t,l,i,d,f)}else if(o(p))n.dom=e.dom;else if(a(p))a(h)&&(n.instance=e.instance,n.dom=e.dom,X(!1,n,n.tag,null,null,n.instance,e.attrs||{},n.attrs||{},n.hooks,n.children,t,i,d));else{var y=e.dom,C=n.className,k=n.style;n.dom=y,A(e,n,y,l,i,d,f,u),E(e,n,y,f),B(e,n,y),e.className!==C&&(o(C)?y.removeAttribute("class"):y.className=C),e.style!==k&&P(e.style,k,y),v&&!o(c.didUpdate)&&c.didUpdate(y)}}}function V(e){switch(e.length){case 5:return"value"===e;case 7:return"checked"===e;case 8:return"disabled"===e||"selected"===e;default:return!1}}function L(e,n,t){l(n)?e.firstChild.nodeValue=t:e.textContent=t}function H(e,n,t,r,o,a,d,s){if(null!==s){var f=e.tpl,u=n.tpl;void 0===f?W(e,n,t,r,o,a,d,!0):D(e,n,f,u,t,r,o,a,d,!0)}else if(i(e))Q(n,t,r,o,a,d);else if(i(n))C(e,t);else if(l(e))if(l(n))t.firstChild.nodeValue=n;else{var c=Q(n,null,r,o,a,d);n.dom=c,t.replaceChild(c,t.firstChild)}else if(l(n)){var v=document.createTextNode(n);t.replaceChild(v,e.dom)}else{var h=e.tpl,p=n.tpl,m=h!==p;void 0===h?W(e,n,t,r,o,a,d,m):D(e,n,h,p,t,r,o,a,d,m)}}function P(e,n,t){if(d(n))t.style.cssText=n;else if(o(e)){if(!o(n))for(var r=Object.keys(n),l=0;l<r.length;l++){var i=r[l],a=n[i];t.style[i]=a}}else if(o(n))t.removeAttribute("style");else{for(var s=Object.keys(n),f=0;f<s.length;f++){var u=s[f],c=n[u];t.style[u]=c}for(var v=Object.keys(e),h=0;h<v.length;h++){var p=v[h];o(n[p])&&(t.style[p]="")}}}function I(e,n,t){for(var r=Object.keys(n),l=0;l<r.length;l++){var i=r[l],a=e[i],d=n[i];a!==d&&(t[i]=d)}for(var s=Object.keys(e),f=0;f<s.length;f++){var u=s[f];o(n[u])&&(t[u]=null)}}function K(e,n,t){return V(e)?void(t[e]=n):void(n===!1||o(n)?t.removeAttribute(e):":"===e[5]&&-1!==e.indexOf("xlink:")?t.setAttributeNS("http://www.w3.org/1999/xlink",e,n===!0?e:n):":"===e[4]&&-1!==e.indexOf("xml:")?t.setAttributeNS("http://www.w3.org/XML/1998/namespace",e,n===!0?e:n):t.setAttribute(e,n===!0?e:n))}function X(e,t,l,i,a,d,s,f,u,c,v,h,p){if(f=n(c,f),r(l)){var m=d.props,g=d.state,y=d.state,C=d.getChildContext();o(C)||(p=se.extends({},p,C)),d.context=p;var k=d._updateComponent(g,y,m,f);o(k)||(H(t,k,v,null,h,p,d,!0),t.dom=k.dom,d._lastNode=k)}else{var N=!0,b=e&&a.hasHooks===!0||!o(u);if(b&&!o(u.componentShouldUpdate)&&(N=u.componentShouldUpdate(t.dom,s,f)),N!==!1){b&&!o(u.componentWillUpdate)&&u.componentWillUpdate(t.dom,s,f);var x=l(f),w=t.dom;x.dom=w,H(d,x,w,null,h,p,null,!0),t.instance=x,b&&!o(u.componentDidUpdate)&&u.componentDidUpdate(t.dom,s,f)}}}function q(e,n,r,a,d,s,f,u,v){var h=void 0===r.append,p=e.length,m=n.length,C=p===m;if(C===!1)if(p>m)for(;p!==m;){var k=e[p-1];i(k)||(r.removeChild(a[p-1+v]),g(k)),p--}else for(;p!==m;){var N=n[p],b=void 0;b=l(N)?document.createTextNode(N):Q(N,null,d,s,f,u),c(r,b),h&&(1===p&&a.push(r.firstChild),h&&a.splice(p+v,0,b)),p++}for(var x=0;m>x;x++){var w=e[x],S=n[x],T=x+v;if(w!==S)if(i(S)){if(!i(w)){var _=a[T];if(!o(_))if(l(w))_.nodeValue="";else if(C===!0){var j=y();t(w)&&0===w.length?(c(r,j),h&&a.splice(T,0,j)):(r.replaceChild(j,a[T]),h&&a.splice(T,1,j),g(w))}}}else if(i(w)){if(l(S)){var A=document.createTextNode(S);r.replaceChild(A,a[T]),h&&a.splice(T,1,A)}else if(C===!0){var M=Q(S,null,d,s,f,u);r.replaceChild(M,a[T]),h&&a.splice(T,1,M)}}else if(l(S))if(1===p)l(w)?void 0!==r.getElementsByTagName?r.firstChild.nodeValue=S:r.nodeValue=S:(g(w),r.textContent=S);else{var B=document.createTextNode(S),E=a[T];o(E)?r.nodeValue=B.nodeValue:void 0===E.append?(h&&a.splice(T,1,B),r.replaceChild(B,E)):(r.insertBefore(B,E.firstChild),E.remove(),a.splice(0,a.length,B)),g(w)}else if(t(S))if(U(w,S))F(w,S,a[T],d,s,f,u);else if(t(w)){var D=a[T];if(void 0===D.append)if(S.length>1&&1===w.length){var W=O();W.insert(r,D),W.appendChild(D),h&&a.splice(T,1,W),q(w,S,W,W.childNodes,d,s,f,u,0)}else q(w,S,r,a,d,s,f,u,0);else q(w,S,a[T],a[T].childNodes,d,s,f,u,0)}else if(S.length>1){var V=O();V.appendChild(r.firstChild),c(r,V,r.firstChild),h&&a.splice(T,1,V),q([w],S,V,V.childNodes,d,s,f,u,x)}else q([w],S,r,a,d,s,f,u,x);else t(w)?q(w,[S],a,a[T].childNodes,d,s,f,u,0):H(w,S,r,d,s,f,u,null)}}function z(e){var n=e.slice(0),t=[];t.push(0);for(var r=void 0,l=void 0,o=void 0,i=0,a=e.length;a>i;i++)if(-1!==e[i]){var d=t[t.length-1];if(e[d]<e[i])n[i]=d,t.push(i);else{for(r=0,l=t.length-1;l>r;)o=(r+l)/2|0,e[t[o]]<e[i]?r=o+1:l=o;e[i]<e[t[r]]&&(r>0&&(n[i]=t[r-1]),t[r]=i)}}for(r=t.length,l=t[r-1];r-- >0;)t[r]=l,l=n[l];return t}function F(e,n,t,r,l,o,i){var a=e.length-1,d=n.length-1;if(-1!==a)if(-1!==d){var s=0,f=0,u=e[s],c=n[f],h=e[a],p=n[d],m=!1,g=void 0,y=void 0,k=0,N=void 0,b=void 0;e:do{for(m=!0;u.key===c.key;){if(H(u,c,t,r,l,o,i,!0),s++,f++,s>a||f>d)break e;u=e[s],c=n[f],m=!1}for(;h.key===p.key;){if(H(h,p,t,r,l,o,i,!0),a--,d--,s>a||f>d)break e;h=e[a],p=n[d],m=!1}for(;u.key===p.key;){if(H(u,p,t,r,l,o,i,!0),g=d+1,y=g<n.length?n[g].dom:null,v(t,p.dom,y),s++,d--,s>a||f>d)break e;u=e[s],p=n[d],m=!1;continue e}for(;h.key===c.key;){if(H(h,c,t,r,l,o,i,!0),v(t,c.dom,u.dom),a--,f++,s>a||f>d)break e;h=e[a],c=n[f],m=!1}}while(!m&&a>=s&&d>=f);if(s>a)for(g=d+1,y=g<n.length?n[g].dom:null;d>=f;)v(t,Q(n[f++],null,r,l,o,i),y);else if(f>d)for(;a>=s;)C(e[s++],t);else{for(var x=a-s+1,w=d-f+1,O=new Array(w),U=0;w>U;U++)O[U]=-1;var S=!1,T=0;if(16>=x*w)for(var _=s;a>=_;_++){for(var j=!0,A=e[_],M=f;d>=M;M++){var B=n[M];if(A.key===B.key){O[M-f]=_,k>M?S=!0:k=M,H(A,B,t,r,l,o,i,!0),j=!1;break}}j&&(C(A,t),T++)}else{for(var E={},D=f;d>=D;D++)b=n[D],E[b.key]=D;for(var W=s;a>=W;W++){var V=e[W],L=E[V.key];if(void 0!==L){var P=n[L];O[L-f]=W,k>L?S=!0:k=L,H(V,P,t,r,l,o,i,!0)}else C(V,t),T++}}if(S)for(var I=z(O),K=I.length-1,X=w-1;X>=0;X--)-1===O[X]?(N=X+f,b=n[N],g=N+1,y=w>g?n[g].dom:null,v(t,Q(b,null,r,l,o,i),y)):0>K||X!==I[K]?(N=X+f,b=n[N],g=N+1,y=w>g?n[g].dom:null,v(t,b.dom,y)):K--;else if(x-T!==w)for(var q=w-1;q>=0;q--)-1===O[q]&&(N=q+f,b=n[N],g=N+1,y=w>g?n[g].dom:null,v(t,Q(b,null,r,l,o,i),y))}}else for(var F=0;a>=F;F++)C(e[F],t);else for(var G=0;d>=G;G++)Q(n[G],t,r,l,o,i)}function G(e,n,t,r,l){if(void 0!==n){var i=e.key,a=null===i?n.pools.nonKeyed:n.pools.keyed[i];if(!o(a)){var d=a.pop();if(!o(d))return H(d,e,null,null,t,r,l,!0),e.dom}}return null}function J(e){var n=e.tpl;if(!o(n)){var t=e.key,r=n.pools;if(null===t){var l=r.nonKeyed;l&&l.push(e)}else{var i=r.keyed;(i[t]||(i[t]=[])).push(e)}return!0}return!1}function Q(e,n,r,l,o,a){if(i(e)||t(e))return _(e,n);var d=e.tpl;if(ce){var s=G(e,d,l,o,a);if(null!==s)return null!==n&&n.appendChild(s),s}return void 0===d?Y(e,n,r,l,o,a):R(e,d,n,r,l,o,a)}function R(e,n,t,r,l,o,i){var a=e.tag;if(n.isComponent===!0)return le(e,a,e.attrs||{},e.hooks,e.children,t,l,o);var d=n.dom.cloneNode(!1);switch(e.dom=d,n.hasHooks===!0&&j(e.hooks,l,d),n.childrenType){case 1:p(e.children,d,!0);break;case 2:Q(e.children,d,r,l,o,i);break;case 3:ee(e,e.children,d,r,l,o,i);break;case 4:$(e.children,d,r,l,o,i);break;case 5:ne(e,e.children,d,r,l,o,i)}return n.hasAttrs===!0&&oe(e,e.attrs,d,i),n.hasClassName===!0&&(d.className=e.className),n.hasStyle===!0&&P(null,e.style,d),n.hasEvents===!0&&re(e.events,d),null!==t&&t.appendChild(d),d}function Y(e,n,t,r,l,s){var f=e.tag;if(null===f)return _(e,n);if(a(f))return le(e,f,e.attrs||{},e.hooks,e.children,n,r,l);if(t=t||"svg"===f?ue:"math"===f?fe:null,!d(f)||""===f)throw Error("Inferno Error: Expected function or string for element tag type");var u=h(f,t),c=e.children,v=e.attrs,p=e.events,m=e.hooks,g=e.className,y=e.style;return e.dom=u,o(m)||j(m,r,u),i(c)||ne(e,c,u,t,r,l,s),o(v)||oe(e,v,u,s),o(g)||(u.className=g),o(y)||P(null,y,u),o(p)||re(p,u),null!==n&&n.appendChild(u),u}function Z(e,n,t,r,l,o,i){var a=y();t&&t.push(a),e.then(function(e){var d=Q(e,null,r,l,o,i);n.replaceChild(d,a),t&&f(t,a,d)}),n.appendChild(a)}function $(e,n,t,r,l,o){for(var i=0;i<e.length;i++)Q(e[i],n,t,r,l,o)}function ee(e,n,r,a,d,f,u){for(var v=null,h=!1,m=!1,g=0;g<n.length;g++){var y=n[g];if(l(y))h=!0,v=v||[],v.push(p(y,r,!1));else if(!o(y)&&t(y)){var C=O();h=!0,ee(e,y,C,a,d,f,u),c(r,C),v=v||[],v.push(C)}else if(s(y))Z(y,r,v,a,d,f,u);else{var k=Q(y,r,a,d,f,u);h||!m&&y&&o(y.key)?(h=!0,v=v||[],v.push(k)):i(y)?(h=!0,v=v||[],v.push(k)):m===!1&&(m=!0)}}null!==v&&v.length>1&&h===!0&&(e.domChildren=v)}function ne(e,n,r,o,i,a,d){t(n)?ee(e,n,r,o,i,a,d):l(n)?p(n,r,!0):s(n)?Z(n,r,null,o,i,a,d):Q(n,r,o,i,a,d)}function te(e,n,t){!i(e)&&d(n)&&(e.refs[n]=t)}function re(e,n){for(var t=Object.keys(e),r=0;r<t.length;r++){var l=t[r];n[l]=e[l]}}function le(e,t,l,i,a,d,s,f){l=n(a,l);var u=void 0;if(r(t)){var c=new t(l);c._diffNodes=W;var v=c.getChildContext();o(v)||(f=se.extends({},f,v)),c.context=f,c._pendingSetState=!0,c.componentWillMount();var h=c.shouldComponentUpdate();if(h){c.componentWillUpdate();var p=c._pendingState,m=c.state;c.state=se.extends({},m,p)}var g=c.render();c._pendingSetState=!1,o(g)||(u=Q(g,null,null,s,f,c),c._lastNode=g,null!==d&&d.appendChild(u),c.componentDidMount(),c.componentDidUpdate()),e.dom=u,e.instance=c}else{o(i)||(o(i.componentWillMount)||i.componentWillMount(null,l),o(i.componentDidMount)||s.addListener(function(){i.componentDidMount(u,l)}));var y=t(l);u=Q(y,null,null,s,f,null),e.instance=y,null!==d&&d.appendChild(u),e.dom=u}return u}function oe(e,n,t,r){"select"===e.tag&&T(e);for(var l=Object.keys(n),o=0;o<l.length;o++){var i=l[o];"ref"===i?te(r,n[i],t):K(i,n[i],t)}}function ie(e){for(var n=0;n<ve.length;n++){var t=ve[n];if(t.dom===e)return t}return null}function ae(e){for(var n=0;n<ve.length;n++){var t=ve[n];if(t===e)return void ve.splice(n,1)}}function de(n,t){var r=ie(t),l=new e;if(null===r)Q(n,t,null,l,{},null),l.trigger(),ve.push({node:n,dom:t});else{var o=b();H(r.node,n,t,null,l,{},null,null),l.trigger(),null===n&&ae(r),r.node=n,w(o)}}var se={};se.typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},se.extends=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},e.prototype={addListener:function(e){this._listeners.push(e)},trigger:function(){for(var e=0;e<this._listeners.length;e++)this._listeners[e]()}};var fe="http://www.w3.org/1998/Math/MathML",ue="http://www.w3.org/2000/svg",ce=!0,ve=[],he={render:de};return he});