!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("./inferno-component"),require("./inferno-create-element")):"function"==typeof define&&define.amd?define(["inferno-component","inferno-create-element"],e):t.InfernoRouter=e(t.Component,t.createElement)}(this,function(t,e){"use strict";function n(t){return t instanceof Array}function r(t,e,n){n=n||{},e=e||[];var o,i=n.strict,a=n.end!==!1,s=n.sensitive?"":"i",p=0,c=e.length,u=0,f=0;if(t instanceof RegExp){for(;o=m.exec(t.source);)e.push({name:f++,optional:!1,offset:o.index});return t}if(Array.isArray(t))return t=t.map(function(t){return r(t,e,n).source}),new RegExp("(?:"+t.join("|")+")",s);for(t=("^"+t+(i?"":"/"===t[t.length-1]?"?":"/?")).replace(/\/\(/g,"/(?:").replace(/([\/\.])/g,"\\$1").replace(/(\\\/)?(\\\.)?:(\w+)(\(.*?\))?(\*)?(\?)?/g,function(t,n,r,o,i,a,s,c){n=n||"",r=r||"",i=i||"([^\\/"+r+"]+?)",s=s||"",e.push({name:o,optional:!!s,offset:c+p});var u=""+(s?"":n)+"(?:"+r+(s?n:"")+i+(a?"((?:[\\/"+r+"].+?)?)":"")+")"+s;return p+=u.length-t.length,u}).replace(/\*/g,function(t,n){for(var r=e.length;r-- >c&&e[r].offset>n;)e[r].offset+=3;return"(.*)"});o=m.exec(t);){for(var l=0,h=o.index;"\\"===t.charAt(--h);)l++;l%2!==1&&((c+u===e.length||e[c+u].offset>o.index)&&e.splice(c+u,0,{name:f++,optional:!1,offset:o.index}),u++)}return t+=a?"$":"/"===t[t.length-1]?"":"(?=\\/|$)",new RegExp(t,s)}function o(t){return"string"!=typeof t?t:decodeURIComponent(t)}function i(t){return!t||!(n(t)?t:Object.keys(t)).length}function a(t,e,n,r){var i=e+"|"+t,a=g.get(i);if(!a){var s=[];a={pattern:v(e,s,{end:t}),keys:s},g.set(i,a)}var p=a.pattern.exec(n);if(!p)return null;for(var c=p[0],u=Object.assign({},r),f=1;f<p.length;f+=1)u[a.keys[f-1].name]=o(p[f]);return{path:""===c?"/":c,params:u}}function s(t,e){var n=t.props||x,r=e.props||x,o=c(r.path)-c(n.path);return o||r.path&&n.path?r.path.length-n.path.length:0}function p(t){return t.replace(/(^\/+|\/+$)/g,"")}function c(t){return void 0===t&&(t=""),(p(t).match(/\/+/g)||"").length}function u(t,e){function r(t,e,p){if(!t)return t;var c=f(t);c.sort(s);for(var u=0;u<c.length;u++){var l=c[u];if(n(l))return r(l,e,p);var h=l.props,d=h.children,y=h.path;void 0===y&&(y="/");var m=(p+y).replace("//","/"),v=i(d);d&&(l.props.children=r(d,e,m));var g=a(v,m,e.replace("//","/"));if(g)return l.props.params=Object.assign(o,g.params),l.instance?l.type(l.instance.props,l.instance.context):l}}var o={};return r(t,e,"")}function f(t){return n(t)?t:t?[t]:t}function l(t,n){var r=n.router,o=t.activeClassName,i=t.activeStyle,a=t.className,s=t.to,p={href:s};return a&&(p.className=a),r.location.pathname===s&&(o&&(p.className=(a?a+" ":"")+o),i&&(p.style=Object.assign({},t.style,i))),p.onclick=function(e){0!==e.button||e.ctrlKey||e.altKey||(e.preventDefault(),t.onEnter?t.onEnter(t,function(t){r.push(s,e.target.textContent)}):r.push(s,e.target.textContent))},e("a",p,t.children)}t="default"in t?t.default:t,e="default"in e?e.default:e;var h={pending:"pending",fulfilled:"fulfilled",rejected:"rejected"},d=function(t){function n(e,n){t.call(this,e,n),this.state={async:null}}return t&&(n.__proto__=t),n.prototype=Object.create(t&&t.prototype),n.prototype.constructor=n,n.prototype.async=function t(){var e=this,t=this.props.async;t&&(this.setState({async:{status:h.pending}}),t(this.props.params).then(function(t){e.setState({async:{status:h.fulfilled,value:t}})},this.reject).catch(this.reject))},n.prototype.onEnter=function t(){var e=this.props,t=e.onEnter;t&&t(this.props,this.context.router)},n.prototype.onLeave=function t(){var e=this.props,t=e.onLeave;t&&t(this.props,this.context.router)},n.prototype.reject=function(t){this.setState({async:{status:h.rejected,value:t}})},n.prototype.componentWillReceiveProps=function(){this.async(),this.onLeave()},n.prototype.componentWillMount=function(){this.async()},n.prototype.componentDidUpdate=function(){this.onEnter()},n.prototype.render=function(){var t=this.props,n=t.component,r=t.children,o=t.params;return e(n,{params:o,async:this.state.async},r)},n}(t),y=r,m=/\((?!\?)/g,v=y||pathToRegExp1,g=new Map,x={},j=function(t){function e(e,n){t.call(this,e,n),this._didRoute=!1,this.router=e.history,this.state={url:e.url||this.router.location.pathname+this.router.location.search}}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getChildContext=function(){return{router:this.router||{location:{pathname:this.props.url}}}},e.prototype.componentWillMount=function(){var t=this;this.router&&(this.unlisten=this.router.listen(function(e){t.routeTo(e.pathname)}))},e.prototype.componentWillUnmount=function(){this.unlisten&&this.unlisten()},e.prototype.routeTo=function(t){return this._didRoute=!1,this.setState({url:t}),this._didRoute},e.prototype.render=function(){var t=this.props,e=t.matched,n=t.children,r=t.url;if(e)return e;var o=f(n);return u(o,r||this.state.url)},e}(t),R={Route:d,Router:j,Link:l,getRoutes:u};return R});
