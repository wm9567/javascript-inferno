!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("./inferno-create-element"),require("./inferno-component"),require("path-to-regexp-es6"),require("./inferno")):"function"==typeof define&&define.amd?define(["inferno-create-element","inferno-component","path-to-regexp-es6","inferno"],e):t.InfernoRouter=e(t.createElement,t.Component,t.pathToRegExp,t.inferno)}(this,function(t,e,r,n){"use strict";function o(e,r){var n=r.router,o=e.activeClassName,p=e.activeStyle,i=e.className,a=e.to,u={href:a};return i&&(u.className=i),n.location.pathname===a&&(o&&(u.className=(i?i+" ":"")+o),p&&(u.style=Object.assign({},e.style,p))),u.onclick=function(t){0!==t.button||t.ctrlKey||t.altKey||(t.preventDefault(),n.push(a,t.target.textContent))},t("a",u,e.children)}function p(e){return e.to="/",t(o,e)}function i(t){return a(t)?t:t?[t]:t}function a(t){return t instanceof Array}function u(t){return"string"==typeof t}function c(t){return"string"!=typeof t?t:decodeURIComponent(t)}function s(t){return!t||!(a(t)?t:Object.keys(t)).length}function l(t){var e=[];return g(t,e),e}function f(t){return u(t)?t:t.pathname+t.search}function h(t){if(""===t)return C;for(var e=Object.create(null),r=t.split("&"),n=0;n<r.length;n++){var o=r[n].split("=").map(m),p=o[0],i=o[1];e[p]?(e[p]=a(e[p])?e[p]:[e[p]],e[p].push(i)):e[p]=i}return e}function d(t,e){var r=t.props||C,n=e.props||C,o=v(n.path)-v(r.path);return o||n.path&&r.path?n.path.length-r.path.length:0}function m(t,e){return decodeURIComponent(0|e?t:t.replace("[]",""))}function y(t){return t.replace(/(^\/+|\/+$)/g,"")}function v(t){return void 0===t&&(t=""),(y(t).match(/\/+/g)||"").length}function g(t,e){for(var r=0;r<t.length;r++){var n=t[r];a(n)?g(n,e):e.push(n)}}function _(t,e){var r=f(e),n=b(i(t),r,"/");return n}function b(t,e,r){void 0===e&&(e="/"),void 0===r&&(r="/");var o=a(t)?l(t):i(t),p=e.split("?"),u=p[0];void 0===u&&(u="/");var c=p[1];void 0===c&&(c="");var f=h(c);o.sort(d);for(var m=0;m<o.length;m++){var y=o[m],v=(r+(y.props&&y.props.path||"/")).replace("//","/"),g=!y.props||s(y.props.children),_=x(g,v,u);if(_){var j=null;if(y.props&&y.props.children){var O=b(y.props.children,u,v);O&&(j=O.matched,Object.assign(f,O.matched.props.params))}return{location:v,matched:n.cloneVNode(y,{children:j,params:Object.assign(f,_.params),component:y.props.component})}}}}function x(t,e,n){var o=e+"|"+t,p=R.get(o);if(!p){var i=[];p={pattern:r(e,i,{end:t}),keys:i},R.set(o,p)}var a=p.pattern.exec(n);if(!a)return null;for(var u=a[0],s=Object.create(null),l=1;l<a.length;l+=1)s[p.keys[l-1].name]=c(a[l]);return{path:""===u?"/":u,params:s}}t="default"in t?t.default:t,e="default"in e?e.default:e,r="default"in r?r.default:r;var j=function(e){function r(t,r){e.call(this,t,r)}return e&&(r.__proto__=e),r.prototype=Object.create(e&&e.prototype),r.prototype.constructor=r,r.prototype.componentWillMount=function(){var t=this,e=this.props,r=e.onEnter,n=this.context,o=n.router;r&&setImmediate(function(){r({props:t.props,router:o})})},r.prototype.componentWillUnmount=function(){var t=this.props,e=t.onLeave,r=this.context,n=r.router;e&&e({props:this.props,router:n})},r.prototype.render=function(e){var r=e.component,n=e.children,o=e.params;return t(r,{params:o,children:n})},r}(e),O=function(e){function r(){e.apply(this,arguments)}return e&&(r.__proto__=e),r.prototype=Object.create(e&&e.prototype),r.prototype.constructor=r,r.prototype.render=function(e){var r=e.component,n=e.children,o=e.params,p=e.path;return void 0===p&&(p="/"),t(r,{path:p,params:o,children:n})},r}(j),C=Object.create(null),R=new Map,k=function(t){function e(e,r){t.call(this,e,r)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getChildContext=function(){return{router:this.props.router||{location:{pathname:this.props.location}}}},e.prototype.render=function(t){var e=t.children,r=t.location,n=t.matched;if(void 0===n&&(n=null),n)return n;var o=_(e,r);return o.matched},e}(e),I=function(e){function r(t,r){if(e.call(this,t,r),!t.history)throw new TypeError('Inferno: Error "inferno-router" requires a history prop passed');this.router=t.history;var n=this.router.location.pathname+this.router.location.search;this.state={url:t.url||("blank"!==n?n:"/")}}return e&&(r.__proto__=e),r.prototype=Object.create(e&&e.prototype),r.prototype.constructor=r,r.prototype.componentWillMount=function(){var t=this;this.router&&(this.unlisten=this.router.listen(function(e){t.routeTo(e.pathname)}))},r.prototype.componentWillUnmount=function(){this.unlisten&&this.unlisten()},r.prototype.routeTo=function(t){this.setState({url:t})},r.prototype.render=function(e){var r=e.children,n=e.url;return t(k,{location:n||this.state.url,router:this.router},r)},r}(e),q={Route:j,IndexRoute:O,Router:I,RouterContext:k,Link:o,IndexLink:p,match:_};return q});
