!function(e,r){"object"==typeof exports&&"undefined"!=typeof module?module.exports=r(require("stream")):"function"==typeof define&&define.amd?define(["stream"],r):(e.Inferno=e.Inferno||{},e.Inferno.Server=r(e.stream))}(this,function(e){"use strict";function r(e){return e instanceof Array}function t(e){return i(e)||u(e)}function n(e){return l(e)||a(e)}function o(e){return a(e)||e===!1||s(e)||l(e)}function i(e){return"string"==typeof e}function u(e){return"number"==typeof e}function a(e){return null===e}function s(e){return e===!0}function l(e){return void 0===e}function c(e){throw e||(e=C),new Error("Inferno Error: "+e)}function f(e,r,t){e.split(",").forEach(function(e){return r[e]=t})}function p(e){return String(e).replace(T,function(e){return"&"===e?"&amp;":"<"===e?"&lt;":">"===e?"&gt;":'"'===e?"&quot;":"'"===e?"&#039;":"/"===e?"&#x2f;":""})}function d(e){return String(e).replace(E,function(e){return"&"===e?"&amp;":'"'===e?"&quot;":""})}function h(e){return e.replace(/([a-zA-Z])(?=[A-Z])/g,"$1-").toLowerCase()}function m(e){return!!P[e]}function v(e){if(t(e))return e;var r="";for(var o in e){var i=e[o],a=u(i)&&!j[o]?"px":"";n(i)||(r+=h(o)+":"+d(i)+a+";")}return r}function g(e,i,u){var l=e.flags,f=e.props,h=e.type,y=e.children;if(28&l){var x=4&l;if(x){var k=new h(f),w=k.getChildContext();n(w)||(i=Object.assign({},i,w)),k.context=i,k._pendingSetState=!0,k.componentWillMount();var S=k.render(f,e.context);return k._pendingSetState=!1,g(S,i,!0)}return g(h(f,i),i,!0)}if(3970&l){var b,C="<"+h,I=m(h);if(!a(f))for(var _ in f){var M=f[_];"dangerouslySetInnerHTML"===_?b=M.__html:"style"===_?C+=' style="'+v(f.style)+'"':"className"===_?C+=' class="'+d(M)+'"':t(M)?C+=" "+_+'="'+d(M)+'"':s(M)&&(C+=' "'+_+'"')}if(I)C+=">";else{if(C+=">",o(y))b&&(C+=b);else if(r(y))for(var N=0;N<y.length;N++)C+=g(y[N],i,0===N);else C+=t(y)?p(y):g(y,i,!0);I||(C+="</"+h+">")}return C}return 1&l?(u?"":"<!---->")+p(y):void c()}function y(e){return g(e,null,!0)}function x(e){return g(e,null,!0)}function k(e){if(t(e))return e;for(var r=[],o=Object.keys(e),i=0;i<o.length;i++){var a=o[i],s=e[a],l=u(s)&&!j[a]?"px":"";n(s)||r.push(h(a)+":"+d(s)+l+";")}return r.join()}function w(e){var r=[],n=e&&Object.keys(e)||[];return n.forEach(function(n,o){var i=e[n];switch(n){case"dangerouslySetInnerHTML":case"className":case"style":return;default:t(i)?r.push(d(n)+'="'+d(i)+'"'):s(i)&&r.push(d(n))}}),r}function S(e){return new L(e,!1)}function b(e){return new L(e,!0)}var C="a runtime error occured! Use Inferno in development environment to find the error.",I="http://www.w3.org/1999/xlink",_="http://www.w3.org/XML/1998/namespace",M={},N={},O={},j={};f("xlink:href,xlink:arcrole,xlink:actuate,xlink:role,xlink:titlef,xlink:type",O,I),f("xml:base,xml:lang,xml:space",O,_),f("volume,defaultValue,defaultChecked",M,!0),f("muted,scoped,loop,open,checked,default,capture,disabled,readonly,required,autoplay,controls,seamless,reversed,allowfullscreen,novalidate",N,!0),f("animationIterationCount,borderImageOutset,borderImageSlice,borderImageWidth,boxFlex,boxFlexGroup,boxOrdinalGroup,columnCount,flex,flexGrow,flexPositive,flexShrink,flexNegative,flexOrder,gridRow,gridColumn,fontWeight,lineClamp,lineHeight,opacity,order,orphans,tabSize,widows,zIndex,zoom,fillOpacity,floodOpacity,stopOpacity,strokeDasharray,strokeDashoffset,strokeMiterlimit,strokeOpacity,strokeWidth,",j,!0);var T=/[&<>"'\/]/g,E=/[&"]/g,P={area:!0,base:!0,br:!0,col:!0,command:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0},L=function(e){function i(r,t){e.call(this),this.started=!1,this.initNode=r,this.staticMarkup=t}return e&&(i.__proto__=e),i.prototype=Object.create(e&&e.prototype),i.prototype.constructor=i,i.prototype._read=function(){var e=this;this.started||(this.started=!0,Promise.resolve().then(function(){return e.renderNode(e.initNode,null,e.staticMarkup)}).then(function(){e.push(null)}).catch(function(r){e.emit("error",r)}))},i.prototype.renderNode=function(e,r,t){if(!o(e)){var n=e.flags;return 28&n?this.renderComponent(e,t,r,4&n):3970&n?this.renderElement(e,t,r):this.renderText(e,t,r)}},i.prototype.renderComponent=function(e,r,t,o){var i=this,u=e.type,a=e.props;if(!o)return this.renderNode(u(a),t,r);var s=new u(a),l=s.getChildContext();return n(l)||(t=Object.assign({},t,l)),s.context=t,s._pendingSetState=!0,Promise.resolve(s.componentWillMount()).then(function(){var e=s.render();return s._pendingSetState=!1,i.renderNode(e,t,r)})},i.prototype.renderChildren=function(e,n){var i=this;if(t(e))return this.push(p(e));if(e){var u=r(e);if(!u&&!o(e))return this.renderNode(e,n,!1);if(!u)throw new Error("invalid component");return e.reduce(function(e,u){return e.then(function(e){var a=t(u),s=o(u);return a||s?(e===!0&&(s?i.push("<!--!-->"):i.push("<!---->")),a&&i.push(p(u)),!0):r(u)?(i.push("<!---->"),Promise.resolve(i.renderChildren(u)).then(function(){return i.push("<!--!-->"),!0})):(1&u.flags&&(e&&i.push("<!---->"),e=!0),i.renderNode(u,n,!1).then(function(e){return!!(1&u.flags)}))})},Promise.resolve(!1))}},i.prototype.renderText=function(e,r,t){var n=this;return Promise.resolve().then(function(r){return n.push(e.children),r})},i.prototype.renderElement=function(e,r,t){var n=this,o=e.type,i=e.props,u=w(i),a="";if(i){var s=i.className;s&&u.push('class="'+d(s)+'"');var l=i.style;l&&u.push('style="'+k(l)+'"'),i.dangerouslySetInnerHTML&&(a=i.dangerouslySetInnerHTML.__html)}if(r&&u.push("data-infernoroot"),this.push("<"+o+(u.length>0?" "+u.join(" "):"")+">"),!m(o))return a?(this.push(a),void this.push("</"+o+">")):Promise.resolve(this.renderChildren(e.children,t)).then(function(){n.push("</"+o+">")})},i}(e.Readable),A={renderToString:y,renderToStaticMarkup:x,streamAsString:S,streamAsStaticMarkup:b,RenderStream:L};return A});
