!function(e,r){"object"==typeof exports&&"undefined"!=typeof module?module.exports=r(require("inferno"),require("stream")):"function"==typeof define&&define.amd?define(["inferno","stream"],r):(e.Inferno=e.Inferno||{},e.Inferno.Server=r(e.Inferno,e.stream))}(this,function(e,r){"use strict";function n(e){var r=typeof e;return"string"===r||"number"===r}function t(e){return l(e)||s(e)}function o(e){return s(e)||e===!1||a(e)||l(e)}function i(e){return"function"==typeof e}function u(e){return"number"==typeof e}function s(e){return null===e}function a(e){return e===!0}function l(e){return void 0===e}function c(e){throw e||(e=M),new Error("Inferno Error: "+e)}function f(e,r){for(var n in e)l(r[n])&&(r[n]=e[n])}function p(e,r,n){e.split(",").forEach(function(e){return r[e]=n})}function d(e){return String(e).replace(/[<>"'&]/g,W)}function h(e){return e.replace(A,"-$&").toLowerCase().replace(D,"-ms-")}function m(e){return!!H[e]}function v(e){if(n(e))return e;var r="";for(var o in e){var i=e[o],s=u(i)&&!T[o]?"px":"";t(i)||(r+=h(o)+":"+d(i)+s+";")}return r}function y(r,u,l){var p=r.flags,h=r.type,g=r.props||e.EMPTY_OBJ,x=r.children;if(28&p){var k=4&p;if(t(h.defaultProps)||(f(h.defaultProps,g),r.props=g),k){var w=new h(g,u),b=w.getChildContext();t(b)||(u=Object.assign({},u,b)),w.props===e.EMPTY_OBJ&&(w.props=g),w.context=u,w._pendingSetState=!0,w._unmounted=!1,i(w.componentWillMount)&&w.componentWillMount();var S=w.render(g,r.context);return w._pendingSetState=!1,o(S)?"<!--!-->":y(S,u,!0)}var M=h(g,u);return o(M)?"<!--!-->":y(M,u,!0)}if(3970&p){var _,I="<"+h,O=m(h);if(!s(g))for(var N in g){var P=g[N];"dangerouslySetInnerHTML"===N?_=P.__html:"style"===N?I+=' style="'+v(g.style)+'"':"className"!==N||t(P)?n(P)?I+=" "+N+'="'+d(P)+'"':a(P)&&(I+=" "+N):I+=' class="'+d(P)+'"'}if(O)I+=">";else{if(I+=">",o(x))_&&(I+=_);else if(C(x))for(var T=0;T<x.length;T++){var E=x[T];o(E)||(I+=y(E,u,0===T))}else I+=n(x)?d(x):y(x,u,!0);O||(I+="</"+h+">")}return I}return 1&p?(l?"":"<!---->")+d(x):void c()}function g(e){return y(e,{},!0)}function x(e){return y(e,{},!0)}function k(e){if(n(e))return e;var r=[];for(var o in e){var i=e[o],s=u(i)&&!T[o]?"px":"";t(i)||r.push(h(o)+":"+d(i)+s+";")}return r.join()}function w(e){var r=[],t=e&&Object.keys(e)||[];return t.forEach(function(t,o){var i=e[t];switch(t){case"dangerouslySetInnerHTML":case"className":case"style":return;default:n(i)?r.push(d(t)+'="'+d(i)+'"'):a(i)&&r.push(d(t))}}),r}function b(e){return new q(e,!1)}function S(e){return new q(e,!0)}var M="a runtime error occured! Use Inferno in development environment to find the error.",C=Array.isArray,_="http://www.w3.org/1999/xlink",I="http://www.w3.org/XML/1998/namespace",O={},N={},P={},T={},E={},j={};p("xlink:href,xlink:arcrole,xlink:actuate,xlink:role,xlink:titlef,xlink:type",P,_),p("xml:base,xml:lang,xml:space",P,I),p("volume,defaultValue,defaultChecked",O,!0),p("children,childrenType,ref,key,selected,checked,multiple",E,!0),p("onClick,onMouseDown,onMouseUp,onMouseMove,onSubmit,onDblClick,onKeyDown,onKeyUp,onKeyPress",j,!0),p("muted,scoped,loop,open,checked,default,capture,disabled,readOnly,required,autoplay,controls,seamless,reversed,allowfullscreen,novalidate,hidden",N,!0),p("animationIterationCount,borderImageOutset,borderImageSlice,borderImageWidth,boxFlex,boxFlexGroup,boxOrdinalGroup,columnCount,flex,flexGrow,flexPositive,flexShrink,flexNegative,flexOrder,gridRow,gridColumn,fontWeight,lineClamp,lineHeight,opacity,order,orphans,tabSize,widows,zIndex,zoom,fillOpacity,floodOpacity,stopOpacity,strokeDasharray,strokeDashoffset,strokeMiterlimit,strokeOpacity,strokeWidth,",T,!0);var L={"<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;","&":"&amp;"},W=function(e){return L[e]||e},A=/[A-Z]/g,D=/^ms-/,H={area:!0,base:!0,br:!0,col:!0,command:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0},q=function(e){function r(r,n){e.call(this),this.started=!1,this.initNode=r,this.staticMarkup=n}return e&&(r.__proto__=e),r.prototype=Object.create(e&&e.prototype),r.prototype.constructor=r,r.prototype._read=function(){var e=this;this.started||(this.started=!0,Promise.resolve().then(function(){return e.renderNode(e.initNode,null,e.staticMarkup)}).then(function(){e.push(null)}).catch(function(r){e.emit("error",r)}))},r.prototype.renderNode=function(e,r,n){if(!o(e)){var t=e.flags;return 28&t?this.renderComponent(e,n,r,4&t):3970&t?this.renderElement(e,n,r):this.renderText(e,n,r)}},r.prototype.renderComponent=function(e,r,n,o){var i=this,u=e.type,s=e.props;if(!o)return this.renderNode(u(s),n,r);var a=new u(s),l=a.getChildContext();return t(l)||(n=Object.assign({},n,l)),a.context=n,a._pendingSetState=!0,Promise.resolve(a.componentWillMount()).then(function(){var e=a.render();return a._pendingSetState=!1,i.renderNode(e,n,r)})},r.prototype.renderChildren=function(e,r){var t=this;if(n(e))return this.push(d(e));if(e){var i=C(e);if(!i&&!o(e))return this.renderNode(e,r,!1);if(!i)throw new Error("invalid component");return e.reduce(function(e,i){return e.then(function(e){var u=n(i);return u?(e===!0&&t.push("<!---->"),u&&t.push(d(i)),!0):C(i)?(t.push("<!---->"),Promise.resolve(t.renderChildren(i)).then(function(){return t.push("<!--!-->"),!0})):o(i)?void 0:(1&i.flags&&(e&&t.push("<!---->"),e=!0),t.renderNode(i,r,!1).then(function(e){return!!(1&i.flags)}))})},Promise.resolve(!1))}},r.prototype.renderText=function(e,r,n){var t=this;return Promise.resolve().then(function(r){return t.push(e.children),r})},r.prototype.renderElement=function(e,r,n){var o=this,i=e.type,u=e.props,s=w(u),a="";if(u){var l=u.className;t(l)||s.push('class="'+d(l)+'"');var c=u.style;c&&s.push('style="'+k(c)+'"'),u.dangerouslySetInnerHTML&&(a=u.dangerouslySetInnerHTML.__html)}if(r&&s.push("data-infernoroot"),this.push("<"+i+(s.length>0?" "+s.join(" "):"")+">"),!m(i))return a?(this.push(a),void this.push("</"+i+">")):Promise.resolve(this.renderChildren(e.children,n)).then(function(){o.push("</"+i+">")})},r}(r.Readable),z={renderToString:g,renderToStaticMarkup:x,streamAsString:b,streamAsStaticMarkup:S,RenderStream:q};return z});
