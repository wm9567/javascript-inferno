!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("inferno"),require("stream")):"function"==typeof define&&define.amd?define(["inferno","stream"],t):(e.Inferno=e.Inferno||{},e.Inferno.Server=t(e.Inferno,e.stream))}(this,function(e,t){"use strict";function r(e){var t=typeof e;return"string"===t||"number"===t}function n(e){return l(e)||u(e)}function o(e){return u(e)||e===!1||a(e)||l(e)}function i(e){return"function"==typeof e}function s(e){return"number"==typeof e}function u(e){return null===e}function a(e){return e===!0}function l(e){return void 0===e}function p(e){throw e||(e=M),new Error("Inferno Error: "+e)}function c(e,t){for(var r in e)l(t[r])&&(t[r]=e[r])}function d(e,t,r){e.split(",").forEach(function(e){return t[e]=r})}function f(e){return String(e).replace(/[<>"'&]/g,L)}function h(e){return e.replace(H,"-$&").toLowerCase().replace(D,"-ms-")}function m(e){return!!R[e]}function v(e){if(r(e))return e;var t="";for(var o in e){var i=e[o],u=s(i)&&!E[o]?"px":"";n(i)||(t+=h(o)+":"+f(i)+u+";")}return t}function y(t,s,l){var d=t.flags,h=t.type,g=t.props||e.EMPTY_OBJ,x=t.children;if(28&d){var T=4&d;if(n(h.defaultProps)||(c(h.defaultProps,g),t.props=g),T){var S=new h(g,s),b=S.getChildContext();n(b)||(s=Object.assign({},s,b)),S.props===e.EMPTY_OBJ&&(S.props=g),S.context=s,S._pendingSetState=!0,S._unmounted=!1,i(S.componentWillMount)&&S.componentWillMount();var w=S.render(g,t.context);return S._pendingSetState=!1,o(w)?"<!--!-->":y(w,s,!0)}var Q=h(g,s);return o(Q)?"<!--!-->":y(Q,s,!0)}if(3970&d){var _,k="<"+h,M=m(h);if(!u(g))for(var O in g){var C=g[O];"dangerouslySetInnerHTML"===O?_=C.__html:"style"===O?k+=' style="'+v(g.style)+'"':"className"!==O||n(C)?"children"===O||(r(C)?k+=" "+O+'="'+f(C)+'"':a(C)&&(k+=" "+O)):k+=' class="'+f(C)+'"'}if(M)k+=">";else{if(k+=">",o(x))_&&(k+=_);else if(N(x))for(var P=0;P<x.length;P++){var I=x[P];r(I)?k+=f(I):o(I)||(k+=y(I,s,0===P))}else k+=r(x)?f(x):y(x,s,!0);M||(k+="</"+h+">")}return k}return 1&d?(l?"":"<!---->")+f(x):void p()}function g(e){return y(e,{},!0)}function x(e){return y(e,{},!0)}function T(e){if(r(e))return e;var t=[];for(var o in e){var i=e[o],u=s(i)&&!E[o]?"px":"";n(i)||t.push(h(o)+":"+f(i)+u+";")}return t.join()}function S(e){var t=[],n=e&&Object.keys(e)||[];return n.forEach(function(n,o){var i=e[n];switch(n){case"dangerouslySetInnerHTML":case"className":case"style":return;default:r(i)?t.push(f(n)+'="'+f(i)+'"'):a(i)&&t.push(f(n))}}),t}function b(e){return new q(e,!1)}function w(e){return new q(e,!0)}function Q(e){if(r(e))return e;var t="";for(var o in e){var i=e[o],u=s(i)&&!E[o]?"px":"";n(i)||(t+=h(o)+":"+f(i)+u+";")}return t}function _(e){return new B(e,!1)}function k(e){return new B(e,!0)}var M="a runtime error occured! Use Inferno in development environment to find the error.",N=Array.isArray,O="http://www.w3.org/1999/xlink",C="http://www.w3.org/XML/1998/namespace",P={},I={},j={},E={},V={},W={};d("xlink:href,xlink:arcrole,xlink:actuate,xlink:role,xlink:titlef,xlink:type",j,O),d("xml:base,xml:lang,xml:space",j,C),d("volume,defaultValue,defaultChecked",P,!0),d("children,childrenType,ref,key,selected,checked,multiple",V,!0),d("onClick,onMouseDown,onMouseUp,onMouseMove,onSubmit,onDblClick,onKeyDown,onKeyUp,onKeyPress",W,!0),d("muted,scoped,loop,open,checked,default,capture,disabled,readOnly,required,autoplay,controls,seamless,reversed,allowfullscreen,novalidate,hidden",I,!0),d("animationIterationCount,borderImageOutset,borderImageSlice,borderImageWidth,boxFlex,boxFlexGroup,boxOrdinalGroup,columnCount,flex,flexGrow,flexPositive,flexShrink,flexNegative,flexOrder,gridRow,gridColumn,fontWeight,lineClamp,lineHeight,opacity,order,orphans,tabSize,widows,zIndex,zoom,fillOpacity,floodOpacity,stopOpacity,strokeDasharray,strokeDashoffset,strokeMiterlimit,strokeOpacity,strokeWidth,",E,!0);var A={"<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;","&":"&amp;"},L=function(e){return A[e]||e},H=/[A-Z]/g,D=/^ms-/,R={area:!0,base:!0,br:!0,col:!0,command:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0},q=function(e){function t(t,r){e.call(this),this.started=!1,this.initNode=t,this.staticMarkup=r}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype._read=function(){var e=this;this.started||(this.started=!0,Promise.resolve().then(function(){return e.renderNode(e.initNode,null,e.staticMarkup)}).then(function(){e.push(null)}).catch(function(t){e.emit("error",t)}))},t.prototype.renderNode=function(e,t,r){if(!o(e)){var n=e.flags;return 28&n?this.renderComponent(e,r,t,4&n):3970&n?this.renderElement(e,r,t):this.renderText(e,r,t)}},t.prototype.renderComponent=function(e,t,r,o){var i=this,s=e.type,u=e.props;if(!o)return this.renderNode(s(u),r,t);var a=new s(u),l=a.getChildContext();return n(l)||(r=Object.assign({},r,l)),a.context=r,a._pendingSetState=!0,Promise.resolve(a.componentWillMount()).then(function(){var e=a.render();return a._pendingSetState=!1,i.renderNode(e,r,t)})},t.prototype.renderChildren=function(e,t){var n=this;if(r(e))return this.push(f(e));if(e){var i=N(e);if(!i&&!o(e))return this.renderNode(e,t,!1);if(!i)throw new Error("invalid component");return e.reduce(function(e,i){return e.then(function(e){var s=r(i);return s?(e===!0&&n.push("<!---->"),s&&n.push(f(i)),!0):N(i)?(n.push("<!---->"),Promise.resolve(n.renderChildren(i)).then(function(){return n.push("<!--!-->"),!0})):o(i)?void 0:(1&i.flags&&(e&&n.push("<!---->"),e=!0),n.renderNode(i,t,!1).then(function(e){return!!(1&i.flags)}))})},Promise.resolve(!1))}},t.prototype.renderText=function(e,t,r){var n=this;return Promise.resolve().then(function(t){return n.push(e.children),t})},t.prototype.renderElement=function(e,t,r){var o=this,i=e.type,s=e.props,u=S(s),a="";if(s){var l=s.className;n(l)||u.push('class="'+f(l)+'"');var p=s.style;p&&u.push('style="'+T(p)+'"'),s.dangerouslySetInnerHTML&&(a=s.dangerouslySetInnerHTML.__html)}if(t&&u.push("data-infernoroot"),this.push("<"+i+(u.length>0?" "+u.join(" "):"")+">"),!m(i))return a?(this.push(a),void this.push("</"+i+">")):Promise.resolve(this.renderChildren(e.children,r)).then(function(){o.push("</"+i+">")})},t}(t.Readable),B=function(t){function s(e,r){t.call(this),this.started=!1,this.collector=[1/0],this.promises=[],this.pushQueue=this.pushQueue.bind(this),e&&this.renderVNodeToQueue(e,null,r,null)}return t&&(s.__proto__=t),s.prototype=Object.create(t&&t.prototype),s.prototype.constructor=s,s.prototype._read=function(){setTimeout(this.pushQueue,0)},s.prototype.addToQueue=function(e,t){if(n(t))"string"==typeof e&&this.collector.length-1===0?this.push(e):"string"==typeof e&&"string"==typeof this.collector[this.collector.length-2]?this.collector[this.collector.length-2]+=e:this.collector.splice(-1,0,e);else{var r=this.promises[t].length-1;"string"==typeof this.promises[t][r]&&"string"==typeof e?this.promises[t][r]+=e:this.promises[t].push(e)}},s.prototype.pushQueue=function(){var e=this.collector[0];if("string"==typeof e)this.push(e),this.collector.shift();else if(e&&("object"==typeof e||i(e))&&i(e.then)){var t=this;e.then(function(e){(r=t.collector).splice.apply(r,[0,1].concat(t.promises[e])),t.promises[e]=null,setTimeout(t.pushQueue,0);var r}),this.collector[0]=null}else e===1/0&&this.emit("end")},s.prototype.renderVNodeToQueue=function(t,s,l,d){var h=this,v=t.flags,y=t.type,g=t.props||e.EMPTY_OBJ,x=t.children;if(28&v){var T=4&v;if(n(y.defaultProps)||(c(y.defaultProps,g),t.props=g),T){var S=new y(g,s),b=S.getChildContext();if(n(b)||(s=Object.assign({},s,b)),S.props===e.EMPTY_OBJ&&(S.props=g),S.context=s,S._pendingSetState=!0,S._unmounted=!1,i(S.componentWillMount)&&S.componentWillMount(),i(S.getInitialProps)){var w=S.getInitialProps(S.props,S.context);if(w){if(Promise.resolve(w)===w){var _=this.promises.push([])-1;return void this.addToQueue(w.then(function(e){return S._pendingSetState=!1,"object"==typeof e&&(S.props=Object.assign({},S.props,e)),h.renderVNodeToQueue(S.render(S.props,S.context),S.context,!0,_),setTimeout(h.pushQueue,0),_}),d)}S.props=Object.assign({},S.props,w)}}var k=S.render(g,t.context);S._pendingSetState=!1,o(k)&&this.addToQueue("<!--!-->",d),this.renderVNodeToQueue(k,s,!0,d)}else{var M=y(g,s);o(M)&&this.addToQueue("<!--!-->",d),this.renderVNodeToQueue(M,s,!0,d)}}else if(3970&v){var O,C="<"+y,P=m(y);if(!u(g))for(var I in g){var j=g[I];"dangerouslySetInnerHTML"===I?O=j.__html:"style"===I?C+=' style="'+Q(g.style)+'"':"className"!==I||n(j)?r(j)?C+=" "+I+'="'+f(j)+'"':a(j)&&(C+=" "+I):C+=' class="'+f(j)+'"'}if(P)this.addToQueue(C+">",d);else{if(C+=">",o(x)){if(O)return void this.addToQueue(C+O+"</"+y+">",d)}else{if(!N(x))return r(x)?void this.addToQueue(C+f(x)+"</"+y+">",d):(this.addToQueue(C,d),this.renderVNodeToQueue(x,s,!0,d),void this.addToQueue("</"+y+">",d));this.addToQueue(C,d),C="";for(var E=0;E<x.length;E++){var V=x[E];r(V)?h.addToQueue(f(x),d):o(V)||h.renderVNodeToQueue(V,s,0===E,d)}}P||this.addToQueue(C+"</"+y+">",d)}}else 1&v?this.addToQueue((l?"":"<!---->")+f(x),d):p()},s}(t.Readable),J={renderToString:g,renderToStaticMarkup:x,streamAsString:b,streamAsStaticMarkup:w,RenderStream:q,RenderQueueStream:B,streamQueueAsString:_,streamQueueAsStaticMarkup:k};return J});
