!function(e,r){"object"==typeof exports&&"undefined"!=typeof module?module.exports=r(require("stream")):"function"==typeof define&&define.amd?define(["stream"],r):(e.Inferno=e.Inferno||{},e.Inferno.Server=r(e.stream))}(this,function(e){"use strict";function r(e){for(var r=e+"",t=r.length,n="",o=0;o<t;o++)switch(r.charCodeAt(o)){case 38:n+="&amp;";break;case 39:n+="&#039;";break;case 34:n+="&quot;";break;case 60:n+="&lt;";break;case 62:n+="&gt;";break;default:n+=r[o]}return n}function t(e){return e.replace(w,"-$&").toLowerCase().replace(S,"-ms-")}function n(e){return!!C[e]}function o(e){return u(e)||s(e)}function i(e){return f(e)||l(e)}function a(e){return l(e)||e===!1||c(e)||f(e)}function u(e){return"string"==typeof e}function s(e){return"number"==typeof e}function l(e){return null===e}function c(e){return e===!0}function f(e){return void 0===e}function d(e){throw e||(e=I),new Error("Inferno Error: "+e)}function p(e,r,t){e.split(",").forEach(function(e){return r[e]=t})}function h(e){if(o(e))return e;var n="";for(var a in e){var u=e[a],l=s(u)&&!E[a]?"px":"";i(u)||(n+=t(a)+":"+r(u)+l+";")}return n}function m(e,t,u){var s=e.flags,f=e.props,p=e.type,v=e.children;if(28&s){var y=4&s;if(y){var g=new p(f),x=g.getChildContext();i(x)||(t=Object.assign({},t,x)),g.context=t,g._pendingSetState=!0,g.componentWillMount();var k=g.render(f,e.context);return g._pendingSetState=!1,m(k,t,!0)}return m(p(f,t),t,!0)}if(3970&s){var b,w="<"+p,S=n(p);if(!l(f))for(var C in f){var I=f[C];"dangerouslySetInnerHTML"===C?b=I.__html:"style"===C?w+=' style="'+h(f.style)+'"':"className"===C?w+=' class="'+r(I)+'"':o(I)?w+=" "+C+'="'+r(I)+'"':c(I)&&(w+=" "+C)}if(S)w+=">";else{if(w+=">",a(v))b&&(w+=b);else if(_(v))for(var M=0;M<v.length;M++){var N=v[M];a(N)||(w+=m(N,t,0===M))}else w+=o(v)?r(v):m(v,t,!0);S||(w+="</"+p+">")}return w}return 1&s?(u?"":"<!---->")+r(v):void d()}function v(e){return m(e,null,!0)}function y(e){return m(e,null,!0)}function g(e){if(o(e))return e;var n=[];for(var a in e){var u=e[a],l=s(u)&&!E[a]?"px":"";i(u)||n.push(t(a)+":"+r(u)+l+";")}return n.join()}function x(e){var t=[],n=e&&Object.keys(e)||[];return n.forEach(function(n,i){var a=e[n];switch(n){case"dangerouslySetInnerHTML":case"className":case"style":return;default:o(a)?t.push(r(n)+'="'+r(a)+'"'):c(a)&&t.push(r(n))}}),t}function k(e){return new P(e,!1)}function b(e){return new P(e,!0)}var w=/[A-Z]/g,S=/^ms-/,C={area:!0,base:!0,br:!0,col:!0,command:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0},I="a runtime error occured! Use Inferno in development environment to find the error.",_=Array.isArray,M="http://www.w3.org/1999/xlink",N="http://www.w3.org/XML/1998/namespace",O={},T={},j={},E={};p("xlink:href,xlink:arcrole,xlink:actuate,xlink:role,xlink:titlef,xlink:type",j,M),p("xml:base,xml:lang,xml:space",j,N),p("volume,defaultValue,defaultChecked",O,!0),p("muted,scoped,loop,open,checked,default,capture,disabled,readonly,required,autoplay,controls,seamless,reversed,allowfullscreen,novalidate",T,!0),p("animationIterationCount,borderImageOutset,borderImageSlice,borderImageWidth,boxFlex,boxFlexGroup,boxOrdinalGroup,columnCount,flex,flexGrow,flexPositive,flexShrink,flexNegative,flexOrder,gridRow,gridColumn,fontWeight,lineClamp,lineHeight,opacity,order,orphans,tabSize,widows,zIndex,zoom,fillOpacity,floodOpacity,stopOpacity,strokeDasharray,strokeDashoffset,strokeMiterlimit,strokeOpacity,strokeWidth,",E,!0);var P=function(e){function t(r,t){e.call(this),this.started=!1,this.initNode=r,this.staticMarkup=t}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype._read=function(){var e=this;this.started||(this.started=!0,Promise.resolve().then(function(){return e.renderNode(e.initNode,null,e.staticMarkup)}).then(function(){e.push(null)}).catch(function(r){e.emit("error",r)}))},t.prototype.renderNode=function(e,r,t){if(!a(e)){var n=e.flags;return 28&n?this.renderComponent(e,t,r,4&n):3970&n?this.renderElement(e,t,r):this.renderText(e,t,r)}},t.prototype.renderComponent=function(e,r,t,n){var o=this,a=e.type,u=e.props;if(!n)return this.renderNode(a(u),t,r);var s=new a(u),l=s.getChildContext();return i(l)||(t=Object.assign({},t,l)),s.context=t,s._pendingSetState=!0,Promise.resolve(s.componentWillMount()).then(function(){var e=s.render();return s._pendingSetState=!1,o.renderNode(e,t,r)})},t.prototype.renderChildren=function(e,t){var n=this;if(o(e))return this.push(r(e));if(e){var i=_(e);if(!i&&!a(e))return this.renderNode(e,t,!1);if(!i)throw new Error("invalid component");return e.reduce(function(e,i){return e.then(function(e){var u=o(i);return u?(e===!0&&n.push("<!---->"),u&&n.push(r(i)),!0):_(i)?(n.push("<!---->"),Promise.resolve(n.renderChildren(i)).then(function(){return n.push("<!--!-->"),!0})):a(i)?void 0:(1&i.flags&&(e&&n.push("<!---->"),e=!0),n.renderNode(i,t,!1).then(function(e){return!!(1&i.flags)}))})},Promise.resolve(!1))}},t.prototype.renderText=function(e,r,t){var n=this;return Promise.resolve().then(function(r){return n.push(e.children),r})},t.prototype.renderElement=function(e,t,o){var i=this,a=e.type,u=e.props,s=x(u),l="";if(u){var c=u.className;c&&s.push('class="'+r(c)+'"');var f=u.style;f&&s.push('style="'+g(f)+'"'),u.dangerouslySetInnerHTML&&(l=u.dangerouslySetInnerHTML.__html)}if(t&&s.push("data-infernoroot"),this.push("<"+a+(s.length>0?" "+s.join(" "):"")+">"),!n(a))return l?(this.push(l),void this.push("</"+a+">")):Promise.resolve(this.renderChildren(e.children,o)).then(function(){i.push("</"+a+">")})},t}(e.Readable),A={renderToString:v,renderToStaticMarkup:y,streamAsString:k,streamAsStaticMarkup:b,RenderStream:P};return A});
